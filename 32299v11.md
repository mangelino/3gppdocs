<span id="page1" class="anchor"></span>3GPP TS 32.299 V11.11.0 (2014-03)

Technical Specification

3rd Generation Partnership Project;

Technical Specification Group Services and System Aspects;

Telecommunication management;

Charging management;

Diameter charging applications

(Release 11)

![](media/image1.jpeg){width="1.2326388888888888in"
height="1.1277777777777778in"}

The present document has been developed within the 3^rd^ Generation
Partnership Project (3GPP ^TM^) and may be further elaborated for the
purposes of 3GPP.\
The present document has not been subject to any approval process by the
3GPP Organizational Partners and shall not be implemented.\
This Specification is provided for future development work within 3GPP
only. The Organizational Partners accept no liability for any use of
this Specification.\
Specifications and reports for implementation of the 3GPP ^TM^ system
should be obtained via the 3GPP Organizational Partners' Publications
Offices.

<span id="page2" class="anchor"></span>

> Keywords
>
> UMTS, charging, management, protocol, GPRS, IP, multimedia, MMS
>
> ***3GPP***
>
> Postal address
>
> 3GPP support office address
>
> 650 Route des Lucioles - Sophia Antipolis
>
> Valbonne - FRANCE
>
> Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16
>
> Internet
>
> http://www.3gpp.org

***Copyright Notification***

No part may be reproduced except as authorized by written permission.\
The copyright and the foregoing restriction extend to reproduction in
all media.

©<span id="copyrightaddon" class="anchor"></span> 2014, 3GPP
Organizational Partners (ARIB, ATIS, CCSA, ETSI, TTA, TTC).

All rights reserved.

UMTS™ is a Trade Mark of ETSI registered for the benefit of its members

3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members
and of the 3GPP Organizational Partners\
LTE™ is a Trade Mark of ETSI currently being registered for the benefit
of its Members and of the 3GPP Organizational Partners

GSM® and the GSM logo are registered and owned by the GSM Association

\
Contents {#contents .TT}
========

Foreword 10

1 Scope 11

2 References 11

3 Definitions, symbols and abbreviations 14

3.1 Definitions 14

3.2 Symbols 14

3.3 Abbreviations 14

4 Architecture Considerations 15

4.1 High level architecture 15

4.1.1 Charging related transfer requirements 16

5 3GPP charging applications requirements 17

5.1 Offline Charging Scenarios 17

5.1.1 Basic Principles 17

5.1.1.1 Event based charging 18

5.1.1.2 Session based charging 19

5.1.2 Basic Operation 21

5.2 Online Charging scenarios 22

5.2.1 Basic principles 22

5.2.2 Charging Scenarios 23

5.2.2.1 Immediate Event Charging 23

5.2.2.1.1 Decentralized Unit Determination and Centralized Rating 24

5.2.2.1.2 Centralized Unit Determination and Centralized Rating 25

5.2.2.1.3 Decentralized Unit Determination and Decentralized Rating 27

5.2.2.1.4 Further Options 28

5.2.2.2 Event Charging with Reservation 29

5.2.2.2.1 Decentralized Unit Determination and Centralized Rating 29

5.2.2.2.2 Centralized Unit Determination and Centralized Rating 31

5.2.2.2.3 Decentralized Unit Determination and Decentralized Rating 33

5.2.2.3 Session charging with Reservation 34

5.2.2.3.1 Decentralized Unit Determination and Centralized Rating 34

5.2.2.3.2 Centralized Unit Determination and Centralized Rating 36

5.2.2.3.3 Decentralized Unit Determination and Decentralized Rating 38

5.2.3 Basic Operations 40

5.3 Other requirements 42

5.3.1 Re-authorization 42

5.3.2 Threshold based re-authorization triggers 42

5.3.3 Termination action 42

5.3.4 Account Expiration 42

6 3GPP Charging Applications – Protocol Aspects 43

6.1 Basic Principles for Diameter Offline Charging 43

6.1.1 Event based charging 44

6.1.2 Session based charging 45

6.1.3 Offline charging error cases - Diameter procedures 47

6.1.3.1 CDF connection failure 47

6.1.3.2 No reply from CDF 47

6.1.3.3 Duplicate detection 47

6.1.3.4 CDF detected failure 47

6.2 Message Contents for Offline Charging 48

6.2.1 Summary of Offline Charging Message Formats 48

6.2.1.1 General 48

6.2.1.2 Structure for the Accounting Message Formats 48

6.2.2 Accounting-Request Message 49

6.2.3 Accounting-Answer Message 51

6.3 Basic Principles for Diameter Online charging 53

6.3.1 Online Specific Credit Control Application Requirements 53

6.3.2 Diameter Description on the Ro reference point 53

6.3.2.1 Basic Principles 53

6.3.3 Immediate Event Charging (IEC) 54

6.3.4 Event Charging with Unit Reservation (ECUR) 56

6.3.5 Session Charging with Unit Reservation (SCUR) 58

6.3.6 Error Cases and Scenarios 60

6.3.6.1 Duplicate Detection 60

6.3.6.2 Reserve Units and Debit Units Operation Failure 60

6.3.7 Support of Tariff Changes during an Active User Session 60

6.3.7.1 Support of Tariff Changes using the Tariff Switch Mechanism 60

6.3.7.2 Support of Tariff Changes using Validity Time AVP 60

6.3.8 Support of Re-authorisation 61

6.3.9 Support of Failure Handling 61

6.3.10 Support of Failover 61

6.3.11 Credit Pooling 61

6.4 Message formats for Online Charging 62

6.4.1 Summary of Online Charging Message Formats 62

6.4.1.1 General 62

6.4.1.2 Structure for the Credit Control Message Formats 63

6.4.2 Credit-Control-Request Message 64

6.4.3 Credit-Control-Answer Message 68

6.4.4 Re-Auth-Request Message 71

6.4.5 Re-Auth-Answer Message 72

6.4.6. Capabilities-Exchange-Request Message 72

6.4.7 Capabilities-Exchange-Answer Message 72

6.4.8 Device-Watchdog-Request Message 72

6.4.9 Device-Watchdog-Answer Message 72

6.4.10 Disconnect-Peer-Request Message 72

6.4.11 Disconnect-Peer-Answer Message 72

6.4.12 Abort-Session-Request Message 72

6.4.13 Abort-Session -Answer Message 72

6.5 Other procedural description of the 3GPP charging applications 73

6.5.1 Re-authorization 73

6.5.1.1 Idle timeout 73

6.5.1.2 Change of charging conditions 73

6.5.1.3 Reporting quota usage 73

6.5.1.4 Quota consumption 74

6.5.2 Threshold based re-authorization triggers 74

6.5.3 Termination action 74

6.5.4 Quota consumption time 74

6.5.5 Service Termination 75

6.5.6 Envelope reporting 75

6.5.7 Combinational quota 75

6.5.8 Online control of offline charging information 76

6.5.9 Support of Multiple Service 76

6.6 Bindings of the operation to protocol application 76

6.6.1 Bindings of Charging Data Transfer to Accounting 76

6.6.2 Bindings of Debit / Reserve Units to Credit-Control 77

7 Summary of used Attribute Value Pairs 78

7.1 Diameter AVPs 78

7.1.1 Accounting-Input-Octets 79

7.1.2 void 79

7.1.3 Accounting-Output-Octets 80

7.1.4 void 80

7.1.5 Acct-Application-Id AVP 80

7.1.6 Auth-Application-Id AVP 80

7.1.7 Called-Station-Id 80

7.1.8 Event-Timestamp AVP 80

7.1.9 Multiple-Services-Credit-Control 80

7.1.10 Rating-Group AVP 81

7.1.11 Result-Code AVP 82

7.1.12 Service-Context-Id AVP 83

7.1.13 Service-Identifier AVP 83

7.1.14 Used-Service-Unit AVP 83

7.1.15 User-Name AVP 84

7.1.16 Vendor-Id AVP 84

7.1.17 User-Equipment-Info AVP 84

7.2 3GPP specific AVPs 84

7.2.1 Access-Network-Information AVP 90

7.2.1A Access-Transfer-Information AVP 90

7.2.1B Access-Transfer-Type AVP 90

7.2.2 Account-Expiration AVP 90

7.2.3 Accumulated-Cost AVP 91

7.2.4 Adaptations AVP 91

7.2.5 Additional-Content-Information AVP 91

7.2.6 Additional-Type-Information AVP 91

7.2.7 Address-Data AVP 91

7.2.8 Address-Domain AVP 91

7.2.9 Address-Type AVP 92

7.2.10 Addressee-Type AVP 92

7.2.11 AF-Correlation-Information AVP 92

7.2.12 Alternate-Charged-Party-Address AVP 92

7.2.13 AoC-Cost-Information AVP 92

7.2.14 AoC-Format AVP 93

7.2.15 AoC-Information AVP 93

7.2.16 AoC-Request-Type AVP 93

7.2.17 AoC-Service AVP 93

7.2.18 AoC-Service-Obligatory-Type AVP 93

7.2.19 AoC-Service-Type AVP 94

7.2.20 AoC-Subscription-Information AVP 94

7.2.21 Applic-ID AVP 94

7.2.22 Application-provided-Called-Party-Address AVP 94

7.2.23 Application-Server AVP 94

7.2.24 Application-Server-Information AVP 94

7.2.25 Associated-Party-Address AVP 95

7.2.26 Associated-URI AVP 95

7.2.27 Authorised-QoS AVP 95

7.2.28 Aux-Applic-Info AVP 95

7.2.29 Base-Time-Interval AVP 95

7.2.30 Bearer-Service AVP 95

7.2.31 Called-Asserted-Identity AVP 95

7.2.32 Called-Party-Address AVP 95

7.2.33 Calling-Party-Address AVP 96

7.2.34 Carrier-Select-Routing-Information AVP 96

7.2.35 Cause-Code AVP 96

7.2.36 CG-Address AVP 98

7.2.37 Change-Condition AVP 98

7.2.38 Change-Time AVP 99

7.2.38A Charge-Reason-Code AVP 99

7.2.39 Charged-Party AVP 99

7.2.39A Charging-Characteristics-Selection-Mode AVP 99

7.2.40 Class-Identifier AVP 99

7.2.41 Client-Address 100

7.2.42 Content-Class AVP 100

7.2.43 Content-Disposition AVP 100

7.2.44 Content-Length AVP 100

7.2.45 Content-Size AVP 100

7.2.46 Content-Type AVP 100

7.2.46A CSG-Access-Mode AVP 100

7.2.46B CSG-Membership-Indication AVP 101

7.2.47 Current-Tariff AVP 101

7.2.48 CUG-Information 101

7.2.49 Data-Coding-Scheme AVP 101

7.2.50 DCD-Information AVP 101

7.2.51 Deferred-Location-Event-Type AVP 101

7.2.52 Delivery-Report-Requested AVP 101

7.2.53 Destination-Interface AVP 102

7.2.54 Diagnostics AVP 102

7.2.55 Domain-Name AVP 102

7.2.56 DRM-Content AVP 102

7.2.57 Dynamic-Address-Flag AVP 102

7.2.57A Dynamic-Address-Flag-Extension AVP 102

7.2.58 Early-Media-Description AVP 103

7.2.59 Envelope AVP 103

7.2.60 Envelope-End-Time AVP 103

7.2.61 Envelope-Reporting AVP 104

7.2.62 Envelope-Start-Time AVP 104

7.2.63 Event AVP 104

7.2.64 Event-Charging-TimeStamp AVP 104

7.2.65 Event-Type AVP 104

7.2.66 Expires AVP 104

7.2.67 File-Repair-Supported AVP 105

7.2.67A From-Address AVP 105

7.2.68 GGSN-Address AVP 105

7.2.69 IM-Information AVP 105

7.2.70 Incremental-Cost AVP 105

7.2.71 Interface-Id AVP 105

7.2.72 Interface-Port AVP 105

7.2.73 Interface-Text AVP 105

7.2.74 Interface-Type AVP 106

7.2.74A IMS-Application Reference-Identifier AVP 106

7.2.75 IMS-Charging-Identifier AVP 106

7.2.76 IMS-Communication-Service-Identifier AVP 106

7.2.76A IMS-Emergency-Indicator AVP 106

7.2.77 IMS-Information AVP 106

7.2.77A IMS-Visited-Network-Identifier AVP 107

7.2.78 IMSI-Unauthenticated-Flag AVP 107

7.2.79 Incoming-Trunk-Group-ID AVP 107

7.2.79A Initial-IMS-Charging-Identifier AVP 108

7.2.80 Inter-Operator-Identifier AVP 108

7.2.80A IP-Realm-Default-Indication AVP 108

7.2.81 LCS-APN AVP 108

7.2.82 LCS-Client-Dialed-By-MS AVP 108

7.2.83 LCS-Client-External-ID AVP 108

7.2.84 LCS-Client-ID AVP 108

7.2.85 LCS-Client-Name AVP 109

7.2.86 LCS-Client-Type AVP 109

7.2.87 LCS-Data-Coding-Scheme AVP 109

7.2.88 LCS-Format-Indicator AVP 109

7.2.89 LCS-Information AVP 109

7.2.90 LCS-Name-String AVP 110

7.2.91 LCS-Requestor-ID AVP 110

7.2.92 LCS-Requestor-ID-String AVP 110

7.2.92A Local-GW-Inserted-Indication AVP 110

7.2.93 Local-Sequence-Number AVP 110

7.2.94 Location-Estimate AVP 110

7.2.95 Location-Estimate-Type AVP 110

7.2.96 Location-Type AVP 110

7.2.97 Low-Balance-Indication AVP 111

7.2.97A Low-Priority-Indicator AVP 111

7.2.98 MBMS-GW-Address AVP 111

7.2.99 MBMS-Information AVP 111

7.2.100 MBMS-User-Service-Type AVP 111

7.2.101 Media-Initiator-Flag AVP 112

7.2.102 Media-Initiator-Party AVP 112

7.2.103 Message-Body AVP 112

7.2.104 Message-Class AVP 112

7.2.105 Message-ID AVP 112

7.2.106 Message-Size AVP 112

7.2.107 Message-Type AVP 113

7.2.108 MM-Content-Type AVP 113

7.2.109 MMBox-Storage-Requested AVP 113

7.2.110 MMS-Information AVP 114

7.2.111 MMTel-Information AVP 114

7.2.111aA MMTel-SService-Type AVP 114

7.2.111A Neighbour-Node-Address AVP 115

7.2.112 Next-Tariff AVP 115

7.2.112A NNI-Information AVP 115

7.2.112B NNI-Type AVP 116

7.2.113 Node-Functionality AVP 116

7.2.114 Node-Id AVP 116

7.2.115 Number-Of-Diversions AVP 116

7.2.116 Number-Of-Messages-Sent AVP 116

7.2.117 Number-Of-Participants AVP 116

7.2.118 Number-Of-Received-Talk-Bursts AVP 117

7.2.119 Number-Of-Talk-Bursts AVP 117

7.2.120 Number-Portability-Routing-Information AVP 117

7.2.121 Offline-Charging AVP 117

7.2.122 Online-Charging-Flag AVP 117

7.2.123 Originating-IOI AVP 118

7.2.124 Originator AVP 118

7.2.125 Originator-Address AVP 118

7.2.126 Originator-Interface AVP 119

7.2.127 Originator-Received-Address AVP 119

7.2.128 Originator-SCCP-Address 119

7.2.128A Outgoing-Session-Id AVP 119

7.2.129 Outgoing-Trunk-Group-ID AVP 119

7.2.130 Participants-Involved AVP 119

7.2.131 Participant-Group AVP 119

7.2.132 Participant-Access-Priority AVP 120

7.2.133 Participant-Action-Type AVP 120

7.2.134 PDG-Address AVP 120

7.2.135 PDG-Charging-Id AVP 120

7.2.136 PDN-Connection-Charging-ID AVP 120

7.2.137 PDP-Address AVP 121

7.2.137a PDP-Address-Prefix-Length AVP 121

7.2.138 PDP-Context-Type AVP 121

7.2.139 PoC-Change-Condition AVP 121

7.2.140 PoC-Change-Time AVP 121

7.2.141 PoC-Controlling-Address AVP 121

7.2.142 PoC-Event-Type AVP 121

7.2.143 PoC-Group-Name AVP 122

7.2.144 PoC-Information AVP 122

7.2.145 PoC-Server-Role AVP 122

7.2.146 PoC-Session-Id AVP 122

7.2.147 PoC-Session-Initiation-Type AVP 122

7.2.148 PoC-Session-Type AVP 123

7.2.149 PoC-User-Role AVP 123

7.2.150 PoC-User-Role-IDs AVP 123

7.2.151 PoC-User-Role-info-Units AVP 123

7.2.152 Positioning-Data AVP 123

7.2.153 Preferred-AoC-Currency AVP 123

7.2.154 Priority AVP 123

7.2.155 PS-Append-Free-Format-Data AVP 124

7.2.156 PS-Free-Format-Data AVP 124

7.2.157 PS-Furnish-Charging-Information AVP 124

7.2.158 PS-Information AVP 124

7.2.159 Quota-Consumption-Time AVP 125

7.2.160 Quota-Holding-Time AVP 125

7.2.161 Rate-Element AVP 126

7.2.162 Read-Reply-Report-Requested AVP 126

7.2.163 Void 126

7.2.164 Real-Time-Tariff-Information AVP 126

7.2.165 Received-Talk-Burst-Time AVP 126

7.2.166 Received-Talk-Burst-Volume AVP 126

7.2.167 Recipient-Address AVP 126

7.2.168 Recipient-Info AVP 127

7.2.169 Recipient-Received-Address AVP 127

7.2.170 Recipient-SCCP-Address 127

7.2.171 Refund-Information AVP 127

7.2.171A Relationship-Mode AVP 128

7.2.171B Related-IMS-Charging-Identifier AVP 128

7.2.171C Related-IMS-Charging-Identifier-Node AVP 128

7.2.172 Remaining-Balance AVP 128

7.2.173 Reply-Applic-ID AVP 128

7.2.174 Reply-Path-Requested AVP 128

7.2.175 Reporting-Reason AVP 128

7.2.176 Requested-Party-Address AVP 129

7.2.177 Role-Of-Node AVP 130

7.2.177A Route-Header-Received AVP 130

7.2.177B Route-Header-Transmitted AVP 130

7.2.178 Scale-Factor AVP 130

7.2.179 SDP-Answer-Timestamp AVP 130

7.2.180 SDP-Media-Component AVP 130

7.2.181 SDP-Media-Description AVP 131

7.2.182 SDP-Media-Name AVP 131

7.2.183 SDP-Offer-Timestamp AVP 131

7.2.184 SDP-Session-Description AVP 131

7.2.185 SDP-TimeStamps AVP 131

7.2.186 SDP-Type AVP 131

7.2.186A Session-Direction AVP 132

7.2.187 Served-Party-IP-Address AVP 132

7.2.188 Void 132

7.2.189 Service-Data-Container AVP 132

7.2.190 Service-ID AVP 132

7.2.191 Service-Generic-Information AVP 132

7.2.192 Service-Information AVP 133

7.2.193 Service-Mode AVP 133

7.2.194 Service-Specific-Data AVP 134

7.2.195 Service-Specific-Info AVP 134

7.2.196 Service-Specific-Type AVP 134

7.2.197 Void 134

7.2.198 Serving-Node-Type AVP 134

7.2.199 SGSN-Address AVP 134

7.2.199A SGW-Address AVP 134

7.2.200 SGW-Change AVP 134

7.2.201 SIP-Method AVP 135

7.2.202 SIP-Request-Timestamp AVP 135

7.2.203 SIP-Request-Timestamp-Fraction AVP 135

7.2.204 SIP-Response-Timestamp AVP 135

7.2.205 SIP-Response-Timestamp-Fraction AVP 135

7.2.206 SM-Discharge-Time AVP 135

7.2.207 SM-Message-Type AVP 135

7.2.208 SM-Protocol-Id AVP 135

7.2.209 SM-Status AVP 136

7.2.210 SM-User-Data-Header AVP 136

7.2.211 SMS-Information AVP 136

7.2.212 SMS-Node AVP 136

7.2.213 SM-Service-Type AVP 136

7.2.214 SMSC-Address AVP 137

7.2.215 Start-Time AVP 137

7.2.215A Status-Code AVP 137

7.2.216 Stop-Time AVP 137

7.2.217 Submission-Time AVP 137

7.2.218 Subscriber-Role AVP 137

7.2.219 Supplementary-Service AVP 138

7.2.220 Talk-Burst-Exchange AVP 138

7.2.221 Talk-Burst-Time AVP 138

7.2.222 Talk-Burst-Volume AVP 138

7.2.223 Tariff-Information AVP 138

7.2.224 Tariff-XML AVP 139

7.2.225 Terminating-IOI AVP 139

7.2.226 Time-First-Usage AVP 140

7.2.227 Time-Last-Usage AVP 140

7.2.228 Time-Quota-Mechanism 140

7.2.229 Time-Quota-Threshold AVP 140

7.2.230 Time-Quota-Type AVP 140

7.2.231 Time-Stamps AVP 140

7.2.232 Time-Usage AVP 141

7.2.233 Traffic-Data-Volumes AVP 141

7.2.233A Transcoder-Inserted-Indication AVP 141

7.2.233B Transit-IOI-List AVP 141

7.2.234 Token-Text AVP 141

7.2.235 Trigger AVP 141

7.2.236 Trigger-Type AVP 141

7.2.237 Trunk-Group-ID AVP 144

7.2.237A TWAN-BSSID AVP 145

7.2.237B TWAN-SSID AVP 145

7.2.237C TWAN-User-Location-Info AVP 145

7.2.238 Type-Number AVP 145

7.2.239 Unit-Cost AVP 145

7.2.240 Unit-Quota-Threshold AVP 145

7.2.240A User-CSG-Information AVP 146

7.2.241 User-Participating-Type AVP 146

7.2.242 User-Session-Id AVP 146

7.2.243 Volume-Quota-Threshold AVP 146

7.2.244 WAG-Address AVP 146

7.2.245 WAG-PLMN-Id AVP 146

7.2.246 WLAN-Information AVP 147

7.2.247 WLAN-Radio-Container AVP 147

7.2.248 WLAN-Session-Id AVP 147

7.2.249 WLAN-Technology AVP 147

7.2.250 WLAN-UE-Local-IPAddress AVP 147

7.3 3GPP2 Accesses specific AVPs 148

Annex A (informative): Bibliography 149

Annex B (informative): Change history 151

\
Foreword
========

This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

\
1 Scope
=======

The present document is part of a series of documents that specify
charging functionality and charging management in GSM/UMTS networks. The
GSM/UMTS core network-charging architecture and principles are specified
in TS 32.240 \[1\], which provides an umbrella for other charging
management documents that specify.

1.  The content of the CDRs' per domain and subsystem (offline
    > charging);

2.  The content of real-time charging messages per domain / subsystem
    > (online charging);

3.  The functionality of online and offline charging for those domains
    > and subsystems;

4.  The interfaces that are used in the charging framework to transfer
    > the charging information (i.e. CDRs or charging events).

The complete document structure for these TSs is defined in TS 32.240
\[1\].

The present document specifies in detail the Diameter based offline and
online charging applications for 3GPP networks. It includes all charging
parameters, scenarios and message flows..

All terms, definitions and, abbreviations used in the present document,
that are common across 3GPP TSs, are defined in TR 21.905 \[100\]. Those
that are common across charging management in GSM/UMTS domains, services
or subsystems are provided in the umbrella document TS 32.240 \[1\] and
are copied into clause 3 of the present document for ease of reading.
Finally, those items that are specific to the present document are
defined exclusively in the present document.

Furthermore, requirements that govern the charging work are specified in
TS 22.115 \[101\].

2 References
============

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

1.  References are either specific (identified by date of publication,
    > edition number, version number, etc.) or non‑specific.

2.  For a specific reference, subsequent revisions do not apply.

3.  For a non-specific reference, the latest version applies. In the
    > case of a reference to a 3GPP document (including a GSM document),
    > a non-specific reference implicitly refers to the latest version
    > of that document *in the same Release as the present document*.

\[1\] 3GPP TS 32.240: "Telecommunication management; Charging
management; Charging Architecture and Principles".

\[2\]-\[99\] Void.

\[100\] 3GPP TR 21.905: "Vocabulary for 3GPP Specifications"

\[101\] 3GPP TS 22.115: "Service aspects; Charging and billing".

\[102\]-\[199\] Void.

\[200\] 3GPP TS 23.207: "End to end quality of service concept and
architecture".

\[201\] 3GPP TS 23.228: "IP Multimedia Subsystem (IMS); Stage 2".

\[202\] 3GPP TS 24.229: "IP Multimedia Call Control Protocol based on
SIP and SDP; Stage 3."

\[203\] 3GPP TS 29.207: "Policy control over Go interface".

\[204\] 3GPP TS 29.229: "Cx and Dx Interfaces based on the Diameter
protocol; Protocol Details".

\[205\] Void.

\[206\] 3GPP TS 29.230: "3GPP specific codes and identifiers".

\[207\] 3GPP TS 29.061: "Interworking between the Public Land Mobile
Network (PLMN) supporting packet based services and Packet Data Networks
(PDN)".

\[208\] 3GPP TS 23.140: " Multimedia Messaging Service (MMS); Functional
description; Stage 2".

\[209\] OMA "Multimedia Messaging Service; Encapsulation Protocol".

\[210\] OMNA WSP Content Type Numbers\
http://www.openmobilealliance.org/tech/omna/omna-wsp-content-type.aspx

\[211\] OMA-CP-POC: "OMA PoC Control Plane"

\[212\] 3GPP 29.234: "3GPP system to Wireless Local Area Network (WLAN)
interworking; Stage 3".

\[213\] 3GPP TS 29.140: "MM10 interface based on Diameter protocol;
Stage 3".

\[214\] 3GPP TS 29.214: "Policy and Charging Control over Rx reference
point; Stage 3".

\[215\] 3GPP TS 29.212: "Policy and Charging Control (PCC); Reference
points".

\[216\] 3GPP TS 23.040: "Technical realization of Short Message Service
(SMS)".

\[217\] 3GPP TS 22.142: "Value Added Services (VAS) for Short Message
Service (SMS) requirements".

\[218\] 3GPP TS 23.203: "Policy and Charging control architecture".

\[219\] 3GPP TS 29.272: " Mobility Management Entity (MME) and Serving
GPRS Support Node (SGSN) related interfaces based on Diameter protocol".

\[220\] 3GPP TS 24.605: "Conference (CONF) using IP Multimedia (IM) Core
Network (CN) subsystem; Protocol specification".

\[221\] 3GPP TS 29.329: "Sh Interface based on the Diameter
protocol;Protocol details".

\[222\] 3GPP TS 29.658: "SIP Transfer of IP Multimedia Service Tariff
Information".

\[223\] OMA-DDS-Charging\_Data: "Charging Data".

\[224\] 3GPP TS 23.003: "Numbering, Addressing and Identification".

\[225\] 3GPP TS 29.060: "General Packet Radio Service (GPRS); GPRS
Tunnelling Protocol (GTP) across the Gn and Gp interface".

\[226\] 3GPP TS 29.274: "Evolved GPRS Tunnelling Protocol for Control
Plane (GTPv2-C); Stage 3".

\[227\] 3GPP TS 23.032: "Universal Geographical Area Description (GAD)".

\[228\] 3GPP TS 23.167: "IP Multimedia Subsystem (IMS) emergency
sessions".

\[229\] 3GPP TS 29.173: "Location Services (LCS);Diameter-based SLh
interface for Control Plane LCS".

\[230\] 3GPP TS 29.272: "Evolved Packet System (EPS);Mobility Management
Entity (MME) and Serving GPRS Support Node (SGSN) related interfaces
based on Diameter protocol".

\[231\] - \[400\] Void.

\[401\] IETF RFC 3588: "Diameter Base Protocol".

\[402\] IETF RFC 4006: "Diameter Credit Control Application"

\[403\] IETF RFC 5580: "Carrying Location Objects in RADIUS"

\[404\] IETF RFC 3455 , "Private Extensions to the Session Initiation
Protocol (SIP) for the 3^rd^ Generation Partnership Projects (3GPP)".

\[405\] IETF RFC 3261: "SIP: Session Initiation Protocol".

\[406\] IETF RFC 4566: "SDP: Session Description Protocol".

\[407\] IETF RFC 4005: "Diameter Network Access Server Application".

\[408\] IETF RFC 3264: An Offer/Answer Model with the Session
Description Protocol (SDP).

\[409\] IEEE Std 802.11-2012: "IEEE Standard for Information technology
- Telecommunications and information exchange between systems - Local
and metropolitan area networks - Specific requirements - Part 11:
Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY)
Specifications".

NOTE: The above reference will need to be updated to reference the
assigned RFC number, once the draft achieves RFC status within the IETF.

\
3 Definitions, symbols and abbreviations
========================================

3.1 Definitions
---------------

For the purposes of the present document, the following terms and
definitions apply:

**middle tier (charging) TS:** term used for the 3GPP charging TSs that
specify the domain / subsystem / service specific, online and offline,
charging functionality. These are all the TSs in the numbering range
from 3GPP TS 32.250 to 3GPP TS 32.279, e.g. 3GPP TS 32.250 \[10\] for
the CS domain, or 3GPP TS 32.270 \[30\] for the MMS service. Currently,
there is only one "tier 1" TS in 3GPP, which is the TS 32.240 that
specifies the charging architecture and principles. Finally, there are a
number of top tier TSs in the 32.29x numbering range (\[50\] ff) that
specify common charging aspects such as parameter definitions, encoding
rules, the common billing domain interface or common charging
applications.

**offline charging:** charging mechanism where charging information
**does not** affect, in real-time, the service rendered

**online charging:** charging mechanism where charging information can
affect, in real-time, the service rendered and therefore a direct
interaction of the charging mechanism with session/service control is
required

3.2 Symbols
-----------

For the purposes of the present document, the following symbols apply:

Rf Offline Charging Reference Point between a 3G network element and the
CDF.

Ro Online Charging Reference Point between a 3G network element and the
OCS.

3.3 Abbreviations
-----------------

For the purposes of the present document, the following abbreviations
apply:

ACA ACcounting Answer

ACR ACcounting Request

AoC Advice of Charge

AS Application Server

ASA Abort Session Answer

ASR Abort Session Request

AVP Attribute Value Pair

CCA Credit Control Answer

CCR Credit Control Request

CDF Charging Data Function

CDR Charging Data Record

CEA Capabilities Exchange Answer

CER Capabilities Exchange Request

CGI Cell Global Identification

CI Cost-Information

CSG Closed Subscriber Group

CSG ID Closed Subscriber Group Identity

DBPA Diameter Base Protocol Accounting

DCD Dynamic Content Delivery

DPA Disconnect Peer Answer

DPR Disconnect Peer Request

DRM Digital Rights Management

DWA Device Watchdog Answer

DWR Device Watchdog Request

ECGI E-UTRAN Cell Global Identifier

ECUR Event Charging with Unit Reservation

FQDN Fully Qualified Domain Name

FUI Final-Unit-Indication

HSGW HRPD Serving GateWay

GSU Granted-Service-Unit

IEC Immediate Event Charging

IM Instant Messaging

IMS IP Multimedia Subsystem

IMS-AGW IMS Access Media Gateway

MSCC Multiple Services Credit Control

NetLoc Network provided Location information

NNI Network to Network Interface

OCS Online Charging System

RAA Re-Auth Answer

RAI Routeing Area Identity

RAR Re-Auth Request

RAVEL Roaming Architecture for VoicE over IMS with Local breakout

SAI Service Area Identifier

SCCP Signalling Connection Control Part

SDP Session Description Protocol

TAI Tracking Area Identity

TrGW Transition GateWay

TWAG Trusted WLAN Access Gateway

TWAN Trusted WLAN Access Network

4 Architecture Considerations
=============================

4.1 High level architecture
---------------------------

The Rf and the Ro are reference points from the Charging Trigger
Function (CTF) to the Charging Data Function (CDF) and the Online
Charging Function (OCF) respectively, and are intended for the transport
of charging events. Rf is used for offline charging whereas Ro is used
for online charging. The following figures depict the position of the Rf
and Ro reference points within the overall 3GPP online and offline
charging architecture.

**CTF:** **C**harging **T**rigger **F**unction

**CDF:** **C**harging **D**ata **F**unction

**CGF:** **C**harging **G**ateway **F**unction

**BD:** **B**illing **D**omain. This may also be a billing mediation
device / post-processing system.

Figure 4.1.1: Logical ubiquitous offline charging architecture

**CTF:** **C**harging **T**rigger **F**unction

**OCF:** **O**nline **C**harging **F**unction

**CGF:** **C**harging **G**ateway **F**unction

**BD:** **B**illing **D**omain. This may also be a billing mediation
device / post-processing system.

Figure 4.1.2: Logical ubiquitous online charging architecture

Different mappings of the ubiquitous offline charging functions, CTF,
CDF and CGF, onto physical implementations are possible. Further details
of the configuration refer toTS 32.240 \[1\]. Details of the
implementation options per domain / subsystem / service (usually a
subset of the overall possible variants described above) are specified
in the respective middle tier TS.

### 4.1.1 Charging related transfer requirements

Each CTF would have CDF and OCF address list to which it can send its
charging events and/or charging requests. The list will be organized in
address priority order. If the primary charging function is not
available (e.g., out of service) then the CTF shall send the charging
information to the secondary charging function and so on.

Within the scope of this release, each network element that generates
charging information will send the information only to the charging
entities of the same PLMN, and not to charging entities in other PLMNs.

Each CDF in the PLMN may know of other CDFs' network addresses (e.g.,
for redundancy reasons, to be able to recommend another CDF address with
the Redirection Request message). This is achieved by OAM&P
configuration facilities that will enable each CDF to have a
configurable list of peer CDF addresses.

\
5 3GPP charging applications requirements
=========================================

5.1 Offline Charging Scenarios
------------------------------

### 5.1.1 Basic Principles

Offline charging for both events and sessions between CTF and the CDF is
performed using the Rf reference point as defined in TS 32.240\[1\].

Two basic scenarios are used:

-   Event based Charging;

-   Session based Charging.

#### \
5.1.1.1 Event based charging

In the following scenario, CTF asks the CDF to store event related
charging data.

Figure 5.1.1.1: Event Based Charging

1.  **Request for resource usage:** UE-A requests the desired resource
    from the network element.

2.  **Content/Service Delivery:** the network element delivers
    the content/service.

3.  **Charging Data Generation:** the CTF generates charging data
    related to service delivery

4.  **Record Charging Data Request:** the CTF requests the CDF to store
    event related charging data for CDR generation purposes.

5.  **Process Request:** CDF stores received information. Whether the
    CDR is generated or not depends on CDR generation configuration.

6.  **Record Charging Data Response:** the CDF informs the CTF that
    charging data was stored.

#### 5.1.1.2 Session based charging

In the following scenario, CTF asks the CDF to store session related
charging data.

Figure 5.1.1.2: Session based charging

1.  **Request for resource usage:** UE-A requests the desired session
    from the network element.

2.  **Session ongoing:** the network element establish the session

3.  **Charging Data Generation:** the CTF generates charging data
    related to session.

4.  **Record Charging Data Request:** the CTF requests the CDF to store
    session related charging data for CDR generation purposes.

5.  **Process Request:** CDF stores received information. Whether the
    CDR is generated or not depends on CDR generation configuration.

6.  **Record Charging Data Response:** the CDF informs the CTF that
    charging data was stored

7.  **Charging Data Generation:** the CTF generates charging data
    related to session due of e.g. intermediate timer expiry

8.  **Record Charging Data Request:** the CTF requests the CDF to store
    session related charging data for CDR generation purposes.

9.  **Process Request:** CDF stores received information. Whether the
    CDR is generated or not depends on CDR generation configuration.

10. **Record Charging Data Response:** the CDF informs the CTF that
    charging data was stored

11. **Session release:** the session is released

12. **Charging Data Generation:** the CTF generates charging data
    related to session due of session termination.

13. **Record Charging Data Request:** the CTF requests the CDF to store
    session related charging data for CDR generation purposes.

14. **Process Request:** CDF stores received information. Whether the
    CDR is generated or not depends on CDR generation configuration.

15. **Record Charging Data Response:** the CDF informs the CTF that
    charging data was stored.

### \
5.1.2 Basic Operation

Event and session based Charging are performed by the use of the
"*Charging Data Transfer*" operation:

-   "*Charging Data Request*"; sent from CTF CDF\
    After detecting a chargeable event, the CTF sends a Charging Data
    Request to the CDF.

-   "*Charging Data Response*"; sent from CDF CTF\
    The CDF replies with a Charging Data Response, which informs the CTF
    that charging data was received.

Table 5.1.2.1 and table 5.1.2.2 describe the content of these
operations.

Table 5.1.2.1: Charging Data Request Content

  ----------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------
  Charging Data Request   Category   Description
  Session Identifier      M          This field identifies the operation session.
  Originator Host         M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Originator Domain       M          This field contains the realm of the operation originator.
  Destination Domain      M          This field contains the realm of the operation destination.
  Operation Type          M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Operation Number        M          This field contains the sequence number of the transferred messages.
  Operation Identifier    O~M~       The field corresponds to the unique operation identification.
  User Name               O~C~       The field contains the identification of the service user.
  Destination Host        O~C~       This field contains the identification of the destination point of the operation.
  Operation Interval      O~C~       
  Origination State       O~C~       
  Origination Timestamp   O~C~       This field contains the time when the operation is requested.
  Proxy Information       O~C~       This field contains the parameter of the proxy.
  Route Information       O~C~       This field contains the parameter of the route.
  Operation Token         O~M~       This field identifies the domain, subsystem or service and release.
  Service information     O~M~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  ----------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------

Table 5.1.2.2: Charging Data Response Content

  ------------------------ ---------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Charging Data Response   Category   Description
  Session Identifier       M          This field identifies the operation session.
  Operation Result         M          This field identifies the result of the operation.
  Originator Host          M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Originator Domain        M          This field contains the realm of the operation originator.
  Operation Type           M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Operation Number         M          This field contains the sequence number of the transferred messages.
  Operation Identifier     O~M~       The field corresponds to the unique operation identification.
  Operation Interval       O~C~       
  Error Reporting Host     O~C~       If proxies exist between the accounting client and the accounting server this field contains the identity of the proxy that sent a response other than 2001 (Success).
  Origination State        O~C~       
  Origination Timestamp    O~C~       This field contains the time when the operation is requested.
  Proxy Information        O~C~       This field contains the parameter of the proxy.
  ------------------------ ---------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\
5.2 Online Charging scenarios
-----------------------------

Online charging for both events and sessions between CTF and the OCF is
performed using the Ro reference point. The Ro reference point supports
integrity protection and authentication for the case that the CTF is
outside the operator domain.

### 5.2.1 Basic principles

There are two sub-functions for online charging that affect online
charging principles and require a more detailed description: rating and
unit determination. Both rating and unit determination can be
implemented centralized, i.e. on the OCF, or decentralized, that is, on
the CTF.

Unit determination refers to the calculation of the number of
non-monetary units (service units, data volume, time and events) that
shall be assigned prior to starting service delivery.

-   With Centralized Unit Determination, the OCF determines the number
    of non-monetary units that a certain service user can consume based
    on a service key received from the CTF.

-   With the Decentralized Unit Determination approach, the CTF
    determines itself how many units are required to start service
    delivery, and requests these units from the OCF.

After checking the service user's account balance, the OCF returns the
number of granted units to the CTF. The CTF is then responsible for the
supervision of service delivery. Particularly, the CTF shall limit
service delivery to the corresponding number of granted units.

Rating refers to the calculation of a price out of the non-monetary
units calculated by the unit determination function.

-   With the Centralized Rating approach, the CTF and the OCF exchange
    information about non-monetary units. The OCF translates these units
    into monetary units.

-   With the Decentralized Rating approach, the corresponding rating
    control is performed within the CTF. Consequently, CTF and OCF
    exchange information about monetary units.

Three cases for online charging can be distinguished: immediate event
charging (IEC), event charging with unit reservation (ECUR) and session
charging with unit reservation (SCUR). These cases are further described
in TS 32.240 \[1\].

### \
5.2.2 Charging Scenarios

In order to perform event charging via Ro, the scenarios between the
involved entities UE-A, OCF and CTF need to be defined. The charging
flows shown in this subclause include scenarios with immediate event
charging and event charging with reservation. In particular, the
following cases are shown:

> 1 Immediate Event Charging

a)  Decentralized Unit Determination and Centralized Rating

b)  Centralized Unit Determination and Centralized Rating

c)  Decentralized Unit Determination and Decentralized Rating

> 2 Event charging with Reservation

a)  Decentralized Unit Determination and Centralized Rating

b)  Centralized Unit Determination and Centralized Rating

c)  Decentralized Unit Determination and Decentralized Rating

> 3 Session charging with Reservation

a)  Decentralized Unit Determination and Centralized Rating

b)  Centralized Unit Determination and Centralized Rating

c)  Decentralized Unit Determination and Decentralized Rating

The combination of Centralized Unit Determination with Decentralized
Rating is not possible.

#### 5.2.2.1 Immediate Event Charging

##### 5.2.2.1.1 Decentralized Unit Determination and Centralized Rating

In the following scenario, CTF asks the OCF to assign a defined number
of units.

Figure 5.2.2.1.1: Immediate Event Charging with Centralized Rating and
Decentralized Unit Determination

1.  **Request for resource usage:** UE-A requests the desired resource
    from the network element.

2.  **Units Determination:** depending on the requested service the CTF
    determines the number of units accordingly.

3.  **Debit Units Request:** the CTF requests the OCF to assign the
    defined number of units.

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represents the price for the
    number of units determined in item 2.

5.  **Account Control:** provided that the user's credit balance is
    sufficient, the OCF triggers the deduction of the calculated amount
    from the subscriber's account.

6.  **Debit Units Response:** the OCF informs the CTF of the number of
    granted units.

7.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the number of granted units.

8.  **Credit Unit Control (cont.):** this function block is optional and
    a replication of items 2 to 6.

9.  **Content/Service Delivery (cont.):** the continuation of content
    delivery occurs in correspondence with the occurrence of item 8.

10. **Session released:** Session is released.

##### \
5.2.2.1.2 Centralized Unit Determination and Centralized Rating

In the following scenario, CTF asks the OCF to assign units based on the
service key specified by the CTF.

Figure 5.2.2.1.2: Immediate Event Charging with Centralized Rating and
Centralized Unit Determination

1.  **Request for resource usage:** The UE-A requests the desired
    resource or content from the network element.

2.  **Debit Units Request:** depending on the service requested by the
    UE-A, the CTF determines the service key and forwards the Debit
    Units Request with service key to the OCF.

3.  **Units Determination:** the OCF determines the number of
    non-monetary units needed for the content/service delivery, based on
    the received service key.

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represent the price for the number
    of units determined in item 3.

5.  **Account Control:** provided that the user's credit balance is
    sufficient, the OCF triggers the deduction of the calculated amount
    from the subscriber's account.

6.  **Debit Units Response:** the OCF informs the CTF of the number of
    granted units. This includes the case where the number of units
    granted indicates the permission to render the service that was
    identified by the received service key.

7.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the number of granted units.

8.  **Credit Service Control (cont.):** this function block is optional
    and a replication of items 2 to 6.

9.  **Content/Service Delivery (cont.):** the continuation of content
    delivery occurs in correspondence with the occurrence of item 8.

10. **Session released:** the session is released.

##### \
5.2.2.1.3 Decentralized Unit Determination and Decentralized Rating

In the following scenario, the CTF asks the OCF to assure the deduction
of an amount of the specified number of monetary units from the
subscriber's account.

Figure 5.2.2.1.3: Immediate Event Charging with Decentralized Rating and
Decentralized Unit Determination

1.  **Request for resource usage:** The UE-A requests the desired
    content from the network element.

2.  **Units Determination:** depending on the service requested by the
    UE-A, the CTF determines the number of units accordingly.

3.  **Rating Control:** the CTF calculates the number of monetary units
    that represent the price for the number of units determined in
    item 2.

4.  **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the calculated number of
    monetary units from the subscriber's account.

5.  **Account Control:** provided that the user's credit balance is
    sufficient, the OCF triggers the deduction of the calculated amount
    from the subscriber's account.

6.  **Debit Units Response:** the OCF indicates to the CTF the number of
    deducted monetary units.

7.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the number of units as specified in items 2 and 3.

8.  **Credit Amount Control (cont.):** this function block is optional
    and a replication of items 2 to 6.

9.  **Content/Service Delivery (cont.):** the continuation of content
    delivery occurs in correspondence with the occurrence of item 8.

10. **Session released:** the session is released.

##### 5.2.2.1.4 Further Options

In addition to the flows that are specified in the previous subclauses,
the Debit Unit operation may alternatively be carried out concurrently
with service delivery, or after completion of service delivery.

#### \
5.2.2.2 Event Charging with Reservation

##### 5.2.2.2.1 Decentralized Unit Determination and Centralized Rating

In the following scenario, the CTF requests the reservation of units
prior to service delivery. An account debit operation is carried out
following the conclusion of service delivery.

Figure 5.2.2.2.1: Event Charging with Reservation / Decentralized Unit
Determination and Centralized Rating

1.  **Request for resource usage:** The UE-A requests the desired
    content/service from the NE.

2.  **Units Determination:** depending on the requested service the CTF
    determines the number of units accordingly.

3.  **Reserve Units Request:** the CTF requests the OCF to reserve the
    number of units determined in item 2.

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represents the price for the
    number of units determined in item 2.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's account balance is sufficient
    then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of units.

8.  **Reserved Units Supervision:** simultaneously with the service
    delivery, the CTF monitors the consumption of the reserved units.

9.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the reserved number of units.

10. **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the consumed number of units
    from the subscriber's account. In the case that no further units are
    required for this service, an appropriate indication triggering the
    release of the remaining reservation is given.

11. **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units to deduct from the
    subscriber's account.

12. **Account Control:** the OCF triggers the deduction of the
    calculated amount from the subscriber's account.

13. **Debit Units Response:** the OCF informs the CTF of the actually
    deducted units.

14. **Session Release:** the session is released.

##### 5.2.2.2.2 Centralized Unit Determination and Centralized Rating

In the following scenario, the CTF requests the OCF to reserve units
based on the service key specified by the CTF. An account debit
operation is carried out following the conclusion of service delivery.

Figure 5.2.2.2.2: Event Charging with Reservation / Centralized Unit
Determination and Centralized Rating

1.  **Request for resource usage:** The UE-A requests the desired
    content from the CTF.

2.  **Reserve Units Request:** depending on the service requested by the
    UE-A, the CTF determines the service key and forwards the Reserve
    Units Request with service key to the OCF.

3.  **Units Determination:** the OCF determines the number of
    non-monetary units needed for the content/service delivery, based on
    the received service key.

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represent the price for the number
    of units determined in item 3.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's account balance is
    sufficient, then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of units. This includes the case where the number of units
    reserved indicates the permission to render the service that was
    identified by the received service key.

8.  **Granted Units** Supervision**:** simultaneously with the service
    delivery, the CTF monitors the consumption of the reserved units.

9.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the reserved number of units.

10. **Debit Units Request:** the CTF provides according to previous
    Reserve Units Response the request to deduct the amount of units
    corresponding to the consumed number of units.

11. **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units to deduct from the
    subscriber's account.

12. **Account Control:** the OCF triggers the deduction of the
    calculated amount from the subscriber's account.

13. **Debit Units Response:** the OCF informs the CTF of the actually
    deducted units.

14. **Session Released:** the session is released.

##### \
5.2.2.2.3 Decentralized Unit Determination and Decentralized Rating

In the following scenario, the CTF request the OCF to assure the
reservation of an amount of the specified number of monetary units from
the subscriber's account. An account debit operation that triggers the
deduction the amount from the subscriber's account is carried out
following the conclusion of service delivery.

Figure 5.2.2.2.3: Event Charging with Reservation / Centralized Unit
Determination and Centralized Rating

1.  **Request for resource usage:** The UE-A requests the desired
    content from the CTF.

2.  **Units Determination:** depending on the service requested by the
    UE-A, the CTF determines the number of units accordingly.

3.  **Rating Control:** the CTF calculates the number of monetary units
    that represent the price for the number of units determined in
    item 2.

4.  **Reserve Units Request:** the CTF requests the OCF to assure the
    reservation of an amount corresponding to the calculated number of
    monetary units from the subscriber's account.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's credit balance is sufficient,
    then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of monetary units.

8.  **Budget Control:** simultaneously with the service delivery, the
    CTF monitors the consumption of the granted amount.

9.  **Content/Service Delivery:** the CTF delivers the content/service
    at once, in fractions or in individually chargeable items,
    corresponding to the number of units.

10. **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the consumed number of
    monetary units from the subscriber's account.

11. **Account Control:** the OCF triggers the deduction of the consumed
    amount from the subscriber's account.

12. **Debit Units Response:** the OCF indicates to the CTF the number of
    deducted monetary units.

13. **Session Released:** the session is released.

#### 5.2.2.3 Session charging with Reservation

##### 5.2.2.3.1 Decentralized Unit Determination and Centralized Rating

In the following scenario, the CTF requests the reservation of units
prior to session supervision. An account debit operation is carried out
following the conclusion of session termination.

Figure 5.2.2.3.1: Session Charging with Reservation / Decentralized Unit
Determination and Centralized Rating

1.  **Request for resource usage:** The UE-A requests session
    establishment from the CTF.

2.  **Units Determination:** depending on the requested type of the
    session the CTF determines the number of units accordingly.

3.  **Reserve Units Request:** the CTF requests the OCF to reserve the
    number of units determined in item 2

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represents the price for the
    number of units determined in item 2.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's account balance is sufficient
    then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of units.

8.  **Reserved Units Supervision:** simultaneously with the ongoing
    session, the CTF monitors the consumption of the reserved units.

9.  **Session ongoing:** the CTF maintains the session. One or more
    debit and reserve operations may be performed when the session
    is ongoing.

10. **Session Release:** the session is released

11. **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the consumed number of units
    from the subscriber's account.

12. **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units to deduct from the
    subscriber's account.

13. **Account Control:** the OCF triggers the deduction of the
    calculated amount from the subscriber's account.

14. **Debit Units Response:** the OCF informs the CTF of the actually
    deducted units.

##### \
5.2.2.3.2 Centralized Unit Determination and Centralized Rating

In the following scenario, the CTF requests the OCF to reserve units
based on the service key specified by the CTF. An account debit
operation is carried out following the conclusion of session.

Figure 5.2.2.3.2: Session Charging with Reservation / Centralized Unit
Determination and Centralized Rating

1.  **Request for resource usage:** The UE-A requests the session
    establishment from the CTF.

2.  **Reserve Units Request:** depending on the requested type of the
    session by the UE-A, the CTF determines the service key identifier
    and forwards the Reserve Un with service key its Request to the OCF.

3.  **Units Determination:** the OCF determines the number of
    non-monetary units needed for the content/service delivery, based on
    the received service key.

4.  **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units that represent the price for the number
    of units determined in item 3.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's account balance is
    sufficient, then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of units. This includes the case where the number of units
    reserved indicates the permission to render the service that was
    identified by the received service key.

8.  **Granted Units** Supervision**:** simultaneously with the ongoing
    session, the CTF monitors the consumption of the reserved units.

9.  **Session ongoing:** the CTF maintains the session. One or more
    debit and reserve operations may be performed when the session
    is ongoing.

10. **Session Released:** the session is released.

11. **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the consumed number of units
    from the subscriber’s account

12. **Rating Control:** assisted by the rating entity the OCF calculates
    the number of monetary units to deduct from the
    subscriber's account.

13. **Account Control:** the OCF triggers the deduction of the
    calculated amount from the subscriber's account.

14. **Debit Units Response:** the OCF informs the CTF of the actually
    deducted units.

##### \
5.2.2.3.3 Decentralized Unit Determination and Decentralized Rating

In the following scenario, the CTF request the OCF to assure the
reservation of an amount of the specified number of monetary units from
the subscriber's account. An account debit operation that triggers the
deduction the amount from the subscriber's account is carried out
following the conclusion of session establishment.

Figure 5.2.2.3.3: Session Charging with Reservation / Decentralized Unit
Determination and Decentralized Rating

1.  **Request for resource usage:** The UE-A requests the session
    establishment from the CTF.

2.  **Units Determination:** depending on the requested type of the
    session by the UE-A, the CTF determines the number of
    units accordingly.

3.  **Rating Control:** the CTF calculates the number of monetary units
    that represent the price for the number of units determined in
    item 2.

4.  **Reserve Units Request:** the CTF requests the OCF to assure the
    reservation of an amount corresponding to the calculated number of
    monetary units from the subscriber's account.

5.  **Account Control:** the OCF checks whether the user's account
    balance is sufficient for the requested reservation.

6.  **Reservation Control:** if the user's credit balance is sufficient,
    then the corresponding reservation is made.

7.  **Reserve Units Response:** the OCF informs the CTF of the reserved
    number of monetary units.

8.  **Budget Control:** simultaneously with the ongoing session, the CTF
    monitors the consumption of the granted amount.

9.  **Session ongoing:** the CTF maintains the session. One or more
    debit and reserve operations may be performed when the session
    is ongoing.

10. **Session Released:** the session is released.

11. **Debit Units Request:** the CTF requests the OCF to assure the
    deduction of an amount corresponding to the consumed number of
    monetary units from the subscriber's account.

12. **Account Control:** the OCF triggers the deduction of the consumed
    amount from the subscriber's account.

13. **Debit Units Response:** the OCF indicates to the CTF the number of
    deducted monetary units.

### \
5.2.3 Basic Operations

On-line credit control uses two basic logical operations: Debit Units
and Reserve Units.

-   "*Debit Units Request*"; sent from CTF OCF\
    After receiving a service request from the subscriber, the CTF sends
    a *Debit Units Request* to the OCF. The CTF may either specify a
    service key (centralised unit determination) or the number of units
    requested (decentralised unit determination).\
    For refund purpose, the CTF sends a *Debit Units Request* to the OCF
    as well.

-   "*Debit Units Response*"; sent from OCF CTF\
    The OCF replies with a *Debit Units Response*, which informs the CTF
    of the number of units granted as a result of the *Debit Units
    Request*. This includes the case where the number of units granted
    indicates the permission to render the requested service.\
    For refund purpose, the OCF replies with a *Debit Units Response*.

-   "*Reserve Units Request*"; sent from CTF OCF\
    Request to reserve a number of units for the service to be provided
    by an CTF. In case of centralised unit determination, the CTF
    specifies a service key in the *Reserve Unit Request*, and the OCF
    determines the number of units requested. In case of decentralised
    unit determination, the number of units requested is specified by
    the CTF.

-   "*Reserve Units Response*"; sent from OCF CTF\
    Response from the OCF which informs the CTF of the number of units
    that were reserved as a result of the "*Reserve Units Request*".

IEC uses the Direct Debiting One Time Event procedure specified in RFC
4006 and therefore is performed by the use of the logical "Debit Units"
operation, as specified in section 6.3.3.

SCUR and ECUR use both the "Debit Units" and "Reserve Units" operations.

SCUR uses the Session Based Credit Control procedure specified in RFC
4006. In session charging with unit reservation, when the "Debit Units"
and "Reserve Units" operations are both needed, they shall be combined
in one message, as specified in section 6.3.5.

For SCUR and ECUR the consumed units are deducted from the subscriber's
account after service delivery. Thus, the reserved and consumed units
are not necessarily the same. Using this operation, it is also possible
for the CTF to modify the current reservation, including the return of
previously reserved units.

Table 5.2.3.1 and table 5.2.3.2 describe the content of these
operations.

Table 5.2.3.1: Debit and Reserve Units Request Content

  --------------------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------
  Debit and Reserve Units Request   Category   Description
  Session Identifier                M          This field identifies the operation session.
  Originator Host                   M          This field contains the identification of the source point of the operation.
  Originator Domain                 M          This field contains the realm of the operation originator.
  Destination Domain                M          This field contains the realm of the operation destination.
  Operation Identifier              M          This field is a unique operation identifier.
  Operation Token                   M          This field contains the service identifier.
  Operation Type                    M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Operation Number                  M          This field contains the sequence number of the transferred messages.
  Destination Host                  O~C~       This field contains the identification of the destination point of the operation.
  User Name                         O~C~       This field contains the identification of the user.
  Origination State                 O~C~       Tbd.
  Origination Timestamp             O~C~       This field contains the time when the operation is requested.
  Subscriber Identifier             O~M~       This field contains the identification of the mobile subscriber (i.e. MSISDN) that uses the requested service.
  Termination Cause                 O~C~       This field contains the termination reason of the service.
  Requested Action                  O~C~       This field contains the requested action.
  Multiple Operation                O~M~       This field indicate the occurrence of multiple operations.
  Multiple Unit Operation           O~C~       This field contains the parameter for the quota management.
  Subscriber Equipment Number       O~C~       This field contains the identification of the mobile device (i.e. IMEI) that uses the subscriber.
  Proxy Information                 O~C~       This field contains the parameter of the proxy.
  Route Information                 O~C~       This field contains the parameter of the route.
  Service Information               O~M~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  --------------------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------

Table 5.2.3.2: Debit and Reserve Units Response Content

  ---------------------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Debit and Reserve Units Response   Category   Description
  Session Identifier                 M          This field identifies the operation session.
  Operation Result                   M          This field identifies the result of the operation.
  Originator Host                    M          This field contains the identification of the source point of the operation.
  Originator Domain                  M          This field contains the realm of the operation originator.
  Operation Identifier               M          This field is a unique operation identifier.
  Operation Type                     M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Operation Number                   M          This field contains the sequence number of the transferred messages.
  Operation Failover                 O~C~       This field contains an indication to the CTF whether or not a failover handling is to be used when necessary.
  Multiple Unit Operation            O~C~       This field contains the parameter for the quota management.
  Operation Failure Action           O~C~       For credit control sessions the content of this field enables the credit-control client to decide what to do if sending credit-control messages to the credit-control server has been temporarily prevented.
  Operation Event Failure Action     O~C~       For one time event direct debiting the content of this field enables the credit-control client to decide what to do if sending credit-control messages to the credit-control server has been temporarily prevented.
  Redirection Host                   O~C~       Tbd.
  Redirection Host Usage             O~C~       Tbd.
  Redirection Cache Time             O~C~       Tbd.
  Proxy Information                  O~C~       This field contains the parameter of the proxy.
  Route Information                  O~C~       This field contains the parameter of the route.
  Failed parameter                   O~C~       This field contains missing and/or unsupported parameter that caused the failure.
  Service Information                O~C~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  ---------------------------------- ---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

5.3 Other requirements
----------------------

### 5.3.1 Re-authorization

The server may specify an idle timeout associated with a granted quota.
Alternatively, the client may have a configurable default value. The
expiry of that timer shall trigger a re-authorization request.

Mid-session service events (re-authorisation triggers) may affect the
rating of the current service usage. The server may instruct the credit
control client to re-authorize the quota upon a number of different
session related triggers that can affect the rating conditions.

When a re-authorization is trigger, the client shall reports quota
usage. The reason for the quota being reported shall be notified to the
server.

### 5.3.2 Threshold based re-authorization triggers

The server may optionally include an indication to the client of the
remaining quota threshold that shall trigger a quota re-authorization.

### 5.3.3 Termination action

The server may specify to the client the behaviour on consumption of the
final granted units, or zero units granted in the first place; this is
known as termination action.

### 5.3.4 Account Expiration

The server may provide to the client the date and time of account
expiration, which the client may use depending on operator policy.

\
6 3GPP Charging Applications – Protocol Aspects
===============================================

6.1 Basic Principles for Diameter Offline Charging
--------------------------------------------------

In order to support the offline charging principles described in the
present document, the Diameter client and server must implement at least
the following Diameter options listed in RFC 3588 \[401\], i.e. the
basic functionality of Diameter accounting, as defined by the Diameter
Base Protocol (RFC 3588 \[401\]) is re-used..

The charging architecture implementing Diameter adheres to the structure
where all communications for offline charging purposes between the CTF
(Diameter client) and the CDF (Diameter server) are carried out on the
Diameter Rf reference point, where the CTF reports charging information
to the Charging Data Function (CDF). The CDF uses this information to
construct and format CDRs. The above-mentioned reference points are
defined in TS 32.240 \[1\].

A configurable timer is supported in the CDF to supervise the reception
of the ACR \[Interim\] and/or ACR \[Stop\]. An instance of the "Timer"
is started at the beginning of the accounting session, reset on the
receipt of an ACR \[Interim\] and stopped at the reception of the ACR
\[Stop\]. Upon expiration of the timer, the CDF stops the accounting
session with the appropriate error indication.

For offline charging, the CTF implements the accounting state machine
described in RFC 3588 \[401\]. The server (CDF) implements the
accounting state machine "SERVER, STATELESS ACCOUNTING" as specified in
RFC 3588 \[401\], i.e. there is no order in which the server expects to
receive the accounting information.

The offline charging functionality is based on the network elements
reporting accounting information upon reception of various messages
which trigger charging generation, as most of the accounting relevant
information is contained in these messages. This reporting is achieved
by sending Diameter *Accounting Requests* (ACR) \[start, interim, stop
and event\] from the network elements to the CDF.

Following the Diameter base protocol specification, the following
"types" of accounting data may be sent with regard to offline charging:

1.  START session accounting data.

2.  INTERIM session accounting data.

3.  STOP session accounting data.

4.  EVENT accounting data.

Two cases are currently distinguished for offline charging purposes:

1.  Event based charging; and

2.  Session based charging.

ACR types START, INTERIM and STOP are used for accounting data related
to successful sessions. In contrast, EVENT accounting data is unrelated
to sessions, and is used e.g. for a simple registration or interrogation
and successful service event triggered by a network element. In
addition, EVENT accounting data is also used for unsuccessful session
establishment attempts.

The flows and scenarios for the above two described cases are further
detailed below.

### 6.1.1 Event based charging

In the case of event based charging, the network reports the usage or
the service rendered where the service offering is rendered in a single
operation. It is reported using the ACR EVENT.

The following figure shows the transactions that are required on the
Diameter offline interface in order to perform event based charging. The
operation may alternatively be carried out prior to, concurrently with
or after service/content delivery.

Figure 6.1.1: Event Based offline charging

Step 1: The network element receives indication that service has been
used/delivered.

Step 2: The network element (acting as client) sends
*Accounting-Request* (ACR) with *Accounting-Record-Type* AVP set to
EVENT\_RECORD to indicate service specific information to the CDF
(acting as server).

Step 3: The CDF receives the relevant service charging parameters and
processes accounting request.

Step 4: The CDF returns *Accounting-Answer* message with
*Accounting-Record-Type* AVP set to EVENT\_RECORD to the network element
in order to inform that charging information was received.

### 6.1.2 Session based charging

Session based charging is the process of reporting usage reports for a
session and uses the START, INTERIM & STOP accounting data. During a
session, a network element may transmit multiple ACR Interims' depending
on the proceeding of the session.

The following figure shows the transactions that are required on the
Diameter offline interface in order to perform session based charging.

Figure 6.1.2: Session based offline charging

Step 1: The network element receives a service request. The service
request may be initiated either by the user or the other network
element.

Step 2: In order to start accounting session, the network element sends
a *Accounting-Request* (ACR) with *Accounting-Record-Type* AVP set to
START\_RECORD to the CDF.

Step 3: The CDF opens a CDR for current session.

Step 4: The CDF returns *Accounting-Answer* (ACA) message with
*Accounting-Record-Type* set to START\_RECORD to the network element and
possibly *Acct-Interim-Interval AVP* (AII) set to non-zero value
indicating the desired intermediate charging interval.

Step 5: When either AII elapses or charging conditions changes are
recognized at Network Element (NE), the NE sends an *Accounting-Request*
(ACR) with *Accounting-Record-Type* AVP set to INTERIM\_RECORD to the
CDF.

Step 6: The CDF updates the CDR in question.

Step 7: The CDF returns *Accounting-Answer* (ACA) message with
*Accounting-Record-Type* set to INTERIM\_RECORD to the network element.

Step 8: The service is terminated.

Step 9: The network element sends a *Accounting-Request* (ACR) with
*Accounting-Record-Type* AVP set to STOP\_RECORD to the CDF.

Step 10: The CDF updates the CDR accordingly and closes the CDR.

Step 11: The CDF returns *Accounting-Answer* (ACA) message with
*Accounting-Record-Type* set to STOP\_RECORD to the network element.

### \
6.1.3 Offline charging error cases - Diameter procedures

#### 6.1.3.1 CDF connection failure

When the connection towards the primary CDF is broken, the process of
sending accounting information should continue towards a secondary CDF
(if such a CDF is configured). For further CDF connection failure
functionality, see subclause "*Transport Failure Detection*" in the RFC
3588 \[401\].

If no CDF is reachable the network element may buffer the generated
accounting data in non-volatile memory. Once the CDF connection is
working again, all accounting messages stored in the buffer is sent to
the CDF, in the order they were stored in the buffer.

#### 6.1.3.2 No reply from CDF

In case a network element does not receive an ACA in response to an ACR,
it may retransmit the ACR message. The waiting time until a
retransmission is sent, and the maximum number of repetitions are both
configurable by the operator. When the maximum number of retransmissions
is reached and still no ACA reply has been received, the network element
executes the CDF connection failure procedure as specified above.

If retransmitted ACRs' are sent, they are marked with the T-flag as
described in RFC 3588 \[401\], in order to allow duplicate detection in
the CDF, as specified in the next subclause.

#### 6.1.3.3 Duplicate detection

A Diameter client marks possible duplicate request messages (e.g.
retransmission due to the link fail over process) with the T-flag as
described in RFC 3588 \[401\].

If the CDF receives a message that is marked as retransmitted and this
message was already received, then it discards the duplicate message.
However, if the original of the re-transmitted message was not yet
received, it is the information in the marked message that is taken into
account when generating the CDR. The CDRs are marked if information from
duplicated message(s) is used.

#### 6.1.3.4 CDF detected failure

The CDF closes a CDR when it detects that expected Diameter ACRs for a
particular session have not been received for a period of time. The
exact behaviour of the CDF is operator configurable.

\
6.2 Message Contents for Offline Charging
-----------------------------------------

### 6.2.1 Summary of Offline Charging Message Formats

#### 6.2.1.1 General

The corresponding Diameter accounting application messages for the
Charging Data Transfer operation is Accounting Request (ACR) and
Accounting Answer (ACA) as specified in the Diameter Base Protocol
Accounting (DBPA) application in RFC 3588 \[401\].

The following table describes the use of these messages which are
adapted for 3GPP offline charging.

Table 6.2.1.1: Offline Charging Messages Reference Table

  ------------------------------- -------- ------------- --------------
  Command-Name                    Source   Destination   Abbreviation
  Accounting-Request              CTF      CDF           ACR
  Accounting-Answer               CDF      CTF           ACA
  Capabilities-Exchange-Request   CTF      CDF           CER
  Capabilities Exchange Answer    CDF      CTF           CEA
  ------------------------------- -------- ------------- --------------

Additional Diameter messages (i.e. DPR/DPA, DWR/DWA)are used according
to the Diameter Base Protocol Accounting (DBPA) specification in RFC
3588 \[401\].

#### 6.2.1.2 Structure for the Accounting Message Formats

The following is the basic structure shared by all offline charging
messages. This is based directly on the format of the messages defined
in the Diameter Base Protocol Application specification in RFC 3588
\[401\].

Those Diameter Accounting AVPs that are used for 3GPP Offline Charging
are marked in the table 6.2.2 and table 6.2.3 with a category as
specified in TS 32.240 \[1\].

An AVP in grey strikethrough in the message format (in grey in the
tables) is not used by 3GPP.

The following symbols are used in the message format definition:

1.  &lt;AVP&gt; indicates a mandatory AVP with a fixed position in
    > the message.

2.  {AVP} indicates a mandatory AVP in the message.

3.  \[AVP\] indicates an optional AVP in the message.

4.  \*AVP indicates that multiple occurrences of an AVP is possible.

### \
6.2.2 Accounting-Request Message

The ACR messages, indicated by the Command-Code field set to 271 is sent
by the CTF to the CDF in order to send charging information for the
requested bearer / subsystem /service.

The ACR message format is defined according to the Diameter Base
Protocol in RFC 3588 \[401\] as follows:

&lt;ACR&gt; ::= &lt; Diameter Header: 271, REQ, PXY &gt;

&lt; Session-Id &gt;

{ Origin-Host }

{ Origin-Realm }

{ Destination-Realm }

{ Accounting-Record-Type }

{ Accounting-Record-Number }

\[ Acct-Application-Id \]

~~\[ Vendor-Specific-Application-Id \]~~

\[ User-Name \]

\[ Destination-Host \]

~~\[ Accounting-Sub-Session-Id \]~~

~~\[ Acct-Session-Id \]~~

~~\[ Acct-Multi-Session-Id \]~~

\[ Acct-Interim-Interval \]

~~\[ Accounting-Realtime-Required \]~~

\[ Origin-State-Id \]

\[ Event-Timestamp \]

\* \[ Proxy-Info \]

\* \[ Route-Record \]

\[ Service-Context-Id \]

\[ Service-Information \]

\* \[ AVP \]

NOTE: Similar information as in subscription\_id should be added as 3GPP
parameter, IMEI.

Table 6.2.2 illustrates the basic structure of a 3GPP Diameter
*Accounting-Request* message as used for 3GPP offline charging.

Table 6.2.2: 3GPP Accounting-Request Message Contents

  -------------------------------- ---------- --------------------------------------------------------------------------------------------------------------------------------------------
  AVP                              Category   Description
  Session-Id                       M          This field identifies the operation session.
  Origin-Host                      M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Origin-Realm                     M          This field contains the realm of the operation originator.
  Destination-Realm                M          This field contains the realm of the operator domain. The realm will be addressed with the domain address of the corresponding public URI.
  Accounting-Record-Type           M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Accounting-Record-Number         M          This field contains the sequence number of the transferred messages.
  Acct-Application-Id              O~M~       The field corresponds to the application ID of the Diameter Accounting Application and is defined with the value 3.
  Vendor-Specific-Application-Id   -          Not used in 3GPP.
  Vendor-Id                        -          Not used in 3GPP.
  Auth-Application-Id              -          Not used in 3GPP.
  Acct-Application-Id              -          Not used in 3GPP.
  User-Name                        O~C~       Contains the user name determined by the domain: bearer, sub-system or service as described in middle tier TS.
  Destination-Host                 O~C~       This field contains the destination address of the CDF.
  Accounting-Sub-Session-Id        -          Not used in 3GPP.
  Accounting-Session-Id            -          Not used in 3GPP.
  Acct-Multi-Session-Id            -          Not used in 3GPP.
  Acct-Interim-Interval            O~C~       
  Accounting-Realtime-Required     -          Not used in 3GPP.
  Origin-State-Id                  O~C~       This field contains the state associated to the CTF.
  Event-Timestamp                  O~C~       This field corresponds to the exact time the accounting is requested.
  Proxy-Info                       O~C~       This field contains information of the host.
  Proxy-Host                       M          This field contains the identity of the host that added the Proxy-Info field.
  Proxy-State                      M          This field contains state local information.
  Route-Record                     Oc         This field contains an identifier inserted by a relaying or proxying node to identify the node it received the message from.
  Service-Context-Id               O~M~       This field indicates the service and the corresponding 'middle tier' TS.
  Service-Information              O~M~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  AVP                              Oc         
  -------------------------------- ---------- --------------------------------------------------------------------------------------------------------------------------------------------

NOTE: A detailed description of the AVPs is provided in clause 7.

### \
6.2.3 Accounting-Answer Message

The Accounting Answer (ACA) messages, indicated by the Command-Code
field set to 271 is sent by the CDF to the CTF in order to reply to the
ACR.

The ACA message format is defined according to the Diameter Base
Protocol in RFC 3588 \[401\] as follows:

&lt;ACA&gt; ::= &lt; Diameter Header: 271, PXY &gt;

&lt; Session-Id &gt;

{ Result-Code }

{ Origin-Host }

{ Origin-Realm }

{ Accounting-Record-Type }

{ Accounting-Record-Number }

\[ Acct-Application-Id \]

~~\[ Vendor-Specific-Application-Id \]~~

\[ User-Name \]

~~\[ Accounting-Sub-Session-Id \]~~

~~\[ Acct-Session-Id \]~~

~~\[ Acct-Multi-Session-Id \]~~

\[ Error-Reporting-Host \]

\[ Acct-Interim-Interval \]

~~\[ Accounting-Realtime-Required \]~~

\[ Origin-State-Id \]

\[ Event-Timestamp \]

\* \[ Proxy-Info \]

\* \[ AVP \]

Table 6.2.3 illustrates the basic structure of a 3GPP Diameter
*Accounting-Answer* message as used for offline charging. This message
is always used by the CDF as specified below, regardless of the CTF it
is received from and the ACR record type that is being replied to.

Table 6.2.3: 3GPP Accounting-Answer (ACA) Message Content

  -------------------------------- ---------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  AVP                              Category   Description
  Session-Id                       M          This field identifies the operation session.
  Result-Code                      M          This field contains the result of the specific query.
  Origin-Host                      M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Origin-Realm                     M          This field contains the realm of the operation originator.
  Accounting-Record-Type           M          This field defines the transfer type: event for event based charging and start, interim, stop for session based charging.
  Accounting-Record-Number         M          This field contains the sequence number of the transferred messages.
  Acct-Application-Id              O~M~       The field corresponds to the application ID of the Diameter Accounting Application and is defined with the value 3.
  Vendor-Specific-Application-Id   -          Not used in 3GPP
  Vendor-Id                        -          Not used in 3GPP
  Auth-Application-Id              -          Not used in 3GPP
  Acct-Application-Id              -          Not used in 3GPP
  User-Name                        O~C~       Contains the user name determined by the domain: bearer, sub-system or service as described in middle tier TS.
  Accounting-Sub-Session-Id        -          Not used in 3GPP
  Accounting-RADIUS-Session-Id     -          Not used in 3GPP
  Acct-Multi-Session-Id            -          Not used in 3GPP
  Error-Reporting-Host             O~C~       This field contains the identity of the Diameter host that sent the Result-Code AVP to a value other than 2001 (Success) if the host setting the Result-Code is different from the one encoded in the Origin-Host AVP.
  Acct-Interim-Interval            O~C~       
  Accounting-Realtime-Required     -          Not used in 3GPP
  Origin-State-Id                  O~C~       
  Event-Timestamp                  O~C~       This field contains the time when the operation is requested.
  Proxy-Info                       O~C~       This field contains information of the host.
  Proxy-Host                       M          This field contains the identity of the host that added the Proxy-Info field.
  Proxy-State                      M          This field contains state local information.
  AVP                              O~C~       Not used in 3GPP
  -------------------------------- ---------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\
6.3 Basic Principles for Diameter Online charging
-------------------------------------------------

Editor's note: This clause has been added to update the document to the
Rel-6 IETF dependency on the Diameter Credit Control Application and
currently does not exist in the 3GPP Rel-5 3GPP TS 32.225\
Page: 9\
Here we have:- Basic principles

> - List of mandatory Diameter Credit Control Application AVPs used for
> online charging,
>
> - No 3GPP AVPs unless they MUST be used every and each domain
>
> - Basic client - server signalling flow showing how CCR/CCA is used
>
> - Signalling flows for and + other common methods
>
> - (Maybe) Content of CCR/CCA in INITIAL/UPDATE/TERMINATE/EVENT cases

### 6.3.1 Online Specific Credit Control Application Requirements

For online charging, the basic functionality as defined by the IETF
Diameter Credit Control application is used. The basic structure follows
a mechanism where the online client (CTF) requests resource allocation
and reports credit control information to the Online Charging System
(OCS).

The usage and values of *Validity-Time* AVP and the timer "Tcc" are
under the sole control of the credit control server (OCS) and determined
by operator configuration of the OCS.

Editor’s note: There may be a requirement to add a minimum value for the
*Validity-Time* AVP. It may need to be moved the subsection where the
*Validity-Time AVP* is handled.

The online client implements the state machine described in RFC 4006
\[402\] for "CLIENT, EVENT BASED" and/or "CLIENT, SESSION BASED". I.e.
when the client applies IEC it uses the "CLIENT, EVENT BASED" state
machine, and when the client applies ECUR defined in 3GPP it uses the
"CLIENT, SESSION BASED" state machine for the first and final
interrogations.

The OCS implements the state machine described in RFC 4006 \[402\] for
the "SERVER, SESSION AND EVENT BASED" in order to support Immediate
Event Charging and Event Charging with Unit Reservation.

### 6.3.2 Diameter Description on the Ro reference point

Editor’s note: Message flows and scenarios should be moved into clause
5.

#### 6.3.2.1 Basic Principles

For online charging the Diameter Credit Control Application (DCCA)
defined in RFC 4006 \[402\] is used with additional AVPs defined in the
present document.

Three cases for control of user credit for online charging are
distinguished:

1.  Immediate Event Charging IEC; and

2.  event charging with unit reservation (ECUR).

3.  Session Charging with Unit Reservation (SCUR)

In the case of Immediate Event Charging (IEC),the credit control process
for events is controlled by the corresponding *CC-Requested-Type*
EVENT\_REQUEST that is sent with Credit*-Control-Request (*CCR) for a
given credit control event.

In the case of Event Charging with Unit Reservation (ECUR) the
*CC-Request-Type* INITIAL / TERMINATION\_REQUEST are used for charging
for a given credit control event, however, where a reservation is made
prior to service delivery and committed on execution of a successful
delivery.

Session Charging with Unit Reservation is used for credit control of
sessions and uses the *CC-Request-Type* INITIAL / UPDATE and
TERMINATION\_REQUEST.

The network element may apply IEC, where CCR event messages are
generated, or ECUR, using CCR Initial and Termination. The decision
whether to apply IEC or ECUR is based on the service and/or operator's
policy.

### 6.3.3 Immediate Event Charging (IEC)

Figure 6.3.3 shows the transactions that are required on the Ro
reference point in order to perform event based Direct Debiting
operation. The Direct Debiting operation may alternatively be carried
out prior to service/content delivery.\
the Network Element must ensure that the requested service execution is
successful, when this scenario is used.

Figure 6.3.3: IEC Direct Debiting Operation

Step 1. The network element receives a service request.\
The Direct Debiting Operation is performed as described in RFC 4006
\[402\].

Step 2. The network element performs direct debiting prior to service
execution. Network element (acting as DCCA client) sends
*Credit-Control-Request* (CCR) with *CC-Request-Type* AVP set to
EVENT\_REQUEST to indicate service specific information to the OCS
(acting as DCCA server). The *Requested-Action* AVP (RA) is set to
DIRECT\_DEBITING. If known, the network element may include
*Requested-Service-Unit* AVP (RSU) (monetary or non-monetary units) in
the request message.

Step 3. Having transmitted the *Credit-Control-Request* message the
network element starts the communication supervision timer 'Tx' (RFC
4006 \[402\]). Upon receipt of the *Credit-Control- Answer* (CCA)
message the network element shall stop timer Tx.

Step 4. The OCS determines the relevant service charging parameters .

Step 5. The OCS returns *Credit-Control-Answer* message with
*CC-Request-Type* AVP set to EVENT\_REQUEST to the network element in
order to authorize the service execution\
(*Granted-Service-Unit* AVP (GSU) and possibly *Cost-Information* AVP
(CI) indicating the cost of the service and *Remaining-Balance* AVP are
included in the *Credit-Control-Answer* message).\
The *Credit-Control-Answer* message has to be checked by the network
element accordingly and the requested service is controlled concurrently
with service delivery. The *Refund-Information* AVP may be included in
the *Credit-Control-Answer* message in order to be sent during the
REFUND-ACCOUNT mechanism, see below scenario.

Step 6. Service is being delivered.

NOTE: It is possible to perform also, CHECK\_BALANCE and PRICE\_ENQUIRY
using above described mechanism RFC 4006 \[402\].

Figure 6.3.3a shows the transactions for refund purpose.

Figure 6.3.3a: IEC Direct Debiting Operation for refund purpose

The Direct debiting operation is performed, previously, as described in
RFC 4006 \[402\].

Step 1. The service charged previously through Direct Debiting Operation
is finally proved to be unsuccessfully delivered.

Step 2. As a consequence, the network element performs direct debiting
operation in order to perform the related refund. Network element
(acting as DCCA client) sends *Credit-Control-Request* (CCR) with
*CC-Request-Type* AVP set to EVENT\_REQUEST to indicate service specific
information to the OCS (acting as DCCA server). The *Requested-Action*
AVP (RA) is set to REFUND-ACCOUNT. The network element includes
*Refund-Information AVP* if received in the previous IEC CCA.

Step 3. Having transmitted the *Credit-Control-Request* message the
network element starts the communication supervision timer 'Tx' (RFC
4006 \[402\]). Upon receipt of the *Credit-Control- Answer* (CCA)
message the network element shall stop timer Tx.

Step 4. The OCS reads the AVPs included in the CCR and performs the
refund accordingly.

Step 5. The OCS returns *Credit-Control-Answer* message with
*CC-Request-Type* AVP set to EVENT\_REQUEST and the related result code.

### 6.3.4 Event Charging with Unit Reservation (ECUR)

Figure 6.3.4 shows the transactions that are required on the Ro
reference point in order to perform the ECUR. ECUR is used when event
charging needs separate reserve and commit actions.

Figure 6.3.4: ECUR for session based credit control

Step 1. The network element receives a service request. The service
request may be initiated either by the user or the other network
element.

Step 2. In order to perform Reserve Units operation for a number of
units (monetary or non-monetary units), the network element sends a
*Credit-Control-Request* (CCR) with *CC-Request-Type* AVP set to
INITIAL\_REQUEST to the OCS. If known, the network element may include
*Requested-Service-Unit* (RSU) AVP (monetary or non monetary units) in
the request message.

Step 3. If the service cost information is not received by the OCS, the
OCS determines the price of the desired service according to the service
specific information received by issuing a rating request to the Rating
Function. If the cost of the service is included in the request, the OCS
directly reserves the specified monetary amount. If the credit balance
is sufficient, the OCS reserves the corresponding amount from the users
account.

> Step 4. Once the reservation has been made, the OCS returns
> *Credit-Control-Answer* (CCA) message with *CC-Request-Type* set to
> INITIAL\_REQUEST to the network element in order to authorize the
> service execution (*Granted-Service-Unit* and possibly
> *Cost-Information* indicating the cost of the service and
> *Remaining-Balance* AVP are included in the *Credit-Control-Answer*
> message). The OCS may return the *Validity-Time* (VT) AVP with value
> field set to a non-zero value. The OCS may indicate in the
> *Low-Balance-Indication* AVP that the subscriber account balance has
> fallen below a predefined treshold of this account.

Step 5. Content/service delivery starts and the reserved units are
concurrently controlled.

Step 6. When content/service delivery is completed, the network element
sends CCR with *CC-Request-Type* AVP set to TERMINATION\_REQUEST to
terminate the active credit control session and report the used units*.*

Step 7. The OCS deducts the amount used from the account. Unused
reserved units are released, if applicable.

> Step 8. The OCS acknowledges the reception of the CCR message by
> sending CCA message with *CC-Request-Type* AVP indicating
> TERMINATION\_REQUEST (possibly *Cost-Information* AVP indicating the
> cumulative cost of the service and *Remaining-Balance* AVP are
> included in the *Credit-Control-Answer* message).

NOTE: This scenario is supervised by corresponding timers (e.g. validity
time timer) that are not shown in the figure 6.3.4.

### \
6.3.5 Session Charging with Unit Reservation (SCUR)

Figure 6.3.5 shows the transactions that are required on the Ro
reference point in order to perform the SCUR.

Figure 6.3.5: SCUR for session based credit control

Step 1. The network element receives a session initiation. The session
initiation may be done either by the user or the other network element.

Step 2. In order to perform Reserve Units operation for a number of
units (monetary or non-monetary units), the network element sends a
*Credit-Control-Request* (CCR) with *CC-Request-Type* AVP set to
INITIAL\_REQUEST to the OCS. If known, the network element may include
*Requested-Service-Unit* (RSU) AVP (monetary or non monetary units) in
the request message.

Step 3. If the service cost information is not received by the OCS, the
OCS determines the price of the desired service according to the service
specific information received by issuing a rating request to the Rating
Function. If the cost of the service is included in the request, the OCS
directly reserves the specified monetary amount. If the credit balance
is sufficient, the OCS reserves the corresponding amount from the users
account.

> Step 4. Once the reservation has been made, the OCS returns
> *Credit-Control-Answer* (CCA) message with *CC-Request-Type* set to
> INITIAL\_REQUEST to the network element in order to authorize the
> service execution (*Granted-Service-Unit* and possibly
> *Cost-Information* indicating the cost of the service and
> *Remaining-Balance* AVP are included in the *Credit-Control-Answer*
> message). The OCS may return the *Validity-Time* (VT) AVP with value
> field set to a non-zero value. The OCS may indicate in the
> *Low-Balance-Indication* AVP that the subscriber account balance has
> fallen below a predefined threshold of this account.

Step 5. Content/service delivery starts and the reserved units are
concurrently controlled.

Step 6. During session delivery, in order to perform Debit Units and
subsequent Reserve Units operations, the network element sends a CCR
with *CC-Request-Type* AVP set to UPDATE\_REQUEST, to report the units
used and request additional units, respectively. The CCR message with
*CC-Request-Type* AVP set to UPDATE\_REQUEST must be sent by the network
element between the INITIAL\_REQUEST and TERMINATION\_REQUEST either on
request of the credit control application within the validity time or if
the validity time is elapsed. If known, the network element may include
*Requested-Service-Unit* AVP (monetary or non monetary units) in the
request message. The *Used-Service-Unit* (USU) AVP is complemented in
the CCR message to deduct units from both the user's account and the
reserved units, respectively.

Step 7. The OCS deducts the amount used from the account. If the service
cost information is not received by the OCS, the OCS determines the
price of the desired service according to the service specific
information received by issuing a rating request to the Rating Function.
If the cost of the service is included in the request, the OCS directly
reserves the specified monetary amount. If the credit balance is
sufficient, the OCS reserves the corresponding amount from the users
account.

> Step 8. Once the deduction and reservation have been made, the OCS
> returns *Credit-Control-Answer* message with *CC-Request-Type* set to
> UPDATE\_REQUEST to the network element, in order to allow the
> content/service delivery to continue (new *Granted-Service-Unit*
> *(GSU) AVP* and possibly *Cost-Information* *(CI) AVP* indicating the
> cumulative cost of the service and *Remaining-Balance* AVP are
> included in the *Credit‑Control-Answer* message). The OCS may include
> in the CCA message the *Final-Unit-Indication* (FUI) AVP to indicate
> the final granted units. The OCS may indicate in the
> *Low-Balance-Indication* AVP that the subscriber account balance has
> fallen below a predefined threshold of this account.

Step 9. Session delivery continues and the reserved units are
concurrently controlled.

Step 10. The session is terminated at the network element.

Step 11. The network element sends CCR with *CC-Request-Type* AVP set to
TERMINATION\_REQUEST to terminate the active credit control session and
report the used units*.*

Step 12. The OCS deducts the amount used from the account. Unused
reserved units are released, if applicable.

> Step 13. The OCS acknowledges the reception of the CCR message by
> sending CCA message with *CC-Request-Type* AVP indicating
> TERMINATION\_REQUEST (possibly *Cost-Information* AVP indicating the
> cumulative cost of the service and *Remaining-Balance* AVP are
> included in the *Credit-Control-Answer* message).

NOTE: This scenario is supervised by corresponding timers (e.g. validity
time timer) that are not shown in figure 6.3.5.

### \
6.3.6 Error Cases and Scenarios

This subclause describes various error cases and how these should be
handled.

The failure handling behaviour is locally configurable in the network
element. If the *Direct-Debiting-Failure-Handling* or
*Credit-Control-Failure-Handling* AVP is not used, the locally
configured values are used instead.

#### 6.3.6.1 Duplicate Detection

The detection of duplicate request is needed and must be enabled. To
speed up and simplify as much as possible the duplicate detection, the
all-against-all record checking should be avoided and just those records
marked as potential duplicates need to be checked against other received
requests (in real-time ) by the receiver entity.

The network element marks the request messages that are retransmitted
after a link fail over as possible duplicates with the T-flag as
described in RFC 3588 \[401\]. For optimized performance, uniqueness
checking against other received requests is only necessary for those
records marked with the T-flag received within a reasonable time window.
This focused check is based on the inspection of the *Session-Id* and
*CC-Request-Number* AVP pairs.

Note that for EBCC the duplicate detection is performed in the
Correlation Function that is part of the OCS. The OCS that receives the
possible duplicate request should mark as possible duplicate the
corresponding request that is sent over the 'Rc' reference point.
However, this assumption above is for further study and needs to be
clarified.

For credit control duplicate detection, please refer to the Diameter
Credit Control.

#### 6.3.6.2 Reserve Units and Debit Units Operation Failure

In the case of an OCS connection failure, and/or receiving error
responses from the OCS, please refer to RFC 3588 \[401\] and RFC 4006
\[402\] for failure handling descriptions.

### 6.3.7 Support of Tariff Changes during an Active User Session

#### 6.3.7.1 Support of Tariff Changes using the Tariff Switch Mechanism

After a tariff switch has been reached, all the active user sessions
shall report their session usage by the end of the validity period of
the current request and receive new quota for resource usage for the new
tariff period.

In order to avoid the need for mass simultaneous quota refresh, the
traffic usage can be split into resource usage before a tariff switch
and resources used after a tariff switch.

The Tariff-Time-Change AVP is used to determine the tariff switch time
as described by RFC 4006 \[402\]. In addition to the scenarios described
in RFC 4006 \[402\], the Tariff-Time-Change AVP may also be used in the
context of continuously time-based charging.

The Tariff-Change-Usage AVP is used within the Used-Service-Units AVP to
distinguish reported usage before and after the tariff time change.

The Tariff-Change-Usage AVP is not used directly within the
Multiple-Services-Credit-Control AVP.

#### 6.3.7.2 Support of Tariff Changes using Validity Time AVP

Changes to the tariffs pertaining to the service during active user
sessions may also be handled using the Validity Time AVP.

NOTE: RFC 4006 does not directly describe how tariff changes are handled
with validity time. If validity time is used for tariff time changes it
might overload the client and the server.

### \
6.3.8 Support of Re-authorisation

Mid Diameter CC session re-authorisations of multiple active resource
quotas within a DCC session can be achieved using a single Diameter
*Credit Control Request/Answer* message sequence.

The OCS may also re-authorise multiple active resource quotas within a
DCC session by using a single Diameter *Re-Auth-Request/Answer* message
sequence.

New quota allocations received by the Network Element override any
remaining held quota resources after accounting for any resource usage
while the re-authorisation was in progress.

### 6.3.9 Support of Failure Handling

The Credit-Control-Failure-Handling AVP as defined in RFC 4006 \[402\]
determines what to do if the sending of Diameter credit-control messages
to the OCS has been temporarily prevented. The usage of
Credit-Control-Failure-Handling AVP gives flexibility to have different
failure handling for credit-control session.

This AVP may be received from the OCS or may be locally configured. The
value received from the OCS in the Diameter Credit-Control-Answer
message always override any already existing value.

As defined in RFC 4006 \[402\], the Tx timer is introduced to limit the
waiting time in the CTF for an answer to the credit control request sent
to the OCS. When the Tx timer elapses the CTF takes an action to the end
user according to the value of the Credit-Control-Failure-Handling AVP.

It is possible that several concurrent Credit Control Request messages
are triggered for the same online charging session. In this case, each
Credit Control Request message shall reset the Tx timer as defined in
RFC 4006 \[402\].

### 6.3.10 Support of Failover

As defined in RFC 4006 \[402\] if a failure occurs during an ongoing
credit-control session, the CTF may move the credit control message
stream to an alternative OCS if the primary OCS indicated
FAILOVER\_SUPPORTED in the CC-Session-Failover AVP. In case
CC-Session-Failover AVP is set to FAILOVER\_NOT SUPPORTED the credit
control message stream is not moved to a backup OCS.

For new credit control sessions, failover to an alternative OCS should
be performed if possible. For instance, if an implementation of the CTF
can determine primary OCS unavailability it can establish the new credit
control sessions with a possibly available secondary OCS.

Since the OCS has to maintain session states, moving the credit-control
message stream to a backup OCS requires a complex charging context
transfer solution. This charging context transfer mechanism by OCS is
out of the scope of the 3GPP standardization work.

### 6.3.11 Credit Pooling

Credit pooling shall be supported as described in TS 32.240 \[1\].

Note: Credit pooling is not applicable to IEC since there is no quota
management between CTF and OCF.

\
6.4 Message formats for Online Charging
---------------------------------------

### 6.4.1 Summary of Online Charging Message Formats

#### 6.4.1.1 General

The corresponding Diameter credit control application messages for the
Debit / Reserve Unit Request operation is Credit-Control-Request (CCR)
and for the Debit / Reserve Unit Response operation is
Credit-Control-Answer (CCA) as specified in RFC 4006 \[402\].

The Diameter Credit-Control Application (DCCA) specifies an approach
based on a series of "interrogations":

1.  Initial interrogation.

2.  Zero, one or more interim interrogations.

3.  Final interrogation.

In addition to a series of interrogations, also a one time event
(interrogation) can be used e.g. in the case when service execution is
always successful.

All of these interrogations use Credit*-Control-Request* and
*Credit-Control-Answer* messages. The *Credit-Control-Request* for the
"interim interrogation" and "final interrogation" reports the actual
number of "units" that were used, from what was previously reserved.
This determines the actual amount debited from the subscriber's account.

Table 6.4.1.1 describes the use of these Diameter messages which are
adapted for 3GPP online charging.

Table 6.4.1.1: Online Charging Messages Reference Table

  ------------------------------- -------- ------------- --------------
  Command-Name                    Source   Destination   Abbreviation
  Credit-Control-Request          CTF      OCS           CCR
  Credit-Control-Answer           OCS      CTF           CCA
  Capabilities-Exchange-Request   CTF      OCS           CER
  Capabilities Exchange Answer    OCS      CTF           CEA
  ------------------------------- -------- ------------- --------------

Additional Diameter messages (i.e. ASR/ASA, DPR/DPA, DWR/DWA, RAR/RAA)
are used according to the Diameter Base Protocol Accounting (DBPA)
specification in RFC 3588 \[401\] and to the DCCA specification in RFC
4006 \[402\].

#### \
6.4.1.2 Structure for the Credit Control Message Formats

The following is the basic structure shared by all online charging
messages. This is based directly on the format of the messages defined
in RFC 4006 \[402\].

Those Diameter Accounting AVPs that are used for 3GPP online charging
are marked in the table of contents 6.4.2 and 6.4.3 with a category as
specified in TS 32.240 \[1\].

In the definition of the Diameter Commands, the AVPs that are specified
in the referenced specifications but not used by the 3GPP charging
specifications are marked with strikethrough, e.g. ~~\[
Acct-Multi-Session-Id \]~~.

The following symbols are used in the message format definitions:

1.  &lt;AVP&gt; indicates a mandatory AVP with a fixed position in
    > the message.

2.  {AVP} indicates a mandatory AVP in the message.

3.  \[AVP\] indicates an optional AVP in the message.

4.  \*AVP indicates that multiple occurrences of an AVP is possible.

### \
6.4.2 Credit-Control-Request Message

The CCR messages, indicated by the Command-Code field set to 272 is sent
by the CTF to the OCF in order to request credits for the request bearer
/ subsystem /service.

The CCR message format is defined according to RFC 4006 \[402\] as
follows:

&lt;CCR&gt; ::= &lt; Diameter Header: 272, REQ, PXY &gt;

**&lt;** Session-Id &gt;

{ Origin-Host }

{ Origin-Realm }

{ Destination-Realm }

{ Auth-Application-Id }

{ Service-Context-Id }

{ CC-Request-Type }

{ CC-Request-Number }

\[ Destination-Host \]

\[ User-Name \]

~~\[ CC-Sub-Session-Id \] ~~

~~\[ Acct-Multi-Session-Id \] ~~

\[ Origin-State-Id \]

\[ Event-Timestamp \]

\*\[ Subscription-Id \]

~~\[ Service-Identifier \] ~~

\[ Termination-Cause \]

~~\[ Requested-Service-Unit \] ~~

\[ Requested-Action \]

~~\*\[ Used-Service-Unit \] ~~

\[ AoC-Request-Type \]

\[ Multiple-Services-Indicator \]

\*\[ Multiple-Services-Credit-Control \]

~~\*\[ Service-Parameter-Info \] ~~

\[ CC-Correlation-Id \]

\[ User-Equipment-Info \]

\*\[ Proxy-Info \]

\*\[ Route-Record \]

\[ Service-Information \]

\*\[ AVP \]

Table 6.4.2 illustrates the basic structure of a 3GPP Diameter Credit
Control *Credit-Control-Request* message as used for Online Charging.

Table 6.4.2: 3GPP Credit-Control-Request Message Content

  ---------------------------------- ---------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  AVP                                Category   Description
  Session-Id                         M          This field identifies the operation session.
  Origin-Host                        M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Origin-Realm                       M          This field contains the realm of the operation originator.
  Destination-Realm                  M          This field contains the realm of the operator domain. The realm will be addressed with the domain address of the corresponding public URI.
  Auth-Application-Id                M          The field corresponds to the application ID of the Diameter Credit Control Application and is defined with the value 4.
  Service-Context-Id                 M          This field indicates the supported protocol version.
  CC-Request-Type                    M          This field defines the transfer type: event for event based charging and initial, update, terminate for session based charging.
  CC-Request-Number                  M          This field contains the sequence number of the transferred messages.
  Destination-Host                   O~C~       This field contains the destination peer address of the OCS identity.
  User-Name                          O~C~       Contains the user name determined by the domain: bearer, sub-system or service as described in middle tier TS.
  CC-Sub-Session-Id                  -          Not used in 3GPP.
  Acct-Multi-Session-Id              -          Not used in 3GPP.
  Origin-State-Id                    O~C~       This field contains the state associated to the CTF.
  Event-Timestamp                    O~C~       This field corresponds to the exact time the quota is requested.
  Subscription-Id                    O~M~       This field contains the identification of the user that is going to access the service in order to be identified by the OCS.
  Subscription-Id-Type               M          This field determines the type of the identifier, e.g. t value 0 is used for the international E.164 format according to ITU-T E.164 numbering plan.
  Subscription-Id-Data               M          This field contains the user data content e.g. the MSISDN.
  Service-Identifier                 -          Not used in 3GPP.
  Termination-Cause                  O~C~       This field contains the reason the credit control session was terminated.
  Requested-Service-Unit             -          Not used in 3GPP, see Multiple-Services-Credit-Control.
  CC-Time                            -          Not used in 3GPP.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    -          Not used in 3GPP.
  CC-Input-Octets                    -          Not used in 3GPP.
  CC-Output-Octets                   -          Not used in 3GPP.
  CC-Service-Specific-Units          -          Not used in 3GPP.
  AVP                                -          Not used in 3GPP.
  Requested-Action                   O~C~       The field defines the type of action if the CC-Request-Type indicates EVENT.
  AoC-Request-Type                   Oc         This field denotes if AoC Information is requested and what type of information is needed.
  Used-Service-Unit                  -          Not used in 3GPP, see Multiple-Services-Credit-Control.
  Tariff-Change-Usage                -          Not used in 3GPP.
  CC-Time                            -          Not used in 3GPP.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    -          Not used in 3GPP.
  CC-Input-Octets                    -          Not used in 3GPP.
  CC-Output-Octets                   -          Not used in 3GPP.
  CC-Service-Specific-Units          -          Not used in 3GPP.
  AVP                                -          Not used in 3GPP.
  Multiple-Services-Indicator        O~M~       This field indicates whether the CTF is capable of handling multiple services independently.
  Multiple-Services-Credit Control   O~C~       This field contains all parameters for the CTF quota management and defines the quotas to allow traffic to flow.
  Granted-Service-Unit               -          Not used in CCR.
  Tariff-Change-Usage                -          Not used in CCR.
  CC-Time                            -          Not used in CCR.
  CC-Money                           -          Not used in CCR.
  Unit-Value                         -          Not used in CCR.
  Value-Digits                       -          Not used in CCR.
  Exponent                           -          Not used in CCR.
  Currency-Code                      -          Not used in CCR.
  CC-Total-Octets                    -          Not used in CCR.
  CC-Input-Octets                    -          Not used in CCR.
  CC-Output-Octets                   -          Not used in CCR.
  CC-Service-Specific-Units          -          Not used in CCR.
  AVP                                -          Not used in 3GPP.
  Requested-Service-Unit             O~C~       This field contains the amount of requested service units for a particular category or an indication that units are needed for a particular category, as defined in DCCA \[402\].
  CC-Time                            O~C~       This field contains the amount of requested time.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    O~C~       This field contains the requested amount of octets to be sent and received.
  CC-Input-Octets                    O~C~       This field contains the requested amount of octets to be received.
  CC-Output-Octets                   O~C~       This field contains the requested amount of octets to be sent.
  CC-Service-Specific-Units          O~C~       This field contains the requested amount of service specific units, e.g. number of events.
  AVP                                -          Not used in 3GPP.
  Used-Service-Unit                  O~C~       This field contains the amount of used non-monetary service units measured for a particular category to a particular quota type.
  Reporting-Reason                   O~C~       Used as defined in clause 7.2.
  Tariff-Change-Usage                O~C~       This field identifies the reporting period for the used service unit, i.e. before, after or during tariff change.
  CC-Time                            O~C~       This field contains the amount of used time.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    O~C~       This field contains the amount of sent and received octets.
  CC-Input-Octets                    O~C~       This field contains the amount of received octets.
  CC-Output-Octets                   O~C~       This field contains the amount of sent octets.
  CC-Service-Specific-Units          O~C~       This field contains the amount of service specific units, e.g. number of events.
  Event-Charging-TimeStamp           Oc         Used as defined in clause 7.2.
  AVP                                -          Not used in 3GPP.
  Tariff-Change-Usage                -          Not used in 3GPP.
  Service-Identifier                 O~C~       This field contains identity of the used service. This ID with the Service-Context-ID together forms an unique identification of the service.
  Rating-Group                       O~C~       This field contains the identifier of a rating group.
  G-S-U-Pool-Reference               -          Not used in CCR.
  G-S-U-Pool-Identifier              -          Not used in CCR.
  CC-Unit-Type                       -          Not used in CCR.
  Unit-Value                         -          Not used in CCR.
  Value-Digits                       -          Not used in CCR.
  Exponent                           -          Not used in CCR.
  Validity-Time                      -          Not used in CCR.
  Result-Code                        -          Not used in CCR.
  Final-Unit-Indication              -          Not used in CCR.
  Final-Unit-Action                  -          Not used in CCR.
  Restriction-Filter-Rule            -          Not used in CCR.
  Filter-Id                          -          Not used in CCR.
  Redirect-Server                    -          Not used in CCR.
  Redirect-Address-Type              -          Not used in CCR.
  Redirect-Server-Address            -          Not used in CCR.
  Time-Quota-Threshold               -          Not used in CCR.
  Volume-Quota-Threshold             -          Not used in CCR.
  Quota-Holding-Time                 -          Not used in CCR.
  Quota-Consumption-Time             -          Not used in CCR.
  Reporting-Reason                   O~C~       Used as defined in clause 7.2.
  Trigger                            O~C~       Used as defined in clause 7.2.
  Trigger-Type                       O~C~       Used as defined in clause 7.2.
  Refund-Information                 O~C~       Used as defined in clause 7.2.
  Envelope                           O~C~       Used as defined in clause 7.2.
  Envelope-Start-Time                M          Used as defined in clause 7.2.
  Envelope-End-Time                  O~C~       Used as defined in clause 7.2.
  CC-Total-Octets                    O~C~       Used as defined in clause 7.2.
  CC-Input-Octets                    O~C~       Used as defined in clause 7.2.
  CC-Output-Octets                   O~C~       Used as defined in clause 7.2.
  CC-Service-Specific-Units          O~C~       Used as defined in clause 7.2
  AVP                                O~C~       
  AF-Correlation-Information         O~C~       Used as defined in clause 7.2.
  Service-Specific-Info              O~C~       Used as defined in clause 7.2.
  Service-Specific-Type              O~C~       Used as defined in clause 7.2.
  Service-Specific-Data              O~C~       Used as defined in clause 7.2.
  QoS-Information                    O~C~       This field contains authorized QoS applicable for service data flow, which initially triggers the activation of this MSCC instance. Included in first quota request to rating group if service data flow specific QoS control is in use, see TS 29.212 \[215\] for more information. For IP-CAN bearer specific Rating Group/Service Identifier this field is not included.
  QoS-Class-Identifier               M          See TS 29.212 \[215\] for more information.
  Max-Requested-Bandwidth-UL         O~C~       See TS 29.212 \[215\] for more information.
  Max-Requested-Bandwidth-DL         O~C~       See TS 29.212 \[215\] for more information.
  Guaranteed-Bitrate-UL              O~C~       See TS 29.212 \[215\] for more information.
  Guaranteed-Bitrate-DL              O~C~       See TS 29.212 \[215\] for more information.
  Bearer-Identifier                  O~C~       See TS 29.212 \[215\] for more information.
  Allocation-Retention-Priority      O~C~       See TS 29.212 \[215\] for more information.
  Priority-Level                     O~C~       See TS 29.212 \[215\] for more information.
  Pre-emption-Capability             O~C~       See TS 29.212 \[215\] for more information.
  Pre-emption-Vulnerability          O~C~       See TS 29.212 \[215\] for more information.
  APN-Aggregate-Max-Bitrate-UL       O~C~       See TS 29.212 \[215\] for more information.
  APN-Aggregate-Max-Bitrate-DL       O~C~       See TS 29.212 \[215\] for more information.
  AVP                                -          Not used in 3GPP.
  Service-Parameter-Info             -          Not used in 3GPP.
  Service-Parameter-Type             -          Not used in 3GPP.
  Service-Parameter-Value            -          Not used in 3GPP.
  CC-Correlation-Id                  O~C~       This field contains information to correlate credit-control requests generated for different components of the service, e.g., transport and service level.
  User-Equipment-Info                O~C~       This field contains the identification of the identity and terminal capability the subscriber is using for the connection to mobile network if available.
  User-Equipment-Info-Type           M          This field determines the type of the identifier. The used value is 0 for the international mobile equipment identifier and software version according to TS 23.003\[224\].
  User-Equipment-Info-Value          M          This field contains the user IMEISV.
  Proxy-Info                         O~C~       This field contains information of the host.
  Proxy-Host                         M          This field contains the identity of the host that added the Proxy-Info field.
  Proxy-State                        M          This field contains state local information.
  Route-Record                       O~C~       This field contains an identifier inserted by a relaying or proxying node to identify the node it received the message from.
  Service-Information                O~M~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  AVP                                O~C~       
  ---------------------------------- ---------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### \
6.4.3 Credit-Control-Answer Message

The Credit-Control-Answer (CCA) messages, indicated by the Command-Code
field set to 272 is sent by the OCF to the CTF in order to reply to the
CCR.

The CCA message format is defined according to RFC 4006 \[402\] as
follows:

&lt;CCA&gt; ::= &lt; Diameter Header: 272, PXY &gt;

&lt; Session-Id &gt;

{ Result-Code }

{ Origin-Host }

{ Origin-Realm }

{ Auth-Application-Id }

{ CC-Request-Type }

{ CC-Request-Number }

~~\[ User-Name \] ~~

\[ CC-Session-Failover \]

~~\[ CC-Sub-Session-Id \] ~~

~~\[ Acct-Multi-Session-Id \] ~~

~~\[ Origin-State-Id \] ~~

~~\[ Event-Timestamp \] ~~

~~\[ Granted-Service-Unit \] ~~

\*\[ Multiple-Services-Credit-Control \]

\[ Cost-Information\]

\[ Low-Balance-Indication \]

\[ Remaining-Balance \]

~~\[ Final-Unit-Indication \] ~~

~~\[ Check-Balance-Result \] ~~

\[ Credit-Control-Failure-Handling \]

\[ Direct-Debiting-Failure-Handling \]

~~\[ Validity-Time\] ~~

\*\[ Redirect-Host\]

\[ Redirect-Host-Usage \]

\[ Redirect-Max-Cache-Time \]

\*\[ Proxy-Info \]

\*\[ Route-Record \]

\*\[ Failed-AVP \]

\[ Service-Information \]

\*\[ AVP \]

Table 6.4.3 illustrates the basic structure of a 3GPP Diameter
Credit-Control *Credit-Control-Answer* message as used for online
charging. This message is always used by the OCF as specified below,
independent of the receiving CTF and the CCR record type that is being
replied to.

Table 6.4.3: 3GPP Credit-Control-Answer Message Content

  ---------------------------------- ---------- -----------------------------------------------------------------------------------------------------------------------------------------------
  AVP                                Category   Description
  Session-Id                         M          This field identifies the operation session.
  Result-Code                        M          This field contains the result of the specific query.
  Origin-Host                        M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Origin-Realm                       M          This field contains the realm of the operation originator.
  Auth-Application-Id                M          The field corresponds to the application ID of the Diameter Credit Control Application and is defined with the value 4.
  CC-Request-Type                    M          This field defines the transfer type: initial, update, terminate for session based charging and event for event based charging.
  CC-Request-Number                  M          This field contains the sequence number of the transferred messages.
  User-Name                          -          Not used in 3GPP.
  CC-Session Failover                O~C~       This field contains an indication to the CTF whether or not a failover handling is to be used when necessary.
  CC-Sub-session-Id                  -          Not used in 3GPP.
  Acct-Multi-Session-Id              -          Not used in 3GPP.
  Origin-State-Id                    -          Not used in 3GPP.
  Event-Timestamp                    -          Not used in 3GPP.
  Granted-Service-Unit               -          Not used in 3GPP, see Multiple-Services-Credit-Control.
  Tariff-Time-Change                 -          Not used in 3GPP.
  CC-Time                            -          Not used in 3GPP.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    -          Not used in 3GPP.
  CC-Input-Octets                    -          Not used in 3GPP.
  CC-Output-Octets                   -          Not used in 3GPP.
  CC-Service-Specific-Units          -          Not used in 3GPP.
  AVP                                -          Not used in 3GPP.
  Multiple-Services-Credit-Control   O~C~       This field contains all parameters for the CTF quota management and defines the quotas to allow traffic to flow.
  Granted-Service-Unit               O~C~       This field contains the amount of granted service units for a particular category.
  Tariff-Time-Change                 O~C~       This field identifies the reporting period for the granted service units, i.e. before, after or during tariff change.
  CC-Time                            O~C~       This field contains the amount of granted time.
  CC-Money                           -          Not used in 3GPP.
  Unit-Value                         -          Not used in 3GPP.
  Value-Digits                       -          Not used in 3GPP.
  Exponent                           -          Not used in 3GPP.
  Currency-Code                      -          Not used in 3GPP.
  CC-Total-Octets                    O~C~       This field contains the amount for sent and received octets.
  CC-Input-Octets                    O~C~       This field contains the amount for received octets.
  CC-Output-Octets                   O~C~       This field contains the amount for sent octets.
  CC-Service-Specific-Units          O~C~       This field contains the amount for service specific units, e.g. number of events.
  AVP                                -          Not used in CCA.
  Requested-Service-Unit             -          Not used in CCA.
  Tariff-Time-Change                 -          Not used in CCA.
  CC-Time                            -          Not used in CCA.
  CC-Money                           -          Not used in CCA.
  Unit-Value                         -          Not used in CCA.
  Value-Digits                       -          Not used in CCA.
  Exponent                           -          Not used in CCA.
  Currency-Code                      -          Not used in CCA.
  CC-Total-Octets                    -          Not used in CCA.
  CC-Input-Octets                    -          Not used in CCA.
  CC-Output-Octets                   -          Not used in CCA.
  CC-Service-Specific-Units          -          Not used in CCA.
  Used-Service-Unit                  -          Not used in CCA.
  Tariff-Time-Change                 -          Not used in CCA.
  CC-Time                            -          Not used in CCA.
  CC-Money                           -          Not used in CCA.
  Unit-Value                         -          Not used in CCA.
  Value-Digits                       -          Not used in CCA.
  Exponent                           -          Not used in CCA.
  Currency-Code                      -          Not used in CCA.
  CC-Total-Octets                    -          Not used in CCA.
  CC-Input-Octets                    -          Not used in CCA.
  CC-Output-Octets                   -          Not used in CCA.
  CC-Service-Specific-Units          -          Not used in CCA.
  Tariff-Change-Usage                -          Not used in 3GPP.
  Service-Identifier                 O~C~       This field contains identity of the used service. This ID with the Service-Context-ID together forms an unique identification of the service.
  Rating-Group                       O~C~       This field contains the identifier of a rating group.
  G-S-U-Pool-Reference               O~C~       Only used in ECUR and SCUR.
  G-S-U-Pool-Identifier              M          
  CC-Unit-Type                       M          
  Unit-Value                         M          
  Value-Digits                       M          
  Exponent                           O~C~       
  Validity-Time                      O~C~       This field defines the time in order to limit the validity of the granted quota for a given category instance.
  Result-Code                        O~C~       This field contains the result of the query.
  Final-Unit-Indication              O~C~       This field indicates that the Granted-Service-Unit containing the final units for the service.
  Final-Unit-Action                  M          
  Restriction-Filter-Rule            O~C~       
  Filter-Id                          O~C~       
  Redirect-Server                    O~C~       
  Redirect-Address-Type              M          
  Redirect-Server-Address            M          
  Time-Quota-Threshold               O~C~       Used as defined in clause 7.2.
  Volume-Quota-Threshold             O~C~       Used as defined in clause 7.2.
  Unit-Quota-Threshold               O~C~       Used as defined in clause 7.2.
  Quota-Holding-Time                 O~C~       Used as defined in clause 7.2.
  Quota-Consumption-Time             O~C~       Used as defined in clause 7.2.
  Reporting-Reason                   -          Not used in CCA.
  Trigger                            Oc         Used as defined in clause 7.2.
  Trigger-Type                       O~C~       Used as defined in clause 7.2.
  PS-Furnish-Charging-Information    O~C~       Used as defined in clause 7.2.
  Refund-Information                 O~C~       Used as defined in clause 7.2.
  Envelope-Reporting                 O~C~       Used as defined in clause 7.2.
  Time-Quota-Mechanism               O~C~       Used as defined in clause 7.2.
  Time-Quota-Type                    M          Used as defined in clause 7.2.
  Base-Time-Interval                 M          Used as defined in clause 7.2.
  AF-Correlation-Information         -          Not used in CCA.
  AVP                                -          Not used in 3GPP.
  Cost-Information                   O~C~       Used as defined in DCCA \[402\].
  Unit-Value                         M          Used as defined in DCCA \[402\].
  Value-Digits                       M          Used as defined in DCCA \[402\].
  Exponent                           O~C~       Used as defined in DCCA \[402\].
  Currency-Code                      M          Used as defined in DCCA \[402\].
  Cost-Unit                          O~C~       Used as defined in DCCA \[402\].
  Low-Balance-Indication             Oc         This field indicates whether the subscriber account balance went below a designated threshold set by his account.
  Remaining-Balance                  O~C~       This field contains the remaining balance of the subscriber.
  Unit-Value                         M          Used as defined in DCCA \[402\].
  Value-Digits                       M          Used as defined in DCCA \[402\].
  Exponent                           O~C~       Used as defined in DCCA \[402\].
  Currency-Code                      M          Used as defined in DCCA \[402\].
  Final-Unit-Indication              -          Not used in 3GPP, see Multiple-Services-Credit-Control.
  Final-Unit-Action                  -          Not used in 3GPP.
  Restriction-Filter-Rule            -          Not used in 3GPP.
  Filter-Id                          -          Not used in 3GPP.
  Redirect-Server                    -          Not used in 3GPP.
  Redirect-Address-Type              -          Not used in 3GPP.
  Redirect-Server-Address            -          Not used in 3GPP.
  Check-Balance-Result               -          Not used in 3GPP.
  Credit-Control-Failure-Handling    O~C~       Used as defined in DCCA \[402\].
  Direct-Debiting-Failure-Handling   O~C~       Used as defined in DCCA \[402\].
  Validity-Time                      -          Not used in 3GPP.
  Redirect-Host                      O~C~       
  Redirect-Host-Usage                O~C~       
  Redirect-Max-Cache-Time            O~C~       
  Proxy-Info                         O~C~       This field contains information of the host.
  Proxy-Host                         M          This field contains the identity of the host that added the Proxy-Info field.
  Proxy-State                        M          This field contains state local information.
  Route-Record                       O~C~       This field contains an identifier inserted by a relaying or proxying node to identify the node it received the message from.
  Failed-AVP                         O~C~       
  Service-Information                O~C~       This parameter holds the individual service specific parameters as defined in the corresponding ‘middle tier’ TS.
  AVP                                O~C~       
  ---------------------------------- ---------- -----------------------------------------------------------------------------------------------------------------------------------------------

### 6.4.4 Re-Auth-Request Message

Table 6.4.4 illustrates the basic structure of a Diameter Credit Control
*Re-Auth-Request* message as used for online charging.

Table 6.4.4: Re-Auth-Request (RAR) Message Contents for Online Charging

  ----------------------- ---------- --------------------------------------------------------------------------------------------------------------------------------------------
  AVP                     Category   Description
  Session-Id              M          This field identifies the operation session.
  Origin-Host             M          This field contains the identification of the source point of the operation and the realm of the operation originator.
  Origin-Realm            M          This field contains the realm of the operation originator.
  Destination-Realm       M          This field contains the realm of the operator domain. The realm will be addressed with the domain address of the corresponding public URI.
  Destination-Host        M          This field contains the destination peer address of the OCS identity.
  Auth-Application-Id     M          The field corresponds to the application ID of the Diameter Credit Control Application and is defined with the value 4.
  Re-Auth-Request-Type    M          This field is used to inform the CTF of the action expected upon expiration of the Authorization-Lifetime
  User-Name               O~C~       This field contains the username.
  Origin-State-Id         O~C~       This field contains the state associated to the CTF.
  Proxy-Info              O~C~       This field contains information of the host.
  Proxy-Host              M          This field contains the identity of the host that added the Proxy-Info field.
  Proxy-State             M          This field contains state local information.
  Route-Record            O~C~       This field contains an identifier inserted by a relaying or proxying node to identify the node it received the message from.
  CC-Sub-Session-Id       -          Not used in 3GPP.
  G-S-U-Pool-Identifier   O~C~       This field contains an identifier to indicate the credit pool.
  Service-Identifier      O~C~       
  Rating-Group            O~C~       
  AVP                     O~C~       
  ----------------------- ---------- --------------------------------------------------------------------------------------------------------------------------------------------

### \
6.4.5 Re-Auth-Answer Message

Table 6.4.5 illustrates the basic structure of a Diameter Credit Control
*Re-Auth-Answer* message as used for online charging.

Table 6.4.5: Re-Auth-Answer (RAA) Message Contents for Online Charging

  ------------------------------------------ --------------
  Diameter Credit Control Application AVPs
  AVP
  &lt;Diameter Header: 258, PXY&gt;
  &lt;Session-Id&gt;
  {Result-Code}
  {Origin-Host}
  {Origin-Realm}
  \[User-Name\]
  \[Origin-State-Id\]
  \[Error-Message\]
  \[Error-Reporting-Host\]
  \*\[Failed-AVP\]
  \*\[Redirect-Host\]
  \[Redirect-Host-Usage\]
  \[Redirect-Max-Cache-Time\]
  \* \[Proxy-Info\]
  { Proxy-Host }
  { Proxy-State }
  \*\[AVP\]
  ------------------------------------------ --------------

*Editor's note: The rationale for "NO" above should be provided. If the
message is identical to the definition in DCC the table may be replaced
by a reference to DCC.*

### 6.4.6. Capabilities-Exchange-Request Message

The Capabilities-Exchange-Request message structure is described in RFC
3588 \[401\].

### 6.4.7 Capabilities-Exchange-Answer Message

The Capabilities-Exchange-Answer message structure is described in RFC
3588 \[401\].

### 6.4.8 Device-Watchdog-Request Message

The Device-Watchdog-Request message structure is described in RFC 3588
\[401\].

### 6.4.9 Device-Watchdog-Answer Message

The Device-Watchdog-Answer message structure is described in RFC 3588
\[401\].

### 6.4.10 Disconnect-Peer-Request Message

The Disconnect-Peer-Request message structure is described in RFC 3588
\[401\].

### 6.4.11 Disconnect-Peer-Answer Message

The Disconnect-Peer-Answer message structure is described in RFC 3588
\[401\].

### 6.4.12 Abort-Session-Request Message

The Abort-Session-Request message structure is described in RFC 3588
\[401\].

### 6.4.13 Abort-Session -Answer Message

The Abort-Session-Answer message structure is described in RFC 3588
\[401\].

6.5 Other procedural description of the 3GPP charging applications
------------------------------------------------------------------

### 6.5.1 Re-authorization

#### 6.5.1.1 Idle timeout

The server may specify an idle timeout associated with a granted quota
using the Quota-Holding-Time AVP. If no traffic associated with the
quota is observed for this time, the client shall understand that the
traffic has stopped and the quota is returned to the server. The client
shall start the quota holding timer when quota consumption ceases. This
is always when traffic ceases, i.e. the timer is re-started at the end
of each packet. It applies equally to the granted time quota and to the
granted volume quota. The timer is stopped on sending a CCR and
re-initialised on receiving a CCA with the previous used value or a new
value of Quota-Holding-Time if received.

Alternatively, if this AVP is not present, a locally configurable
default value in the client shall be used. A Quota-Holding-Time value of
zero indicates that this mechanism shall not be used.

#### 6.5.1.2 Change of charging conditions

There are a number of mid-session service events (re-authorisation
triggers), which could affect the rating of the current service usage,
e.g. end user QoS changes or location updates. When allocating
resources, the server may instruct the credit control client to
re-authorize the quota upon a number of different session related
triggers that can affect the rating conditions. The server instruct the
Network Element to monitor for such events by using the Trigger AVP
containing one or more Trigger-Type AVPs in the CCA command. These
events are in addition to the static triggers defined in the service
specific document (middle tier TS).

Once the OCS has armed one or more triggers using the Trigger AVP at the
Network Element, these triggers shall remain in effect until another
Trigger AVP is received for the same Rating Group, where the Network
Element shall arm all triggers present in the Trigger AVP and reset all
other triggers. The presence of the Trigger AVP without any Trigger-Type
AVPs in a CCA allows OCS to disable all the triggers that were armed in
a previous Trigger AVP.

NOTE: This removes the need for the OCS to send trigger information in
every CCA message when they have not changed.

When one of the armed triggers happen, a credit re-authorization shall
be sent to the server including information related to the service event
even if all the granted service units have not been used. The quota is
also being reported.

For example, if the Trigger AVP is used, then the client shall only
re-authorise the quota for the service usage associated with events
which were included in the last received Trigger AVP.

If the server does not control the events for re-authorisation using the
Trigger AVP, the Network Element shall only monitor for default events
defined in the relevant service specific document (middle tier TS).

#### 6.5.1.3 Reporting quota usage

The credit control client shall report the quota usage under a number of
circumstances. When this happens, the reason for the quota being
reported is notified to the server through the use of the
Reporting-Reason AVP in the CCR. The reason for reporting credit usage
can occur directly in the Multiple-Services-Credit-Control AVP, or in
the Used-Service-Units AVP, depending on whether it applies for all
quota types or a particular quota type respectively. It shall not be
used at command level. It shall always and shall only be sent when usage
is being reported.

When the reason is RATING\_CONDITION\_CHANGE, the Trigger AVP shall also
be included to indicate the specific armed trigger events which caused
the reporting and re-authorisation request.

#### \
6.5.1.4 Quota consumption

The consumption of quota is captured using mechanisms described in
6.5.1.3.

Volume quota is considered used or consumed in the normal way,
corresponding to actual traffic.

The consumption of time quota may be controlled by
Quota-Consumption-Time as described in clause 6.5.4, or by extended
mechanisms as described in clause 6.5.7.

### 6.5.2 Threshold based re-authorization triggers

The server may optionally include as part of the
Multiple-Services-Credit-Control AVP, when it is providing a quota, an
indication to the client of the remaining quota threshold that shall
trigger a quota re-authorization. The Time-Quota-Threshold AVP indicates
the threshold in seconds when the granted quota is time, and the
Volume-Quota-Threshold AVP indicates the threshold in octets when the
granted quota is volume. The Unit-Quota-Threshold AVP indicates the
threshold in service specific units, that are defined in the service
specific documents, when the granted quota is service specific.

If the threshold triggers were included along with the quota granted,
the Credit Control client, then, shall seek re-authorisation from the
server for the quota when the quota contents fall below the supplied
threshold. The client shall allow service to continue whilst the
re-authorisation is progress, until the original quota had been
consumed.

### 6.5.3 Termination action

The termination action is sent over the Ro reference point. Two
different approaches are specified:

-   The Final-Unit-Indication AVP with Final-Unit-Action TERMINATE does
    not include any other information. When the user has consumed the
    final granted units or zero quota has been granted by the OCS, the
    network element shall terminate the service. This is the default
    handling applicable whenever the client receives an unsupported
    Final-Unit-Action value. The network element shall send Credit
    Control Request message with CC-Request-Type AVP set to the value
    UPDATE\_REQUEST and report the Used-Service-Unit AVP for the service
    that has terminated, as defined in RFC 4006 \[402\].

-   Another termination action consists in re-directing packets
    corresponding to a terminated service (consumption of the final
    granted units or zero quota has been granted by the OCS) to an
    application server. This allows the client to redirect user
    originated requests to a top-up server so that network access can
    be re-instated. This functionality is achieved with the server
    returning a "REDIRECT" and redirect-to URL in the Final-Units-Action
    AVP of the Multiple-Services-Credit-Control AVP. Upon receiving this
    result code, the Network Element shall apply the redirection. The
    URL should be categorized so that the End-User’s ability to reach it
    is guaranteed.

-   NOTE: When zero quota has been granted by the OCS, the termination
    action must be enforced at the reception of the CCA message.

### 6.5.4 Quota consumption time

The server may optionally indicate to the client that the quota
consumption must be stopped after a period equal to the Quota
Consumption Time in which no packets are received or at session
termination, whichever is sooner. This is indicated by including the
Quota-Consumption-Time AVP in the CCA. The idle period equal to the
Quota Consumption Time is included in the reported usage. The quota is
consumed normally during gaps in traffic of duration less than or equal
to the Quota-Consumption-Time. Quota consumption resumes on receipt of a
further packet belonging to the service data flow.

If packets are allowed to flow during a Credit Control Request
(Update)/Credit Control Answer exchange, and the Quota-Consumption-Time
AVP value in the provided quota is the same as in the previously
provided quota, then the Quota-Consumption-Time runs normally through
this procedure. For example, if 5 seconds of a 10 second QCT timer have
passed when a CCR\[Update\] is triggered, and the CCA\[Update\] returns
2 seconds later, then the QCT timer will expire 3 seconds after the
receipt of the CCA and the remaining unaccounted 5 seconds of usage will
be recorded against the new quota even though no packets were
transmitted with the new quota.

In the case of a new quota with the Quota-Consumption-Time AVP, or when
packets are blocked during the CCR\[Update\]/CCA procedure then the
Quota-Consumption-Time stops running (if it was running) and quota
consumption begins again when the next service data flow packet matching
the Charging Rule is received.

If a Quota-Consumption-Time AVP value of zero is provided, or if no
Quota-Consumption-Time AVP is present in the CCA, the quota is consumed
continuously from the point at which it is granted.

### 6.5.5 Service Termination

The OCF may determine that a service requires termination. The OCF may
perform this termination synchronously if it has a CCR pending
processing by returning CCA with Result-Code AVP with value
DIAMETER-AUTHORIZATION-REJECTED. If the OCF does not have a pending
request (asynchronous), the OCF may trigger an ASR to terminate the
Diameter session related to the service. On reception of an ASR, the CTF
shall close the associated Credit-Control session by sending a CCR
\[TERMINATE\]. The behaviour of the CTF, in relation to the user
session, on reception of an ASR is detailed in the middle-tier TS. As an
alternative to the ASR, the OCF may trigger a RAR to which the CTF
behaves as described in RFC 4006 \[402\] and the OCF shall return a CCA
with Result-Code AVP with value DIAMETER-AUTHORIZATION-REJECTED for the
resulting CCR.

### 6.5.6 Envelope reporting

The OCF may determine the need for additional detailed reports
identifying start time and end times of specific activity in addition to
the standard quota management provided in RFC 4006 \[402\]. The OCF
controls this by sending a CCA with Envelope-Report AVP with the
appropriate values. The CTF, on receiving the command, will monitor for
traffic for a period of time controlled by the Quota-Consumption-Time
AVP and report each period as a single envelope for each
Quota-Consumption-Time expiry where there was traffic. The OCF may
request envelope reports for just time, time and volume, time and number
of events, or time and volume and number of events.

NOTE: Envelope reporting is independent of quota management (i.e. there
is no interaction).

### 6.5.7 Combinational quota

The Quota-Consumption-Time mechanism, described in clause 6.5.4, may be
extended (and replaced) when granting time based quota to provide
potentially more efficient use of the online charging interface, i.e.
reduced traffic and the algorithms in the OCF are potentially simpler.
The alternative handling mechanisms that are defined in this clause are:

1.  Continuous Time Period (CTP)

2.  Discrete Time Period (DTP)

Both DTP and CTP define time-envelopes in their own manner. The method
of forming a time-envelope is controlled by the Time-Quota-Mechanism
AVP, which selects the algorithm and the length of the base time
interval.

The base time interval, specified by the Base-Time-Interval AVP, is a
basic unit for consuming quota. Quota is deemed to be consumed at the
start of each base time interval. The CTF shall allow traffic to pass
for the duration of the base time interval.

For DTP, the base time interval defines the length of the discrete time
period. A time envelope corresponds to exactly one DTP (and therefore to
one base time interval). Quota consumption resumes only on the first
traffic following the expiry of the DTP (or the closure of the
envelope).

For CTP, the mechanism constructs a time-envelope out of consecutive
base time intervals in which traffic has occurred up to and including
the first base time interval which contains no traffic. Therefore quota
consumption continues within the time envelope, if there was traffic in
the previous base time interval. After an envelope has closed, then the
quota consumption resumes only on the first traffic following the
closure of the envelope. The envelope for CTP includes the last base
time interval, i.e. the one which contained no traffic. The end of an
envelope can only be determined "retrospectively".

If the CTF receives a Multiple-Services-Credit-Control AVP with both the
Quota-Consumption-Time AVP and Time-Quota-Mechanism AVP, then the
Time-Quota-Mechanism AVP takes precedence and the CTF shall behave
accordingly.

If the server requires details of when the DTPs and CTPs occurred then
it shall request the reporting of the corresponding time envelopes, by
including the Envelope-Reporting AVP when granting quota in the CCA
(INITIAL) to indicate whether the client shall report the start and end
of each time envelope, in those cases in which quota is consumed in
envelopes. The CTF generates envelopes according to the rules described
above and carry each envelope in a separate instance of the Envelope AVP
in the CCR.

### 6.5.8 Online control of offline charging information

The Offline-Charging AVP is used on the Ro interface by the OCS to
control the CTF in relation to the mechanism by which the CTF generates
offline charging information, e.g. for flow based charging controls the
formation of service data containers. The information contained, within
the Offline-Charging AVP, takes precedence over the default
configuration at the CTF. If the Offline-Charging AVP is not sent in the
CCA, the OCS does not control the offline charging mechanisms and
therefore the default configuration at the CTF is employed.

Controls over time usage, defined in clause 6.5.6 and 6.5.7, are
included.

### 6.5.9 Support of Multiple Service 

The support of multiple services within a single Diameter session in
3GPP is limited to services that are grouped in one of the middle tier
TSs specified through the *Service-Context-Id* AVP.

6.6 Bindings of the operation to protocol application
-----------------------------------------------------

This clause aims to describe the mapping between the protocol
independent messages and parameter with the Diameter messages and AVP
utilized on the 3GPP Offline and Online Charging.

### 6.6.1 Bindings of Charging Data Transfer to Accounting

Table 6.6.1 describes the bindings of the *Charging Data Transfer*
operation parameter to the DBPA AVP for 3GPP Offline Charging.

Table 6.6.1: Bindings to Accounting

  ---------------------------------- --------------------------
  Charging Data Transfer parameter   Diameter Accounting AVP
  Operation Number                   Accounting-Record-Number
  Operation Type                     Accounting-Record-Type
  Operation Identifier               Acct-Application-Id
  Operation Interval                 Acct-Interim-Interval
  Destination Domain                 Destination-Realm
  Origination Timestamp              Event-Timestamp
  Originator Host                    Origin-Host
  Originator Domain                  Origin-Realm
  Origination State                  Origin-State-Id
  Proxy Information                  Proxy-Info
  Operation Result                   Result-Code
  Route Information                  Route-Record
  Service Information                Service-Information
  Session Identifier                 Session-Id
  Operation Token                    Service-Context-Id
  User Name                          User-Name
  ---------------------------------- --------------------------

### \
6.6.2 Bindings of Debit / Reserve Units to Credit-Control

Table 6.6.2 describes the bindings of the *Debit / Reserve Units*
operation parameter to the DCCA AVP for 3GPP Online Charging.

Table 6.6.2: Bindings to Credit-Control

  --------------------------------- ----------------------------------
  Debit / Reserve Units parameter   DCCA AVP
  Destination Domain                Destination-Realm
  Destination Host                  Destination-Host
  Failed parameter                  Failed-AVP
  Multiple Operation                Multiple-Services-Indicator
  Multiple Unit Operation           Multiple-Services-Credit Control
  Operation Failover                CC-Session-Failover
  Operation Failure Action          Credit-Control-Failure-Handling
  Operation Identifier              Auth-Application-Id
  Operation Number                  CC-Request-Number
  Operation Result                  Result-Code
  Operation Token                   Service-Context-Id
  Operation Type                    CC-Request-Type
  Origination State                 Origin-State-Id
  Origination Timestamp             Event-Timestamp
  Originator Domain                 Origin-Realm
  Originator Host                   Origin-Host
  Proxy Information                 Proxy-Info
  Redirection Cache Time            Redirect-Max-Cache-Time
  Redirection Host                  Redirect-Host
  Redirection Host Usage            Redirect-Host-Usage
  Requested Action                  Requested-Action
  Route Information                 Route-Record
  Service Information               Service-Information
  Session Identifier                Session-Id
  Subscriber Equipment Number       User-Equipment-Info
  Subscriber Identifier             Subscription-Id
  Termination Cause                 Termination-Cause
  User Name                         User-Name
  --------------------------------- ----------------------------------

\
7 Summary of used Attribute Value Pairs
=======================================

7.1 Diameter AVPs
-----------------

The use of the Attribute Value Pairs (AVPs) that are defined in the
Diameter Protocol is specified in clause 6.2 for offline charging and in
clause 6.4 for online charging. The information is summarized in the
table 7.1 in alphabetical order. Detailed specification of some of these
AVPs is available after the table and for the others can be found from
RFC 3588 \[401\], RFC 4006 \[402\] and and RFC 4005 \[407\].

Those Diameter AVPs that are used are marked "M", "O~M~"or "Oc" in the
following table. This implies that their content can be used by the CDF
for offline and by the OCF for online charging purposes. Those Diameter
AVPs that are not used are marked "-" in the following table.

Table 7.1: Use Of IETF Diameter AVPs

  ---------------------------------- ------ --------- ------- ---------------- ------ --------------- ------ ----- -------- ------ -------
  AVP Name                           AVP    Used in   Value   AVP Flag rules
                                                              
                                     Code             Type    

                                            ACR       ACA     CCR

  Accounting-Input-Octets            363    O~C~      -       -

  Accounting-Output-Octets           364    O~C~      -       -

  Accounting-Realtime-Required       483    -         -       -

  Accounting-Record-Number           485    M         M       -

  Accounting-Record-Type             480    M         M       -

  Accounting-Sub-Session-Id          287    -         -       -

  Acct-Application-Id                259    O~C~      O~C~    -

  Acct-Interim-Interval              85     O~C~      O~C~    -

  Acct-Multi-Session-Id              50     -         -       -

  Acct-Session-Id                    44     -         -       -

  Auth-Application-Id                258    -         -       M

  AVP                                \*     -         -       -

  Called-Station-Id                  30     O~C~      -       O~C~

  CC-Correlation-Id                  411    -         -       O~C~

  CC-Input-Octets                    412    -         -       O~C~

  CC-Money                           413    -         -       -

  CC-Output-Octets                   414    -         -       O~C~

  CC-Request-Number                  415    -         -       M

  CC-Request-Type                    416    -         -       M

  CC-Service-Specific-Units          417    -         -       O~C~

  CC-Session-Failover                418    -         -       -

  CC-Sub-Session-Id                  419    -         -       -

  CC-Time                            420    -         -       O~C~

  CC-Total-Octets                    421    -         -       O~C~

  CC-Unit-Type                       454    -         -       -

  Check-Balance-Result               422    -         -       -

  Cost-Information                   423    -         -       -

  Cost-Unit                          424    -         -       -

  Credit-Control                     426    -         -       -

  Credit-Control-Failure-Handling    427    -         -       -

  Currency-Code                      425    -         -       -

  Destination-Host                   293    O~C~      -       O~C~

  Destination-Realm                  283    M         -       M

  Direct-Debiting-Failure-Handling   428    -         -       -

  Error-Message                      281    -         -       -

  Error-Reporting-Host               294    -         O~C~    -

  Event-Timestamp                    55     O~C~      O~C~    O~C~

  Exponent                           429    -         -       -

  Failed-AVP                         279    -         -       -

  Filter-Id                          11     -         -       -

  Final-Unit-Action                  449    -         -       -

  Final-Unit-Indication              430    -         -       -

  Granted-Service-Unit               431    -         -       -

  G-S-U-Pool-Identifier              453    -         -       -

  G-S-U-Pool-Reference               457    -         -       -

  Location-Type                      IANA   O~C~      -       O~C~

  Location-Information               IANA   O~C~      -       O~C~

  Multiple-Services-Credit-Control   456    -         -       O~C~

  Multiple-Services-Indicator        455    -         -       O~M~

  Operator-Name                      IANA   O~C~      -       O~C~

  Origin-Host                        264    M         M       M

  Origin-Realm                       296    M         M       M

  Origin-State-Id                    278    O~C~      O~C~    O~C~

  Proxy-Info                         284    O~C~      O~C~    O~C~

  Proxy-Host                         280    M         M       M

  Proxy-State                        33     M         M       M

  Rating-Group                       432    O~C~      -       O~C~

  Redirect-Address-Type              433    -         -       M

  Redirect-Host                      292    -         -       -

  Redirect-Host-Usage                261    -         -       -

  Redirect-Max-Cache-Time            262    -         -       -

  Redirect-Server                    434    -         -       -

  Redirect-Server-Address            435    -         -       -

  Requested-Action                   436    -         -       O~C~

  Requested-Service-Unit             437    -         -       O~C~

  Restriction-Filter-Rule            438    -         -       -

  Result-Code                        268    -         M       -

  Route-Record                       282    O~C~      -       O~C~

  Service-Context-Id                 461    O~M~      -       M

  Service-Identifier                 439    O~C~      -       O~C~

  Service-Parameter-Info             440    -         -       -

  Service-Parameter-Type             441    -         -       -

  Service-Parameter-Value            442    -         -       -

  Session-Id                         263    M         M       M

  Subscription-Id                    443    O~C~      -       O~M~

  Subscription-Id-Data               444    M         -       M

  Subscription-Id-Type               450    M         -       M

  Tariff-Change-Usage                452    -         -       O~C~

  Tariff-Time-Change                 451    -                 -

  Termination-Cause                  295              -       O~C~

  Unit-Value                         445    -         -       -

  Used-Service-Unit                  446    -         -       O~C~

  User-Equipment-Info                458    O~C~      -       O~C~

  User-Equipment-Info-Type           459    O~M~      -       M

  User-Equipment-Info-Value          460    O~M~      -       M

  User-Name                          1      O~C~      O~C~    O~C~

  Value-Digits                       447    -         -       -

  Validity-Time                      448    -         -       -

  Vendor-Id                          266    -         -       -

  Vendor-Specific-Application-Id     260    -         -       -
  ---------------------------------- ------ --------- ------- ---------------- ------ --------------- ------ ----- -------- ------ -------

NOTE: *Result-Code* AVP is defined in Diameter Base Protocol in RFC 3588
\[401\]. However, new values are used in offline and online charging
applications. These additional values are defined below.

### 7.1.1 Accounting-Input-Octets

The *Accounting-Input-Octets* AVP (AVP code 363) contains the number of
octets transmitted during the data container recording interval,
reflecting the volume counts for uplink traffic for a data flow.

### 7.1.2 void

### 7.1.3 Accounting-Output-Octets

The *Accounting-Output-Octets* AVP (AVP code 364) contains the number of
octets transmitted during the data container recording interval,
reflecting the volume count for downlink traffic for a data flow.

### 7.1.4 void

### 7.1.5 Acct-Application-Id AVP

The *Acct-Application-Id* AVP (AVP code 259) shall contain the value of
3 as defined in RFC 3588 \[401\] according TS 29.230 \[206\].

### 7.1.6 Auth-Application-Id AVP

The *Auth-Application-Id* AVP (AVP code 258) shall contain the value of
4 as defined in RFC 4006 \[402\] according TS 29.230 \[206\].

### 7.1.7 Called-Station-Id 

The *Called-Station-Id* AVP (AVP code 30) shall contain the Access Point
Name (APN) the user is connected to.

### 7.1.8 Event-Timestamp AVP

The *Event-Timestamp* AVP (AVP code 55) shall contain the time when the
chargeable event is received in the CTF.

### 7.1.9 Multiple-Services-Credit-Control

The *Multiple-Services-Credit-Control* AVP (AVP code 456) is of type
grouped as specified in RFC 4006 \[402\]. It contains additional 3GPP
specific charging parameters.

It has the following ABNF grammar:

&lt;Multiple-Services-Credit-Control&gt; ::= &lt; AVP Header: 456 &gt;

> \[ Granted-Service-Unit \]\
> \[ Requested-Service-Unit \]\
> \* \[ Used-Service-Unit \]\
> ~~\[ Tariff-Change-Usage \]~~\
> \* \[ Service-Identifier \]\
> \[ Rating-Group \]\
> \* \[ G-S-U-Pool-Reference \]~~\
> ~~ \[ Validity-Time \]\
> \[ Result-Code \]\
> \[ Final-Unit-Indication \]\
> \[ Time-Quota-Threshold \]\
> \[ Volume-Quota-Threshold \]\
> \[ Unit-Quota-Threshold \]\
> \[ Quota-Holding-Time \]\
> \[ Quota-Consumption-Time \]\
> \* \[ Reporting-Reason \]\
> \[ Trigger \]\
> \[ PS-Furnish-Charging-Information \]
>
> \[ Refund-Information \]
>
> \* \[ AF-Correlation-Information\]
>
> \* \[ Envelope \]\
> \[ Envelope-Reporting \]\
> \[ Time-Quota-Mechanism \]\
> \* \[ Service-Specific-Info \]
>
> \[ QoS-Information \]
>
> ~~\* \[ AVP \]~~

### 7.1.10 Rating-Group AVP

The *Rating-Group* AVP (AVP code 432), is defined in RFC 4006 \[402\].
It contains the charging key (defined in TS 23.203 \[218\]). Each quota
allocated to a Diameter CC session has a unique Rating Group value as
specified in RFC 4006 \[402\].

### \
7.1.11 Result-Code AVP

This subclause defines new *Result-Code* AVP (AVP code 268) values that
must be supported by all Diameter implementations that conform to the
present document. The Result-Code AVP operates as described in RFC 3588
\[401\] and RFC 4006 \[402\].

The following result code descriptions are examples of the possible uses
for the code:

**Transient Failures (4xxx):**

DIAMETER\_END\_USER\_SERVICE\_DENIED 4010

The OCF denies the service request due to service restrictions (e.g.
terminate rating group) or limitations related to the end-user, for
example the end-user's account could not cover the requested service.

DIAMETER\_CREDIT\_CONTROL\_NOT\_APPLICABLE 4011

The OCF determines that the service can be granted to the end user but
no further credit control\
needed for the service (e.g. service is free of charge or is treated for
offline charging). DIAMETER\_CREDIT\_LIMIT\_REACHED 4012

The OCF denies the service request since the end- user's account could
not cover the requested service. If the CCR contained used-service-units
they are deducted, if possible.

**Permanent Failures (5xxx):**

DIAMETER\_AUTHORIZATION\_REJECTED 5003

The OCF denies the service request in order to terminate the service for
which credit is requested. For example this error code is used to inform
IP CAN bearer has to be terminated in the CCR message or to inform
blacklist the rating group in the Multiple-Service-Credit-Control AVP.

DIAMETER\_USER\_UNKNOWN 5030

The specified end user could not be found in the OCF.

DIAMETER\_RATING\_FAILED 5031

This error code is used to inform the CTF that the OCF cannot rate the
service request due to insufficient rating input, incorrect AVP
combination or due to an AVP or an AVP value that is not recognized or
supported in the rating. For Flow Based Charging this error code is used
if the Rating group is not recognized. The Failed-AVP AVP MUST be
included and contain a copy of the entire AVP(s) that could not be
processed successfully or an example of the missing AVP complete with
the Vendor-Id if applicable. The value field of the missing AVP should
be of correct minimum length and contain zeroes.

### \
7.1.12 Service-Context-Id AVP

The *Service-Context-Id* AVP is defined in RFC 4006 \[402\]. It is of
type UTF8String and contains a unique identifier of the Diameter Credit
Control service specific document that applies to the request. This is
an identifier allocated by the service provider/operator, by the service
element manufacturer or by a standardization body and MUST uniquely
identify a given Diameter Credit Control service specific document. For
offline charging, this identifies the service specific document ('middle
tier' TS) on which associated CDRs should based. The format of the
Service-Context-Id is:

"extensions".MNC.MCC."Release"."service-context" "@" "domain"

The 3GPP specific values for "service-context" "@" "domain" are:

-   For PS charging: 32251@3gpp.org

-   For WLAN charging: 32252@3gpp.org

-   For IMS charging: 32260@3gpp.org

-   For MMS service charging: 32270@3gpp.org

-   For LCS service charging: 32271@3gpp.org

-   For PoC service charging: 32272@3gpp.org

-   For MBMS service charging: 32273@3gpp.org

-   For SMS service charging: 32274@3gpp.org

-   For MMTel service charging: <32275@3gpp.org>

-   For AoC Service Information: 32280@3gpp.org

-   For ABMF Rc information: 32296@3gpp.org

The "Release" indicates the 3GPP Release the service specific document
is based upon e.g. 6 for Release 6.

As a minimum, Release "service-context" "@" "domain" shall be used. If
the minimum is used all operator provisionable parameters (Oc and Om)
are optional.

The MNC.MCC identifies the operator implementing the service specific
document, which is used to determine the specific requirements for the
operator configurable parameters.

The "extensions" is operator specific information to any extensions in a
service specific document.

### 7.1.13 Service-Identifier AVP

The *Service-Identifier* AVP (AVP code 439), is defined in RFC 4006
\[402\]. For further details, please refer the middle-tier
specification.

### 7.1.14 Used-Service-Unit AVP

The *Used-Service-Unit* AVP (AVP code 446) is of type grouped as
specified in RFC 4006 \[402\]. It contains additional 3GPP specific
charging parameters.

It has the following ABNF grammar:

&lt;Used-Service-Unit&gt; ::= &lt; AVP Header: 446 &gt;

> \[ Reporting-Reason \]
>
> \[ Tariff-Change-Usage \]
>
> \[ CC-Time \]
>
> ~~\[ CC-Money \]~~
>
> \[ CC-Total-Octets \]

\[ CC-Input-Octets \]

\[ CC-Output-Octets \]

\[ CC-Service-Specific-Units \]

\*\[ Event-Charging-TimeStamp \]

~~\*\[ AVP \]~~

### 7.1.15 User-Name AVP

The *User-Name* AVP (AVP code 1) contains the user name in the format of
a NAI according to RFC 3588 \[401\].

### 7.1.16 Vendor-Id AVP

The *Vendor-Id* AVP (AVP code 266), as part of the
*Vendor-Specific-Application-Id* grouped AVP, shall contain the value of
10415, which is the IANA registered value for '3GPP' in TS 29.230
\[206\].

### 7.1.17 User-Equipment-Info AVP

The *User-Equipment-Info*  AVP (AVP code 458) is of type grouped and
contains the identity and capability of the terminal the subscriber is
using for the connection to network according to IETF RFC 4006 \[402\]
with the following ABNF grammar:

User-Equipment-Info ::= &lt; AVP Header: 458 &gt;

{ User-Equipment-Info-Type }

{ User-Equipment-Info-Value }.

When the User-Equipment-Info-Type AVP (AVP code 459) is set to IMEISV
(0), the value within the User-Equipment-Info-Value AVP (AVP code 460)
is of type OctetString and shall be a UTF-8 encoded decimal.

The composition of the IMEISV follows the IMEI definition in TS 23.003
\[224\].

7.2 3GPP specific AVPs
----------------------

For the purpose of offline charging additional AVPs are used in ACR /
ACA and for online charging additional AVPs are used in CCR / CCA. All
3GPP specific AVPs mentioned are relevant for both offline and online
charging unless specifically excluded. The information is summarized in
the following table along with the AVP flag rules.

The 3GPP Charging Application uses the value 10415 (3GPP) as
*Vendor-Id.*

Detailed descriptions of AVPs that are used specifically for 3GPP
charging are provided in the subclauses below the table. However, for
AVPs that are just borrowed from other applications only the reference
(e.g. TS 29.229 \[204\]), is provided in the following table and the
detailed description is not repeated.

Where 3GPP RADIUS VSAs are re-used, they shall be translated to Diameter
AVPs as described in RFC 4005 \[407\] with the exception that the 'M'
flag shall be set and the ''P' flag may be set.

Table 7.2: 3GPP specific AVPs

  ------------------------------------------------------------------------------------------------------------------- ------ --------- ------- ---------------- ----- --------------- ------ ----- -------- ------ -------
  AVP Name                                                                                                            AVP    Used in   Value   AVP Flag rules
                                                                                                                                               
                                                                                                                      Code             Type    

                                                                                                                             ACR       ACA     CCR

  3GPP-Charging-Characteristics                                                                                       13     X         -       X

  3GPP-Charging-Id                                                                                                    2      X         -       X

  3GPP-GGSN-MCC-MNC                                                                                                   9      X         -       X

  3GPP-IMSI                                                                                                           1      -         -       X

  3GPP-IMSI-MCC-MNC                                                                                                   8      X         -       X

  3GPP-MS-TimeZone                                                                                                    23     X         -       X

  3GPP-NSAPI                                                                                                          10     X         -       X

  3GPP-PDP-Type                                                                                                       3      X         -       X

  3GPP-RAT-Type                                                                                                       21     X         -       X

  3GPP-Selection-Mode                                                                                                 12     X         -       X

  3GPP-Session-Stop-Indicator                                                                                         11     -         -       X

  3GPP-SGSN-MCC-MNC                                                                                                   18     X         -       X

  3GPP-User-Location-Info                                                                                             22     X         -       X

  Access-Network-Charging-Identifier-Value                                                                            503    X         -       X

  Access-Network-Information                                                                                          1263   X         -       X

  Access-Transfer-Information                                                                                         2709   X         -       -

  Access-Transfer-Type                                                                                                2710   X         -       -

  Account-Expiration                                                                                                  2309   -         -       -

  Accumulated-Cost                                                                                                    2052   -         -       -

  Adaptations                                                                                                         1217   -         -       X

  Additional-Content-Information                                                                                      1207   -         -       X

  Additional-Type-Information                                                                                         1205   -         -       X

  Address-Data                                                                                                        897    -         -       X

  Address-Domain                                                                                                      898    -         -       X

  Addressee-Type                                                                                                      1208   -         -       X

  Address-Type                                                                                                        899    -         -       X

  AF-Charging-Identifier                                                                                              505    X         -       X

  AF-Correlation-Information                                                                                          1276   X         -       X

  Allocation-Retention-Priority                                                                                       1034   X         -       X

  Alternate-Charged-Party-Address                                                                                     1280   X         -       -

  AoC-Cost-Information                                                                                                2053   -         -       X

  AoC-Format                                                                                                          2310   -         -       X

  AoC-Information                                                                                                     2054   -         -       X

  AoC-Request-Type                                                                                                    2055   -         -       X

  AoC-Service                                                                                                         2311   -         -       X

  AoC-Service-Obligatory-Type                                                                                         2312   -         -       X

  AoC-Service-Type                                                                                                    2313   -         -       X

  AoC-Subscription-Information                                                                                        2314   -         -       X

  Application-provided-called-party-address                                                                           837    X         -       X

  Application-Server                                                                                                  836    X         -       X

  Application-Server-ID                                                                                               2101   X         -       X

  Application-Service-Provider-Identity                                                                               532    X         -       -

  Application-Server-Information                                                                                      850    X         -       X

  Application-Service-Type                                                                                            2102   X         -       X

  Application-Session-ID                                                                                              2103   X         -       X

  Applic-ID                                                                                                           1218   -         -       X

  Associated-Party-Address                                                                                            2035   X         -       X

  Associated-URI                                                                                                      856    X         -       X

  Authorised-QoS                                                                                                      849    -         -       -

  Aux-Applic-Info                                                                                                     1219   -         -       X

  Base-Time-Interval                                                                                                  1265   -         -       -

  Bearer-Service                                                                                                      854    X         -       -

  Called-Asserted-Identity                                                                                            1250   X         -       X

  Called-Party-Address                                                                                                832    X         -       X

  Calling-Party-Address                                                                                               831    X         -       X

  Carrier-Select-Routing-Information                                                                                  2023   X         -       X

  Cause-Code                                                                                                          861    X         -       X

  CG-Address                                                                                                          846    X         -       X

  Change-Condition                                                                                                    2037   X         -       -

  Change-Time                                                                                                         2038   X         -       -

  Charge-Reason-Code                                                                                                  2118   -         -       X

  Charged-Party                                                                                                       857    X         -       -

  Charging-Characteristics-Selection-Mode                                                                             2066   X         -       X

  Charging-Rule-Base-Name                                                                                             1004   X         -       X

  Class-Identifier                                                                                                    1214   -         -       X

  Client-Address                                                                                                      2018   -         -       X

  CN-IP-Multicast-Distribution                                                                                        921    X         -       -

  Content-Class                                                                                                       1220   -         -       X

  Content-Disposition                                                                                                 828    X         -       X

  Content-ID                                                                                                          2116   X         -       X

  Content-Provider-ID                                                                                                 2117   X         -       X

  Content-Length                                                                                                      827    X         -       X

  Content-Size                                                                                                        1206   -         -       X

  CSG-Access-Mode                                                                                                     2317   X         -       X

  CSG-Id                                                                                                              1437   X         -       X

  CSG-Membership-Indication                                                                                           2318   X         -       X

  Content-Type                                                                                                        826    X         -       X

  Current-Tariff                                                                                                      2056   -         -       X

  CUG-Information                                                                                                     2304   X         -       X

  Data-Coding-Scheme                                                                                                  2001   -         -       X

  DCD-Information                                                                                                     2115   X         -       X

  Deferred-Location-Event-Type                                                                                        1230   -         -       X

  Delivery-Report-Requested                                                                                           1216   -         -       X

  Delivery-Status                                                                                                     2104   X         -       X

  Destination-Interface                                                                                               2002   -         -       X

  Diagnostics                                                                                                         2039   X         -       X

  Domain-Name                                                                                                         1200   -         -       X

  DRM-Content                                                                                                         1221   -         -       X

  Dynamic-Address-Flag                                                                                                2051   X         -       X

  Dynamic-Address-Flag-Extension                                                                                      2068   X         -       X

  Early-Media-Description                                                                                             1272   X         -       -

  Envelope                                                                                                            1266   -         -       X

  Envelope-End-Time                                                                                                   1267   -         -       X

  Envelope-Reporting                                                                                                  1268   -         -       -

  Envelope-Start-Time                                                                                                 1269   -         -       X

  Event                                                                                                               825    X         -       X

  Event-Charging-TimeStamp                                                                                            1258   -         -       X

  Event-Type                                                                                                          823    X         -       X

  Expires                                                                                                             888    X         -       X

  File-Repair-Supported                                                                                               1224   X         -       X

  Flows                                                                                                               510    -         -       X

  From-Address                                                                                                        2708   X         -       X

  GGSN-Address                                                                                                        847    X         -       X

  Guaranteed-Bitrate-UL                                                                                               1026   X         -       X

  IM-Information                                                                                                      2110   X         -       X

  IMS-Application-Reference-Identifier                                                                                2601   X         -       -

  IMS-Charging-Identifier                                                                                             841    X         -       X

  IMS-Communication-Service-Identifier                                                                                1281   X         -       X

  IMS-Emergency-Indicator                                                                                             2322   X         -       -

  IMS-Information                                                                                                     876    X         -       X

  IMS-Visited-Network-Identifier                                                                                      2713   X         -       X

  IMSI-Unauthenticated-Flag                                                                                           2308   X         -       X

  Incoming-Trunk-Group-Id                                                                                             852    X         -       -

  Incremental-Cost                                                                                                    2062   -         -       X

  Initial-IMS-Charging-Identifier                                                                                     2321   X         -       X

  Interface-Id                                                                                                        2003   -         -       X

  Interface-Port                                                                                                      2004   -         -       X

  Interface-Text                                                                                                      2005   -         -       X

  Interface-Type                                                                                                      2006   -         -       X

  Inter-Operator-Identifier                                                                                           838    X         -       X

  IP-Realm-Default-Indication                                                                                         2603   X         -       -

  LCS-APN                                                                                                             1231   -         -       X

  LCS-Client-Dialed-By-MS                                                                                             1233   -         -       X

  LCS-Client-External-ID                                                                                              1234   -         -       X

  LCS-Client-Id                                                                                                       1232   -         -       X

  LCS-Client-Name                                                                                                     1235   -         -       X

  LCS-Client-Type                                                                                                     1241   -         -       X

  LCS-Data-Coding-Scheme                                                                                              1236   -         -       X

  LCS-Format-Indicator                                                                                                1237   -         -       X

  LCS-Information                                                                                                     878    -         -       X

  LCS-Name-String                                                                                                     1238   -         -       X

  LCS-Requestor-ID                                                                                                    1239   -         -       X

  LCS-Requestor-ID-String                                                                                             1240   -         -       X

  Local-GW-Inserted-Indication                                                                                        2604   X         -       -

  Local-Sequence-Number                                                                                               2063   X         -       -

  Location-Estimate                                                                                                   1242   -         -       X

  Location-Estimate-Type                                                                                              1243   -         -       X

  Location-Type                                                                                                       1244   -         -       X

  Low-Balance-Indication                                                                                              2020   -         -       -

  Low-Priority-Indicator                                                                                              2602   X         -       -

  Mandatory-Capability                                                                                                604    X         -       -

  Max-Requested-Bandwidth-DL                                                                                          515    X         -       X

  Max-Requested-Bandwidth-UL                                                                                          516    X         -       X

  MBMS-2G-3G-Indicator                                                                                                907    X         -       X

  MBMS-GW-Address                                                                                                     2307   X         -       -

  MBMS-Information                                                                                                    880    X         -       X

  MBMS-Service-Area                                                                                                   903    X         -       X

  MBMS-Service-Type                                                                                                   906    X         -       X

  MBMS-Session-Identity                                                                                               908    X         -       X

  MBMS-User-Service-Type                                                                                              1225   X         -       X

  Media-Initiator-Flag                                                                                                882    X         -       X

  Media-Initiator-Party                                                                                               1288   X         -       X

  Message-Body                                                                                                        889    X         -       X

  Message-Class                                                                                                       1213   -         -       X

  Message-ID                                                                                                          1210   X         -       X

  Message-Size                                                                                                        1212   -         -       X

  Message-Type                                                                                                        1211   -         -       X

  MMBox-Storage-Requested                                                                                             1248   -         -       X

  MM-Content-Type                                                                                                     1203   -         -       X

  MME-Name                                                                                                            2402   X         -       -

  MME-Number-for-MT-SMS                                                                                               1645   X         -       -

  MME-Realm                                                                                                           2408   X         -       -

  MMS-Information                                                                                                     877    -         -       X

  MMTel-Information                                                                                                   2030   X         -       X

  MMTel-SService-Type                                                                                                 2031   X         -       X

  MSISDN                                                                                                              701    -         -       X

  Neighbour-Node-Address                                                                                              2705   X         -       -

  Next-Tariff                                                                                                         2057                     X

  NNI-Information                                                                                                     2703   X         -       -

  NNI-Type                                                                                                            2704   X         -       -

  Node-Functionality                                                                                                  862    X         -.      X

  Node-Id                                                                                                             2064   X         -       X

  Number-Of-Diversions                                                                                                2034   X         -       X

  Number-Of-Messages-Sent                                                                                             2019   X         -       X

  Number-Of-Messages-Successfully-Exploded                                                                            2111   X         -       X

  Number-Of-Messages-Successfully-Sent                                                                                2112   X         -       X

  Number-Of-Participants                                                                                              885    X         -       X

  Number-Of-Received-Talk-Bursts                                                                                      1282   X         -       -

  Number-Of-Talk-Bursts                                                                                               1283   X         -       -

  Number-Portability-Routing-Information                                                                              2024   X         -       X

  Offline-Charging                                                                                                    1278   -         -       -

  Online-Charging-Flag                                                                                                2303   X         -       -

  Optional-Capability                                                                                                 605    X         -       -

  Originating-IOI                                                                                                     839    X         -       X

  Originator-SCCP-Address                                                                                             2008   -         -       X

  Originator                                                                                                          864    X         -       X

  Originator-Address                                                                                                  886    X         -       X

  Originator-Received-Address                                                                                         2027   -         -       X

  Originator-Interface                                                                                                2009   -         -       X

  <span id="OLE_LINK5" class="anchor"><span id="OLE_LINK6" class="anchor"></span></span>Outgoing-Session-Id           2320   X         -       X

  Outgoing-Trunk-Group-Id                                                                                             853    X         -       -

  Participant-Access-Priority                                                                                         1259   X         -       X

  Participant-Action-Type                                                                                             2049   X         -       X

  Participant-Group                                                                                                   1260   X         -       X

  Participants-Involved                                                                                               887    X         -       X

  PDG-Address                                                                                                         895    X         -       X

  PDG-Charging-Id                                                                                                     896    X         -       X

  PDN-Connection-Charging-ID                                                                                          2050   X         -       X

  PDP-Address                                                                                                         1227   X         -       X

  PDP-Context-Type                                                                                                    1247   X         -       X

  <span id="OLE_LINK25" class="anchor"><span id="OLE_LINK26" class="anchor"></span></span>PDP-Address-Prefix-Length   2606   X         -       X

  PoC-Change-Condition                                                                                                1261   X         -       -

  PoC-Change-Time                                                                                                     1262   X         -       -

  PoC-Controlling-Address                                                                                             858    X         -       X

  PoC-Event-Type                                                                                                      2025   X         -       X

  PoC-Group-Name                                                                                                      859    X         -       X

  PoC-Information                                                                                                     879    X         -       X

  PoC-Server-Role                                                                                                     883    X         -       X

  PoC-Session-Id                                                                                                      1229   X         -       X

  PoC-Session-Initiation-type                                                                                         1277   X         -       X

  PoC-Session-Type                                                                                                    884    X         -       X

  PoC-User-Role                                                                                                       1252   X         -       X

  PoC-User-Role-IDs                                                                                                   1253   X         -       X

  PoC-User-Role-info-Units                                                                                            1254   X         -       X

  Positioning-Data                                                                                                    1245   -         -       X

  Preferred-AoC-Currency                                                                                              2315   -         -       X

  Priority                                                                                                            1209   -         -       X

  Priority-Level                                                                                                      1046   X         -       X

  PS-Append-Free-Format-Data                                                                                          867    X         -       -

  PS-Free-Format-Data                                                                                                 866    X         -       -

  PS-Furnish-Charging-Information                                                                                     865    X         -       -

  PS-Information                                                                                                      874    X         -       X

  QoS-Information                                                                                                     1016   X         -       X

  QoS-Class-Identifier                                                                                                1028   X         -       X

  Quota-Consumption-Time                                                                                              881    -         -       -

  Quota-Holding-Time                                                                                                  871    -         -       -

  RAI                                                                                                                 909    X         -       X

  Rate-Element                                                                                                        2058   -         -       X

  RAT-Type                                                                                                            1032   X         -       X

  Read-Reply-Report-Requested                                                                                         1222   -         -       X

  Real-Time-Tariff-Information                                                                                        2305   X         -       -

  Received-Talk-Burst-Time                                                                                            1284   X         -       -

  Received-Talk-Burst-Volume                                                                                          1285   X         -       -

  Recipient-Address                                                                                                   1201   X         -       X

  Recipient-Info                                                                                                      2026   -         -       X

  Recipient-Received-Address                                                                                          2028   -         -       X

  Recipient-SCCP-Address                                                                                              2010   -         -       X

  Refund-Information                                                                                                  2022   -         -       X

  Relationship-Mode                                                                                                   2706   X         -       -

  Related-IMS-Charging-Identifier                                                                                     2711   X         -       -

  Related-IMS-Charging-Identifier-Node                                                                                2712   X         -       -

  Remaining-Balance                                                                                                   2021   -         -       -

  Reply-Applic-ID                                                                                                     1223   -         -       X

  Reply-Path-Requested                                                                                                2011   -         -       X

  Reporting-Reason                                                                                                    872    -         -       X

  Requested-Party-Address                                                                                             1251   X         -       X

  Required-MBMS-Bearer-Capabilities                                                                                   901    X         -       X

  Role-Of-Node                                                                                                        829    X         -       X

  Route-Header-Received                                                                                               3403   X         -       -

  Route-Header-Transmitted                                                                                            3404   X         -       -

  Scale-Factor                                                                                                        2059   -         -       X

  SDP-Answer-Timestamp                                                                                                1275   X         -       -

  SDP-Media-Component                                                                                                 843    X         -       X

  SDP-Media-Description                                                                                               845    X         -       X

  SDP-Media-Name                                                                                                      844    X         -       X

  SDP-Offer-Timestamp                                                                                                 1274   X         -       -

  SDP-Session-Description                                                                                             842    X         -       X

  SDP-TimeStamps                                                                                                      1273   X         -       -

  SDP-Type                                                                                                            2036   X         -       X

  Session-Direction                                                                                                   2707   X         -       -

  Served-Party-IP-Address                                                                                             848    X         -       -

  Server-Capabilities                                                                                                 603    X         -       -

  Server-Name                                                                                                         602    X         -       -

  Service-Data-Container                                                                                              2040   X         -       -

  Service-Generic-Information                                                                                         1256   X         -       X

  Service-Id                                                                                                          855    X         -       X

  Service-Information                                                                                                 873    X         -       X

  Service-Mode                                                                                                        2032   X         -       X

  Service-Specific-Data                                                                                               863    X         -       X

  Service-Specific-Info                                                                                               1249   X         -       X

  Service-Specific-Type                                                                                               1257   X         -       X

  Serving-Node-Type                                                                                                   2047   X         -       X

  Session-Priority                                                                                                    650    X         -       X

  SGSN-Address                                                                                                        1228   X         -       X

  SGW-Address                                                                                                         2067   X         -       -

  SGW-Change                                                                                                          2065   X         -       -

  SIP-Method                                                                                                          824    X         -       X

  SIP-Request-Timestamp-Fraction                                                                                      2301   X         -       X

  SIP-Request-Timestamp                                                                                               834    X         -       X

  SIP-Response-Timestamp-Fraction                                                                                     2302   X         -       X

  SIP-Response-Timestamp                                                                                              835    X         -       X

  SM-Discharge-Time                                                                                                   2012   -         -       X

  SM-Message-Type                                                                                                     2007   -         -       X

  SM-Protocol-ID                                                                                                      2013   -         -       X

  SMSC-Address                                                                                                        2017   X         -       X

  SMS-Information                                                                                                     2000   -         -       X

  SMS-Node                                                                                                            2016   -         -       X

  SM-Service-Type                                                                                                     2029   -         -       X

  SM-Status                                                                                                           2014   -         -       X

  SM-User-Data-Header                                                                                                 2015   -         -       X

  Sponsor-Identity                                                                                                    531    X         -       -

  Start-Time                                                                                                          2041   X         -       -

  Status-Code                                                                                                         2702   X         -       -

  Stop-Time                                                                                                           2042   X         -       -

  Submission-Time                                                                                                     1202   X         -       X

  Subscriber-Role                                                                                                     2033   X         -       X

  Supplementary-Service                                                                                               2048   X         -       X

  Talk-Burst-Exchange                                                                                                 1255   X         -       -

  Talk-Burst-Time                                                                                                     1286   X         -       -

  Talk-Burst-Volume                                                                                                   1287   X         -       -

  Tariff-Information                                                                                                  2060   X         -       X

  Tariff-XML                                                                                                          2306   X         -       -

  Terminal-Information                                                                                                1401   X         -       X

  Terminating-IOI                                                                                                     840    X         -       X

  Time-First-Usage                                                                                                    2043   X         -       -

  Time-Last-Usage                                                                                                     2044   X         -       -

  Time-Quota-Mechanism                                                                                                1270   -         -       -

  Time-Quota-Threshold                                                                                                868    -         -       -

  Time-Quota-Type                                                                                                     1271   -         -       -

  Time-Stamps                                                                                                         833    X         -       X

  Time-Usage                                                                                                          2045   X         -       -

  TMGI                                                                                                                900    X         -       X

  Token-Text                                                                                                          1215   -         -       X

  Total-Number-Of-Messages-Exploded                                                                                   2113   X         -       X

  Total-Number-Of-Messages-Sent                                                                                       2114   X         -       X

  Traffic-Data-Volumes                                                                                                2046   X         -       -

  Transcoder-Inserted-Indication                                                                                      2605   X         -       -

  Transit-IOI-List                                                                                                    2701   X         -       -

  Trigger                                                                                                             1264   -         -       X

  Trigger-Type                                                                                                        870    -         -       X

  Trunk-Group-Id                                                                                                      851    X         -       -

  TWAN-BSSID                                                                                                          2716   X         -       X

  TWAN-SSID                                                                                                           2715   X         -       X

  TWAN-User-Location-Info                                                                                             2714   X         -       X

  Type-Number                                                                                                         1204   -         -       X

  Unit-Cost                                                                                                           2061   -         -       X

  Unit-Quota-Threshold                                                                                                1226   -         -       -

  User-CSG-Information                                                                                                2319   X         -       X

  User-Data                                                                                                           606    X         -       -

  User-Location-Info-Time                                                                                             2812   X         -       X

  User-Participating-Type                                                                                             1279   X         -       X

  User–Session-Id                                                                                                     830    X         -       X

  VAS-Id                                                                                                              1102   -         -       X

  VASP-Id                                                                                                             1101   -         -       X

  Volume-Quota-Threshold                                                                                              869    -         -       -

  WAG-Address                                                                                                         890    X         -       X

  WAG-PLMN-Id                                                                                                         891    X         -       X

  WLAN-Information                                                                                                    875    X         -       X

  WLAN-Radio-Container                                                                                                892    X         -       X

  WLAN-Session-Id                                                                                                     1246   X         -       X

  WLAN-Technology                                                                                                     893    X         -       X

  WLAN-UE-Local-IPAddress                                                                                             894    X         -       X
  ------------------------------------------------------------------------------------------------------------------- ------ --------- ------- ---------------- ----- --------------- ------ ----- -------- ------ -------

### 7.2.1 Access-Network-Information AVP

The *Access-Network-Information* AVP (AVP code 1263) is of type
OctetString and indicates the SIP P-header\
"P-Access-Network-Information".

### 7.2.1A Access-Transfer-Information AVP

The *Access-Transfer-Information* AVP (AVP code 2709) is of type Grouped
and provides information on access transfer for IMS service continuity.

It has the following ABNF grammar:

Access-Transfer-Information :: = &lt; AVP Header: 2709&gt;

\[ Access-Transfer-Type \]

\[ Access-Network-Information \]

### 7.2.1B Access-Transfer-Type AVP

The *Access-Transfer-Type* AVP (AVP code 2710) is of type Enumerated and
indicates which type of transfer occurred for IMS service continuity.

The following values are defined:

PS to CS Transfer (0)

CS to PS Transfer (1)

### 7.2.2 Account-Expiration AVP

The *Account-Expiration* AVP (AVP code 2309) is of type Time and
indicates the subscriber account expiration date and time of day.

### 7.2.3 Accumulated-Cost AVP

The *Accumulated-Cost* AVP (AVP code 2052) is of type Grouped and holds
the accumulated cost for the ongoing session.

It has the following ABNF grammar:

> Accumulated-Cost:: = &lt; AVP Header: 2052 &gt;
>
> { Value-Digits }
>
> \[ Exponent \]

### 7.2.4 Adaptations AVP

The *Adaptations* AVP (AVP code 1217) is of type Enumerated and
indicates whether the originator allows adaptation of the content
(default Yes).

The values indicating whether adaptations are allowed are:

> 0 Yes
>
> 1 No

### 7.2.5 Additional-Content-Information AVP

The *Additional-Content-Information* AVP (AVPcode 1207) is of type
Grouped and identifies any subsequent content types. It is used to
identify each content (including re-occurences) within an MM when the
Type-Number AVP or Additional-Type-Information AVP from the Content-Type
AVP indicate a multi-part content.

It has the following ABNF grammar:

> Additional-Content-Information:: = &lt; AVP Header: 1207 &gt;
>
> \[ Type-Number \]
>
> \[ Additional-Type-Information \]
>
> \[ Content-Size \]

### 7.2.6 Additional-Type-Information AVP

The *Additional-Type-Information* AVP (AVP code 1205) is of type
UTF8String and identifies any additional information beyond well-known
media types or non-well-known media types.

### 7.2.7 Address-Data AVP

The *Address-Data* AVP (AVP code 897) is of type UTF8String and
indicates the address information and formatted according type of
address indicated in the Address-Type AVP and according to MMS
encapsulation \[209\].

### 7.2.8 Address-Domain AVP

The *Address-Domain* AVP (AVP code 898) is of type Grouped and indicates
the domain/network to which the associated address resides. If this AVP
is present, at least one of the AVPs described within the grouping must
be included.

It has the following ABNF:

> Address-Domain :: = &lt; AVP Header: 898 &gt;
>
> \[ Domain-Name \]
>
> \[ 3GPP-IMSI-MCC-MNC \]

### 7.2.9 Address-Type AVP

The *Address-Type* AVP (AVP code 899) is of type Enumerated and
indicates the type of address carried within the Address-Information
AVP.

It has the following values:

> 0 e-mail address
>
> 1 MSISDN
>
> 2 IPv4 Address
>
> 3 IPv6 Address
>
> 4 Numeric Shortcode
>
> 5 Alphanumeric Shortcode
>
> 6 Other
>
> 7 IMSI

### 7.2.10 Addressee-Type AVP

The Addressee-Type AVP (AVP code 1208) is of type Enumerated and
identifies the how the recipient is addressed in the header of an MM.

The following values are defined:

> 0 TO ;
>
> 1 CC ;
>
> 2 BCC.

### 7.2.11 AF-Correlation-Information AVP

The *AF-Correlation-Information* AVP (AVPcode 1276) is of type Grouped
and includes the "AF Charging Identifier" (ICID for IMS) and associated
flow identifiers generated by the AF and received by P-GW over Rx/Gx as
defined in TS 29.214 \[214\] and TS 29.212 \[215\]. The
AF-Correlation-Information is defined per Rating Group or per Rating
Group and Service Identifier when Service Identifier level reporting
applies.

When several AF sessions (refer to TS 29.214 \[214\]) are conveyed over
the same bearer, this AVP may appear several times per MSCC instance.

It has the following ABNF grammar:

> AF-Correlation-Information:: = &lt; AVP Header: 1276 &gt;
>
> { AF-Charging-Identifier }
>
> \* \[ Flows \]

### 7.2.12 Alternate-Charged-Party-Address AVP

The *Alternate-Charged-Party-Address* AVP (AVP code 1280) is of type
UTF8String and holds the address of the alternate charged party
determined by an AS at IMS session initiation.

### 7.2.13 AoC-Cost-Information AVP

The *AoC-Cost-Information* AVP (AVP code 2053) is of type Grouped and
holds accumulated and incremental cost infromation for the AoC service

It has the following ABNF grammar:

> AoC-Cost-Information:: = &lt; AVP Header: 2053 &gt;
>
> \[ Accumulated-Cost \]
>
> \* \[ Incremental-Cost \]
>
> \[ Currency-Code \]

### 7.2.14 AoC-Format AVP

The *AoC-Format* AVP (AVP code 2310) is of type Enumerated and holds the
format on how the AoC information shall be sent to the UE.

It can be one of the following values:

MONETARY 0

NON\_MONETARY 1

CAI 2

### 7.2.15 AoC-Information AVP

The *AoC-Information* AVP (AVP code 2054) is of type Grouped that
includes the information required for advice of charge.

It has the following ABNF grammar:

> AoC-Information:: = &lt; AVP Header: 2054 &gt;
>
> \[ AoC-Cost-Information \]

\[ Tariff-Information \]

\[ AoC-Subscription-Information \]

### 7.2.16<span id="OLE_LINK3" class="anchor"><span id="OLE_LINK4" class="anchor"></span></span> AoC-Request-Type AVP

The *AoC-Request-Type* AVP (AVP code 2055) is of type enumerated and
tags if the client is looking for AoCI in conjunction to the
Request-Type and Request-Action AVPs.

It can be one of the following values:

AoC\_NOT\_REQUESTED 0

AoC\_FULL 1

AoC\_COST\_ONLY 2

AoC\_TARIFF\_ONLY 3

### 

### 7.2.17 AoC-Service AVP

The *AoC-Service* AVP (AVP code 2311) is of type Grouped and holds the
pair of AoC Service type and AoC Service obligatory type.

It has the following ABNF grammar:

> AoC-Service :: = &lt; AVP Header: 2311 &gt;
>
> \[ AoC-Service-Obligatory-Type \]
>
> \[ AoC-Service-Type \]

### 7.2.18 AoC-Service-Obligatory-Type AVP

The *AoC-Service-Obligatory-Type* AVP (AVP code 2312) is of type
Enumerated and holds the information if the AoC information is binding
or not.

It can be one of the following values:

NON\_BINDING 0

BINDING 1

### 7.2.19 AoC-Service-Type AVP

The *AoC-Service-Type* AVP (AVP code 2313) is of type Enumerated and
defines the type of AoC information to be provided to the subscriber.

It can be one of the following values:

NONE 0

AOC-S 1

AOC-D 2

AOC-E 3

### 7.2.20 AoC-Subscription-Information AVP

The *AoC-Subscription-Information* AVP (AVP code 2314) is of type
Grouped and holds the subscription and formatting parameters received
from HSS.

It has the following ABNF grammar:

> AoC-Subscription-Information:: = &lt; AVP Header: 2314 &gt;
>
> \* \[ AoC-Service \]
>
> \[ AoC-Format \]
>
> \[ Preferred-AoC-Currency \]

### 7.2.21 Applic-ID AVP

The *Applic-ID* AVP (AVP code 1218) is of type UTF8String and holds the
identification of the destination application that the underlying MMS
abstract message was addressed to.

### 7.2.22 Application-provided-Called-Party-Address AVP

The *Application-Provided-Called-Party-Address* AVP (AVP code 837) is of
type UTF8String and holds the called party number (SIP URI, E.164), if
it is determined by an application server.

### 7.2.23 Application-Server AVP

The *Application-Server* AVP (AVP code 836) is of type UTF8String and
holds the SIP URL(s) of the AS(s) addressed during the session.

### 7.2.24 Application-Server-Information AVP

The *Application-Server-Information* AVP (AVP code 850) is of type
Grouped and contains information about application servers visited
through ISC interface.

It has the following ABNF grammar:

&lt;Application-Server-Information&gt;::= &lt;AVP Header: 850 &gt;

\[ Application-Server \]\
\* \[ Application-Provided-Called-Party-Address \]\
\[ Status-Code \]

### 7.2.25 Associated-Party-Address AVP

The *Associated-Party-Address* AVP (AVP code 2035) is of type UTF8String
and is used for MMTel supplementary service. It holds the address (SIP
URI or TEL URI) of the user, the MMTel supplementary service is provided
to : the "forwarding party" for CDIV, the "transferor" for ECT, the
"Pilot Identity" for Flexible Alerting (FA), the "Initiator party" for
3PTY.

### 7.2.26 Associated-URI AVP

The Associated-URI AVP (AVP code 856) is of type UTF8String and holds a
non-barred public user identity (SIP URI or TEL URI) associated to the
the public user identity under registration. This identity is obtained
from the P-Associated-URI header of a 200 OK SIP response to a REGISTER
request. This AVP may appear several times when the P-Associated-URI
header contains more than one public user identity.

### 7.2.27 Authorised-QoS AVP

The *Authorised-QoS* AVP (AVP code 849) is of type UTF8String and holds
the Authorised QoS as defined in TS 23.207 \[200\] / TS 29.207 \[203\]
and applied via the Go reference point.

This AVP is not used.

### 7.2.28 Aux-Applic-Info AVP

The *Aux-Applic-Info* AVP (AVP code 1219) is of type UTF8String and
holds additional application/implementation specific control
information.

### 7.2.29 Base-Time-Interval AVP

The *Base-Time-Interval* AVP (AVP code 1265) is of type Unsigned32. It
contains the length of the base time interval, for controlling the
consumption of time quota, in seconds.

### 7.2.30 Bearer-Service AVP

The *Bearer-Service* AVP (AVP code 854) is of type OctetString and holds
the used bearer service for the PSTN leg.

### 7.2.31 Called-Asserted-Identity AVP

The *Called-Asserted-Identity* AVP (AVP code 1250) is of type UTF8String
and holds the address (Public User ID: SIP URI, E.164, etc.) of the
finally asserted called party.

The address is obtained from the P-Asserted-Identity SIP header field of
the 2xx responses corresponding to a SIP request either initiating a
dialog or a standalone transaction. This field may appear several times
in the request when the P-Asserted-Identity contains both a SIP URI and
a TEL URI.

This field shall be present when the P-Asserted-Identity SIP header
field is available in the SIP 2xx response.

### 7.2.32 Called-Party-Address AVP

The *Called-Party-Address* AVP (AVP code 832) is of type UTF8String. In
IMS charging (except for SIP Register and SIP Subscription
transactions), it holds the address (SIP URI, TEL URI or URN) of the
party (Public User ID or Public Service ID) to whom the SIP transaction
is posted. The Called Party Address shall be populated with the SIP URI
or TEL URI contained in the Request-URI of the outgoing request.

The URN format is used for emergency services.

For a registration procedure, this field holds the party (Public User
ID) to be registered. In this case, the Called Party Address field is
obtained from the "To" SIP header of the SIP Request. For a subscription
procedure this field holds the address of the resource for which the
originator wants to receive notifications of change of states. In this
case, the Called Party Address field is obtained from the outgoing
Request-URI of the SIP Request.

### 7.2.33 Calling-Party-Address AVP

The *Calling-Party-Address* AVP (AVP code 831) is of type UTF8String and
holds the address (SIP URI or TEL URI) which identifies the party
(Public User Identity or Public Service Identity) initiating a SIP
transaction. . It is obtained from the P-Asserted-Identity header of any
non-REGISTER SIP Request, either initiating a dialog or a standalone
transaction. This AVP may appear several times when the
P-Asserted-Identity header contains both a SIP URI and a TEL URI. In
case no P-Asserted-Identity is known, this AVP list shall include one
item with the value "unknown".

### 7.2.34 Carrier-Select-Routing-Information AVP

The *Carrier-Select-Routing-Information* AVP (AVP code 2023) is of type
UTF8String. This AVP holds information on carrier selection performed by
S-CSCF/AS. This information is sent over SIP in the Requested URI
header.

### 7.2.35 Cause-Code AVP

The *Cause-Code* AVP (AVP code 861) is of type Integer32 and includes
the cause code value from IMS node. It is used in ACR \[Stop\] and/or
ACR \[Event\] messages. It is also used in the CCR \[Terminate\] and/or
CCR \[Event\] messages.

Within the cause codes, values ≤ 0 are reserved for successful causes
while values ≥ 1 are used for failure causes. In case of errors where
the session has been terminated as a result of a specific known SIP
error code, then the SIP error code is also used as the cause code.

**Successful cause code values.**

> "Normal end of session" 0
>
> The cause "Normal end of session" is used in
> Accounting-request\[stop\] message to indicate that an ongoing SIP
> session has been normally released either by the user or by the
> network (SIP BYE message initiated by the user or initiated by the
> network has been received by the IMS node after the reception of the
> SIP ACK message).
>
> "Successful transaction" -1

The cause "Successful transaction" is used in
Accounting-request\[event\] message to indicate a successful SIP
transaction (e.g. REGISTER, MESSAGE, NOTIFY, SUBSCRIBE). It may also be
used by an Application Server to indicate successful service event
execution.

> "End of SUBSCRIBE dialog" -2
>
> The cause "End of SUBSCRIBE dialog" is used to indicate the closure of
> a SIP SUBSCRIBE dialog . For instance a successful SIP SUBSCRIBE
> transaction terminating the dialog has been detected by the IMS node
> (i.e. SUBSCRIBE with expire time set to 0).
>
> "2xx Final Response" -2xx
>
> The cause-code "2xx Final Response"(except 200) is used when the SIP
> transaction is terminated due to an IMS node receiving/initiating a
> 2xx Final response as described in RFC 3261 \[405\].
>
> "3xx Redirection" -3xx
>
> The cause "3xx Redirection" is used when the SIP transaction is
> terminated due to an IMS node receiving/initiating a 3xx response as
> described in RFC 3261 \[405\].
>
> "End of REGISTER dialog" -3
>
> The cause "End of REGISTER dialog" is used to indicate the closure of
> a SIP REGISTER dialog. For instance a successful SIP REGISTER
> transaction terminating the dialog has been detected by the IMS node
> (i.e. REGISTER with expire time set to 0).

**Failure cause code values.**

> "Unspecified error" 1
>
> The cause "Unspecified error" is used when the SIP transaction is
> terminated due to an unknown error.
>
> " 4xx Request failure" 4xx
>
> The cause "4xx Request failure" is used when the SIP transaction is
> terminated due to an IMS node receiving/initiating a 4xx error
> response as described in RFC 3261 \[405\].
>
> "5xx Server failure" 5xx
>
> The cause "5xx Server failure" is used when the SIP transaction is
> terminated due to an IMS node receiving/initiating a 5xx error
> response as described in RFC 3261 \[405\].
>
> "6xx Global failure" 6xx
>
> The cause "6xx Global failure" is used when the SIP transaction is
> terminated due to an IMS node receiving/initiating a 6xx error
> response as described in RFC 3261 \[405\].
>
> "Unsuccessful session setup" 2
>
> The cause "Unsuccessful session setup" is used in the
> Accounting-request\[stop\] when the SIP session has not been
> successfully established (i.e. Timer H expires and SIP ACK is not
> received or SIP BYE is received after reception of the 200OK final
> response and SIP ACK is not received) as described in TS 24.229
> \[202\] and in RFC 3261 \[405\].
>
> "Internal error" 3
>
> The cause "Internal error" is used when the SIP transaction is
> terminated due to an IMS node internal error (e.g. error in processing
> a request/response).

### \
7.2.36 CG-Address AVP

The *CG-Address* AVP (AVP code 846) is of type Address and holds the
IP-address of the charging gateway.

### 7.2.37 Change-Condition AVP

The *Change-Condition* AVP (AVP code 2037) is of type Integer32, and
indicates the change in charging condition: (Qos change, tariff time
change …) which causes:

- sending of Accounting-request from PCN node

- volume counts container closing for an IP-CAN bearer.

- service data container closing.

- record closing.

The following values are defined :

"Normal Release" 0

The "Normal Release" value is used to indicate IP-CAN session
termination , IP-CAN bearer release or Service Data Flow Termination

" Abnormal Release " 1

" Qos Change " 2

"Volume Limit" 3

"Time Limit 4

"Serving Node Change" 5

"Serving Node PLMN Change" 6

"User Location Change" 7

"RAT Change" 8

"UE TimeZone Change" 9

"Tariff Time Change" 10

"Service Idled Out" 11

"serviceSpecificUnitLimit" 12

"Max Number of Changes in Charging conditions" 13

" CGI-SAI Change " 14

" RAI Change " 15

" ECGI Change " 16

" TAI Change " 17

" Service Data Volume Limit " 18

" Service Data Time Limit " 19

"Management Intervention" 20

"Service Stop" 21

"User CSG Information Change" 22

<span id="_Toc375141072" class="anchor"></span>"S-GW Change" 23

### 7.2.38 Change-Time AVP

The *Change-Time* AVP (AVP code 2038) is of type Time.

In EPC Charging, it holds the time in UTC format when the volume counts
associated to the IP-CAN bearer, or the service data container, is
closed and reported due to Charging condition change.

For MMTel Charging, it holds the time in UTC format and it is a time
stamp that defines the moment when the conference participant has an
action (e.g. creating the conference, joining in the conference, being
invited into the conference and quiting the conference) triggering the
Accounting Request message to CDF

### 7.2.38A Charge-Reason-Code AVP

The *Charge-Reason-Code* AVP (AVP code 2118) is of type Enumerated and
identifies if the Rate-Element corresponds to a specific charge type.

It can be one of the following values:

UNKNOWN 0

USAGE 1

COMMUNICATION-ATTEMPT-CHARGE 2

SETUP-CHARGE 3

ADD-ON-CHARGE 4

### 7.2.39 Charged-Party AVP

The Charged-Party AVP (AVP code 857) is of type UTF8String and holds the
address (Public User ID: SIP URI, TEL URI, etc.) of the party to be
charged.

### 7.2.39A Charging-Characteristics-Selection-Mode AVP

The *Charging-Characteristics-Selection-Mode* AVP (AVP code 2066) is of
type Enumerated and indicates how the applied Charging-Characteristics
was selected.

It may take following values:

> 0 Serving-Node-Supplied
>
> 1 Subscription-specific
>
> 2 APN-specific
>
> 3 Home-Default
>
> 4 Roaming-Default
>
> 5 Visiting-Default

### 7.2.40 Class-Identifier AVP

The *Class-Identifier* AVP (AVP code 1214) is of type Enumerated and

The values are:

> 0 Personal
>
> 1 Advertisement
>
> 2 Informational
>
> 3 Auto

### 7.2.41 Client-Address

The *Client-Address* AVP (AVP code 2018) is of type Address and is the
address of the messaging Node which the OCS is connected to.

### 7.2.42 Content-Class AVP

The *Content-Class* AVP (AVP code 1220) is of type Enumerated and
classifies the content of the MM to the highest content class to which
the MM belongs, as defined in MMS Encapsulation \[209\].

The classes can be one of the following:

> 0 text
>
> 1 image-basic
>
> 2 image-rich
>
> 3 video-basic
>
> 4 video-rich
>
> 5 megapixel
>
> 6 content-basic
>
> 7 content-rich

### 7.2.43 Content-Disposition AVP

The *Content-Disposition* AVP (AVP code 828) is of type UTF8String and
indicates how the message body or a message body part is to be
interpreted (e.g. session, render), as described in RFC 3261 \[405\].

### 7.2.44 Content-Length AVP

The *Content-Length* AVP (AVP code 827) is of type Unsigned32 and holds
the size of the message-body, as described in RFC 3261 \[405\].

### 7.2.45 Content-Size AVP

The *Content-Size* AVP (AVP code 1206) is of type Unsigned32 and
indicates the size in bytes of the specified content type.

### 7.2.46 Content-Type AVP

The *Content-Type* AVP (AVP code 826) is of type UTF8String and holds
the media type (e.g. application/sdp, text/html) of the message-body, as
described in RFC 3261 \[405\].

### 7.2.46A CSG-Access-Mode AVP

The *CSG-Access-Mode* AVP (AVP code 2317) is of type Enumerated and
holds the mode in which the CSG cell User is accessing to, operates.

It has the following values:

> 0 Closed mode
>
> 1 Hybrid Mode

### 7.2.46B CSG-Membership-Indication AVP

The *CSG-Membership-Indication* AVP (AVP code 2318) is of type
Enumerated, and indicates the UE is a member of the accessing CSG cell,
if the access mode is Hybrid, as described in TS 29.060 \[225\], and in
TS 29.274 \[226\]. If this indication is not present, this means the UE
is a Not member of the CSG cell for hybrid access mode.

The following values are defined:

> 0 Not CSG member
>
> 1 CSG Member

### 7.2.47 Current-Tariff AVP

The *Current-Tariff* AVP (AVP code 2056) is of type Grouped and holds
tariff information. The Tariff is a formula for cost calculation given
the *Used-Service-Unit* AVP. The calculated cost is given in the
*Currency-Code* AVP. The formula sums all the rating elements and
multiplies the sum by the *Scale-Factor* AVP.

It has the following ABNF grammar:

> Current-Tariff:: = &lt; AVP Header: 2056 &gt;
>
> \[ Currency-Code \]
>
> \[ Scale-Factor \]
>
> \* \[ Rate-Element \]

### 7.2.48 CUG-Information

The *CUG-Information* AVP (AVP code 2304) is of type OctetString and
holds the "CUG Interlock Code" which identifies CUG membership within
the Network for "Closed User Group" MMTel supplementary service.

### 7.2.49 Data-Coding-Scheme AVP

The *Data-Coding-Scheme* AVP (AVP code 2001) is of type Integer 32 and
contains the data coding scheme of the message. For SM applications the
specific coding is as described in TS 23.040 \[216\].

### 7.2.50 DCD-Information AVP

The *DCD-Information* AVP (AVP code 2115) is of type Grouped. Its
purpose is to allow the transmission of service information elements
used for DCD services.

The AVP is defined in OMA-DDS-Charging\_Data \[223\].

### 7.2.51 Deferred-Location-Event-Type AVP

The *Deferred-Location-Even-Type* AVP (AVP code 1230) is of type
UTF8String and holds information related to a deferred location request.

### 7.2.52 Delivery-Report-Requested AVP

The *Delivery-Report-Requested* AVP (AVP code 1216) is of type
Enumerated and indicates whether a delivery report has been requested by
the originator or not.

The values for whether a report was requested are:

> 0 No
>
> 1 Yes

### <span id="_Ref166904295" class="anchor"><span id="_Toc375141091" class="anchor"></span></span>7.2.53 Destination-Interface AVP

The *Destination-Interface* AVP (AVP code 2002) is type Grouped, which
contains information related to the Interface on which the message is to
be delivered.

> Destination-Interface ::= &lt; AVP Header: 2002 &gt;
>
> \[ Interface-Id \]
>
> \[ Interface-Text \]
>
> \[ Interface-Port \]
>
> \[ Interface-Type \]

### 7.2.54 Diagnostics AVP

The *Diagnostics* AVP (AVP code 2039) is of type Integer32 and provides
a more detailed cause value from PCN node. It complements the
*Change-Condition* AVP for Offline Charging.

### 7.2.55 Domain-Name AVP

The *Domain-Name* AVP (AVP code 1200) is of type UTF8String and
represents a fully qualified domain name (FQDN).

### 7.2.56 DRM-Content AVP

The *DRM-Content* AVP (AVP code 1221) is of type Enumerated and
indicates if the MM contains DRM-protected content.

The values are:

> 0 No
>
> 1 Yes

### 7.2.57 Dynamic-Address-Flag AVP

The *Dynamic-Address-Flag* AVP(AVP code 2051) is of type Enumerated, and
indicates whether the PDP context/PDN address is statically or
dynamically allocated. If this AVP is not present, this means that the
address is statically allocated. The following values are defined:

> 0 Static
>
> 1 Dynamic

### 7.2.57A Dynamic-Address-Flag-Extension AVP

The *Dynamic-Address-Flag*-*Extension* AVP (AVP code 2068) is of type
Enumerated, and indicates that the IPv4 PDN address has been dynamically
allocated for that particular IP CAN bearer (PDN connection) of PDN type
IPv4v6, and the dynamic IPv6 address is indicated in Dynamic Address
Flag. This field if IPv4 address is static.The following values are
defined:

> 0 Static
>
> 1 Dynamic

### \
7.2.58 Early-Media-Description AVP

The *Early-Media-Description* AVP (AVP code 1272) is of type grouped and
describes the SDP session, media parameters and timestamps related to
media components set to active according to SDP signalling exchanged
during a SIP session establishment before the final successful or
unsuccessful SIP answer to the initial SIP INVITE message is received.
Once a media component has been set to active, subsequent status changes
shall also be registered.

It has the following ABNF grammar:

&lt;Early-Media-Description&gt;:: = &lt;AVP Header: 1272&gt;

> \[ SDP-TimeStamps \]
>
> \* \[ SDP-Media-Component \]
>
> \* \[ SDP-Session-Description \]

Media can be considered as inactive in range of situations, such as the
listed below according to RFC 3264 \[408\]:

-   Media marked with "a=inactive" attribute.

-   Media offered with zero bandwith.

In contrast, media with directionality marked as "a=recvonly",
"a=sendonly", "a=sendrecv" shall be considered in state "active" and
thus, it may be exchanged in one or both directions.

### 7.2.59 Envelope AVP

The *Envelope* AVP (AVP code 1266) is a grouped AVP which reports the
start and end time of one time envelope using the Envelope-Start-Time
and Envelope-End-Time AVPs. Further details of its usage are described
in clause 6.5.6 and 6.5.7.

Envelope :: = &lt; AVP Header: 1266&gt;

> { Envelope-Start-Time }
>
> \[ Envelope-End-Time \]
>
> \[ CC-Total-Octets \]
>
> \[ CC-Input-Octets \]
>
> \[ CC-Output-Octets \]
>
> \[ CC-Service-Specific-Units \]
>
> \* \[ AVP \]

If an envelope has not been closed at the time of the usage report, then
the Envelope-End-Time AVP shall be absent. If an envelope was started
before the reporting interval then the Envelope-Start-Time is
nevertheless present and contains the same time as previously reported,
i.e. the actual time of the start of the envelope. The client shall
include the volume reports (the CC-xxxxx-Octets AVPs) or events
(CC-Service-Specific-Units) if these were requested in the corresponding
Envelope-Reporting AVP. The reported volume is always the volume from
the beginning of the time envelope.

In circumstances, in which an envelope is retrospectively deemed to have
been closed, e.g. with Quota-Consumption-Time changes in a CCA, then the
client shall include the Envelope-AVP for the envelope in the next usage
report.

Multiple occurrences of this AVP shall be in chronological order, i.e.
the first envelope is listed first in CCR.

### 7.2.60 Envelope-End-Time AVP

This *Envelope-End-Time* AVP (AVP code 1267) is of type Time. It is set
to the time of the end of the time envelope.

### \
7.2.61 Envelope-Reporting AVP

This *Envelope-Reporting* AVP (AVP code 1268) is of type Enumerated and
is used in the CCA (INITIAL) to indicate whether the client shall report
the start and end of each time envelope, in those cases in which quota
is consumed in envelopes.

It can take the values:

DO\_NOT\_REPORT\_ENVELOPES (0)

REPORT\_ENVELOPES (1)

REPORT\_ENVELOPES\_WITH\_VOLUME (2)

REPORT\_ENVELOPES\_WITH\_EVENTS (3)

REPORT\_ENVELOPES\_WITH\_VOLUME\_AND\_EVENTS (4)

If this AVP is not included in the CCA (INITIAL) then the client shall
not report the individual envelopes. If this AVP is included within the
Offline-Charging AVP, the value shall dictate the mechanism by which
offline charging information is generated.

### 7.2.62 Envelope-Start-Time AVP

The *Envelope-Start-Time* AVP (AVP code 1269) is of type Time. It is set
to the time of the packet of user data which caused the time envelope to
start.

### 7.2.63 Event AVP

The *Event* AVP (AVP code 825) is of type UTF8String and holds the
content of the "Event" header.

### 7.2.64 Event-Charging-TimeStamp AVP

The *Event-Charging-TimeStamp* AVP (AVP code 1258) is of type Time, and
it holds the timestamp of the event reported in the
CC-Service-Specific-Units AVP when event based charging applies.

Editor’s Note: The SIP parameter from which the IMS Application
Reference ID (IARI) is to be extracted requires further investigation in
CT1. A mechanism to identify the IARI in use is ffs.

### 7.2.65 Event-Type AVP

The *Event-Type* AVP (AVP code 823) is of type Grouped and contains
information about the type of chargeable telecommunication service/event
for which the accounting-request and/or credit control request
message(s) is generated.

It has the following ABNF grammar:

&lt;Event-Type&gt;:: = &lt;AVP Header: 823 &gt;

\[ SIP-Method \]

\[ Event \]

\[ Expires \]

### 7.2.66 Expires AVP

The *Expires* AVP (AVP code 888) is of type Unsigned32 and holds the
content of the "Expires" header.

Editor’s note: to be clarified.

### \
7.2.67 File-Repair-Supported AVP

The File-Repair-Supported AVP (AVP code 1224) is of type Enumerated and
indicates whether the MBMS user service supports point-to-point file
repair. The following values are supported:

SUPPORTED (1)

The MBMS user service does support point-to-point file repair.

NOT\_SUPPORTED (2)

The MBMS user service does not support point-to-point file repair.

### 7.2.67A From-Address AVP

The *From-Address* AVP (AVP code 2708) is of type UTF8String and
includes the information from the SIP From header.

### 7.2.68 GGSN-Address AVP

The *GGSN-Address* AVP (AVP code 847) is of type Address and holds the
IP-address of the P-GW that generated the GPRS/EPC Charging ID, as
described in \[1\].

### <span id="_Ref166904316" class="anchor"><span id="_Ref177810758" class="anchor"><span id="_Toc375141109" class="anchor"></span></span></span>7.2.69 IM-Information AVP

The *IM-Information* AVP (AVP code 2110) is of type Grouped. Its purpose
is to allow the transmission of service information elements used for IM
services.

The AVP is defined in OMA-DDS-Charging\_Data \[223\].

### 7.2.70 Incremental-Cost AVP

The *Incremental-Cost* AVP (AVP code 2062) is of type Grouped and holds
the incremental cost since last AoC interaction for the ongoing session.

It has the following ABNF grammar:

> Incremental-Cost:: = &lt; AVP Header: 2062 &gt;
>
> { Value-Digits }
>
> \[ Exponent \]

### 7.2.71 Interface-Id AVP

The *Interface-Id* AVP (AVP code 2003) is of type UTF8String and holds
the interface identification provided by the messaging node
(originator/destination).

### <span id="_Ref166904346" class="anchor"><span id="_Toc375141112" class="anchor"></span></span>7.2.72 Interface-Port AVP

The *Interface-Port* AVP (AVP code 2004) is of type UTF8String and holds
the port-identification or contains information about the transport
layer port used by the application associated with the charging event.

### <span id="_Ref166904331" class="anchor"><span id="_Toc375141113" class="anchor"></span></span>7.2.73 Interface-Text AVP

The *Interface-Text* AVP (AVP code 2005) is of type UTF8String and is
the consolidation information about the application associated with the
charging event.

### <span id="_Ref166904358" class="anchor"><span id="_Toc375141114" class="anchor"></span></span>7.2.74 Interface-Type AVP

The *Interface-Type* AVP (AVP code 2006) is of type Enumerated and
contains information about type of interface / nature of the transaction
in the messaging node for which the charging event occurs. The AVP can
take the following values:

0 Unknown

1 MOBILE\_ORIGINATING

2 MOBILE\_TERMINATING

3 APPLICATION\_ORIGINATING

4 APPLICATION\_TERMINATION

### 7.2.74A IMS-Application Reference-Identifier AVP

The *IMS-Application-Reference-Identifier* AVP (AVP code 2601) is of
type UTF8String and holds the IMS Application Reference Identifier
(IARI) as contained in a SIP request to identify an IMS Application as
defined in TS 24.229 \[202\].

<span id="OLE_LINK73" class="anchor"><span id="OLE_LINK74"
class="anchor"></span></span>Editor’s Note: The SIP parameter from which
the IMS Application Reference ID (IARI) is to be extracted requires
further investigation in CT1. A mechanism to identify the IARI in use is
ffs.

### 7.2.75 IMS-Charging-Identifier AVP

The *IMS-Charging-Identifier* AVP (AVP code 841) is of type UTF8String
and holds the IMS Charging Identifier (ICID) as generated by a IMS node
for a SIP session and described in TS 24.229 \[204\].

### 7.2.76 IMS-Communication-Service-Identifier AVP

The *IMS-Communication-Service-Identifier* AVP (AVP code 1281) is of
type UTF8String and holds the IMS Communication Service Identifier
(ICSI) as contained in the P-Asserted-Service header of a SIP request to
identify an IMS Communication Service as defined in TS 24.229 \[202\].

### 7.2.76A IMS-Emergency-Indicator AVP

The *IMS-Emergency-Indicator* AVP (AVP code 2322) is of type Enumerated,
and indicates the IMS session is an IMS emergency session or IMS
registration. If this AVP is not present, this means the IMS session or
registration is not detected as an emergency session or registration.
The following values are defined:

> 0 Non Emergency
>
> 1 Emergency

### 7.2.77 IMS-Information AVP

The *IMS-Information* AVP (AVP code 876) is of type Grouped. Its purpose
is to allow the transmission of additional IMS service specific
information elements.

It has the following ABNF grammar:

> IMS-Information :: = &lt; AVP Header: 876&gt;

\[ Event-Type \]

\[ Role-Of-Node \]

{ Node-Functionality }

\[ User-Session-Id \]

\[ Outgoing-Session-Id \]

\[ Session-Priority \]

\* \[ Calling-Party-Address \]

\[ Called-Party-Address \]

\* \[ Called-Asserted-Identity \]

\[ Number-Portability-Routing-Information \]

\[ Carrier-Select-Routing-Information \]

\[ Alternate-Charged-Party-Address \]

\*\[ Requested-Party-Address \]

\* \[ Associated-URI \]

\[ Time-Stamps \]

\* \[ Application-Server-Information \]

\* \[ Inter-Operator-Identifier \]

\* \[ Transit-IOI-List \]

\[ IMS-Charging-Identifier \]

\* \[ SDP-Session-Description \]

\* \[ SDP-Media-Component \]

\[ Served-Party-IP-Address \]

\[ Server-Capabilities \]

\[ Trunk-Group-ID \]

\[ Bearer-Service \]

\[ Service-Id \]

\* \[ Service-Specific-Info \]

\* \[ Message-Body \]

\[ Cause-Code \]

\[ Access-Network-Information \]

\* \[ Early-Media-Description \]

\[ IMS-Communication-Service-Identifier \]

\[ IMS-Application-Reference-Identifier \]

\[ Online-Charging-Flag \]

\[ Real-Time-Tariff-Information \]

\[ Account-Expiration \]

\[ Initial-IMS-Charging-Identifier \]

\* \[ NNI-Information \]

\[ From-Address \]

\[ IMS-Emergency-Indicator \]

\[ IMS-Visited-Network-Identifier \]

\* \[ Access-Transfer-Information \]

\[ Related-IMS-Charging-Identifier \]

\[ Related-IMS-Charging-Identifier-Node \]

\[ Route-Header-Received \]

\[ Route-Header-Transmitted \]

### 7.2.77A IMS-Visited-Network-Identifier AVP

The *IMS-Visited-Network-Identifier* AVP (AVP code 2713) is of type
UTF8String and contains the contents of the SIP P-header
"P-Visited-Network-ID".

### 7.2.78 IMSI-Unauthenticated-Flag AVP

The *IMSI-Unauthenticated-Flag* AVP (AVP code 2308) is of type
Enumerated, and indicates the served IMSI is not authenticated. This may
occur when emergency bearer service is provided (refer to TS
23.060 \[74\] and TS 29.274 \[91\]). If this flag is not present, this
means the served IMSI is authenticated.

The following values are defined:

> 0 Authenticated
>
> 1 Unauthenticated

### 7.2.79 Incoming-Trunk-Group-ID AVP

The *Incoming-Trunk-Group-ID* AVP (AVP code 852) is of type UTF8String
and identifies the incoming PSTN leg.

### 7.2.79A Initial-IMS-Charging-Identifier AVP

The *Initial-IMS-Charging-Identifier* AVP (AVP code 2321) is of type
UTF8String and holds the Initial IMS Charging Identifier (ICID) as
generated by a IMS node for the initial SIP session created for IMS
service continuity.

### 7.2.80 Inter-Operator-Identifier AVP

The *Inter-Operator-Identifier* AVP (AVP code 838) is of type Grouped
and holds the identification of the network neighbours (originating and
terminating) as exchanged via SIP signalling and described in \[404\].

It has the following ABNF grammar:

&lt;Inter-Operator-Identifier&gt;:: = &lt; AVP Header: 838 &gt;

> \[ Originating-IOI \]
>
> \[ Terminating-IOI \]

### 7.2.80A IP-Realm-Default-Indication AVP

The *IP-Realm-Default-Indication-Indication* AVP (AVP code 2603) is of
type Enumerated and indicates whether the IP realm used for the SDP
media component is the Default IP realm or not.

The following values are defined:

> 0 Default IP Realm Not used
>
> 1 Default IP realm used

### 7.2.81 LCS-APN AVP

The *LCS-APN* AVP (AVP code 1231) is of type UTF8String and contains the
APN of the LCS Client.

### 7.2.82 LCS-Client-Dialed-By-MS AVP

The *LCS-Client-Dialed-By-MS* AVP (AVP code 1233) is of type UTF8String
and holds the number of the LCS Client dialled by the UE.

### 7.2.83 LCS-Client-External-ID AVP

The *LCS-Client-External-ID* AVP (AVP code 1234) is of type UTF8String
and holds the identification of the external LCS Client.

### 7.2.84 LCS-Client-ID AVP

The *LCS-Client-Id* AVP (AVP code 1232) is of type Grouped and holds
information related to the identity of an LCS client.

It has the following ABNF grammar:

&lt;LCS-Client-ID&gt;:: = &lt; AVP Header: 1232 &gt;

> \[ LCS-Client-Type \]
>
> \[ LCS-Client-External-ID \]
>
> \[ LCS-Client-Dialed-By-MS \]
>
> \[ LCS-Client-Name \]
>
> \[ LCS-APN \]
>
> \[ LCS-Requestor-ID \]

### 7.2.85 LCS-Client-Name AVP

The *LCS-Client-Name* AVP (AVP code 1235) is of type Grouped and
contains the information related to the name of the LCS Client.

It has the following ABNF grammar:

&lt;LCS-Client-Name&gt;:: = &lt; AVP Header: 1235&gt;

> \[ LCS-Data-Coding-Scheme \]
>
> \[ LCS-Name-String \]
>
> \[ LCS-Format-Indicator \]

### 7.2.86 LCS-Client-Type AVP

The *LCS-Client-Type* AVP (AVP code 1241) is of type Enumerated and
contains the type of services requested by the LCS Client.

It can be one of the following values:

EMERGENCY\_SERVICES 0

VALUE\_ADDED\_SERVICES 1

PLMN\_OPERATOR\_SERVICES 2

LAWFUL\_INTERCEPT\_SERVICES 3

### 7.2.87 LCS-Data-Coding-Scheme AVP

The *LCS-Data-Coding-Scheme* AVP (AVP code 1236) is of type UTF8String
and contains the information of the alphabet and the language used.

### 7.2.88 LCS-Format-Indicator AVP

The *LCS-Format-Indicator* AVP (AVP code 1237) is of type Enumerated and
contains the format of the LCS Client name.

It can be one of the following values:

LOGICAL\_NAME 0

EMAIL\_ADDRESS 1

MSISDN 2

URL 3

SIP\_URL 4

### 7.2.89 LCS-Information AVP

The LC*S-Information* AVP (AVP code 878) is of type Grouped. Its purpose
is to allow the transmission of additional LCS service specific
information elements.

It has the following ABNF grammar:

LCS-Information :: = &lt; AVP Header: 878&gt;

> \[ LCS-Client-ID \]
>
> \[ Location-Type \]
>
> \[ Location-Estimate \]
>
> \[ Positioning-Data \]
>
> \[ 3GPP-IMSI \]
>
> \[ MSISDN \]

### 7.2.90 LCS-Name-String AVP

The *LCS-Name-String* AVP (AVP code 1238) is of type UTF8String and
contains the LCS Client name.

### 7.2.91 LCS-Requestor-ID AVP

The LCS-Requestor-ID AVP (AVP code 1239) is of type Grouped and contains
information related to the identification of the Requestor.

It has the following ABNF grammar:

&lt;LCS-Requestor-ID&gt;:: = &lt; AVP Header: 1239 &gt;

> \[ LCS-Data-Coding-Scheme \]
>
> \[ LCS-Requestor-ID-String \]

### 7.2.92 LCS-Requestor-ID-String AVP

The *LCS-Requestor-ID-String* AVP (AVP code 1240) is of type UTF8String
and contains the identification of the Requestor and can be e.g. MSISDN
or logical name.

### 7.2.92A Local-GW-Inserted-Indication AVP

The *Local-GW-Inserted-Indication* AVP (AVP code 2604) is of type
Enumerated and indicates if the local GW (TrGW, IMS-AGW) is inserted or
not for the SDP media component.

The following values are defined:

> 0 Local GW Not Inserted
>
> 1 Local GW Inserted

### 7.2.93 Local-Sequence-Number AVP

The *Local-Sequence-Number* AVP (AVP code 2063) is of type Unsigned32
and holds the service data container sequence number : increased by 1
for each service data container closed.

### 7.2.94 Location-Estimate AVP

The *Location-Estimate* AVP (AVP code 1242) is of type OctetString and
contains an estimate of the location of an MS in universal coordinates
and the accuracy of the estimate. Refers to geographical area
descriptions in 3GPP TS 23.032 \[227\] for the internal structure and
encoding of this AVP.

### 7.2.95 Location-Estimate-Type AVP

The *Location-Estimate-Type* AVP (AVP code 1243) is of type Enumerated
and contains one of the following values:

CURRENT\_LOCATION 0

CURRENT\_LAST\_KNOWN\_LOCATION 1

INITIAL\_LOCATION 2

ACTIVATE\_DEFERRED\_LOCATION 3

CANCEL\_DEFERRED\_LOCATION 4

### 7.2.96 Location-Type AVP

The *Location-Type* AVP (AVP code 1244) is of type Grouped and indicates
the type of location estimate required by the LCS client.

It has the following ABNF grammar:

Location-Type:: = &lt; AVP Header: 1244&gt;

> \[ Location-Estimate-Type \]
>
> \[ Deferred-Location-Event-Type \]

### 7.2.97 Low-Balance-Indication AVP

The *Low-Balance-Indication* AVP (AVP code 2020) is of type Enumerated
and indicates if the subscriber balance went below a designated
threshold by its account.

This indication can be used to advise the end user about the need to
replenish his balance.

It can be one of the following values:

NOT-APPLICABLE 0

YES 1

### 7.2.97A Low-Priority-Indicator AVP

The *Low-Priority-Indicator* AVP (AVP code 2602) is of type Enumerated
and indicates if the PDN connection has a low priority, i.e. for Machine
Type Communications.

It can be one of the following values:

NO 0

YES 1

### 7.2.98 MBMS-GW-Address AVP

The *MBMS-GW-Address* AVP (AVP code 2307) is of type Address and holds
the IP-address . This AVP of the MBMS GW that generated the MBMS
Charging ID when MBMS GW is stand-alone.

### 7.2.99 MBMS-Information AVP

The *MBMS-Information* AVP (AVP code 880) is of type Grouped. Its
purpose is to allow the transmission of additional MBMS service specific
information elements.

It has the following ABNF grammar:

MBMS-Information :: = &lt; AVP Header: 880&gt;

> \[ TMGI \]
>
> \[ MBMS-Service-Type \]
>
> \[ MBMS-User-Service-Type \]
>
> \[ File-Repair-Supported \]
>
> \[ Required-MBMS-Bearer-Capabilities \]
>
> \[ MBMS-2G-3G-Indicator \]
>
> \[ RAI \]

\* \[ MBMS-Service-Area \]

> \[ MBMS-Session-Identity \]
>
> \[ CN-IP-Multicast-Distribution \]
>
> \[ MBMS GW-Address \]

### 7.2.100 MBMS-User-Service-Type AVP

The *MBMS-User-Service-Type* AVP (AVP code 1225) is of type Enumerated
indicates type of service the the MBMS user service that is being
delivered. The following values are supported:

DOWNLOAD (1)

The MBMS user service of type: download.

STREAMING (2)

The MBMS user service is of type: streaming.

### 7.2.101 Media-Initiator-Flag AVP

The *Media-Initiator-Flag* AVP (AVP code 882) is of type Enumerated and
indicates which party has requested the session modification. The
default value is ‘0’ indicating the called party initiated the
modification.

\[0\] called party

\[1\] calling party

\[2\] unknown

### 7.2.102 Media-Initiator-Party AVP

The *Media-Initiator-Party* AVP (AVP code 1288) is of type UTF8String.
Enumerated in IMS charging, it holds the address (SIP URI or TEL URI) of
the party (Public User ID or Public Service ID) who initiates the media
action, like adding/removing, connecting/disconnecting the media. The
Media Initiator Party shall be populated with the SIP URI or TEL URI
contained in the Request-URI of the outgoing request. It is use for PoC
charging.

### 7.2.103 Message-Body AVP

The *Message-Body* AVP (AVP Code 889) is of type Grouped AVP and holds
information about the message bodies including user-to-user data.

It has the following ABNF grammar:

&lt;Message-Body&gt;::= &lt; AVP Header: 889 &gt;

> { Content-Type }\
> { Content-Length }\
> \[ Content-Disposition \]\
> \[ Originator \]

The message bodies shall not include the bodies' of Content-Type =
"application-sdp" as these are captured in other AVPs.

### 7.2.104 Message-Class AVP

The *Message-Class* AVP (AVP code 1213) is of type Grouped.

It has the following ABNF grammar:

> Message-Class :: = &lt; AVP Header: 1213 &gt;
>
> \[ Class-Identifier \]
>
> \[ Token-Text \]

### 7.2.105 Message-ID AVP

The *Message-ID* AVP (AVP code 1210) is of type UTF8String and holds the
identification of the message being charged.

### 7.2.106 Message-Size AVP

The *Message-Size* AVP (AVP code 1212) is of type Unsigned32. For MMS,
it holds the total size in bytes of the MM calculated according to TS
23.140 \[208\]. For SMS, it holds the total size in octets of SM
including any user data header.

### 7.2.107 Message-Type AVP

The *Message-Type* AVP (AVP code 1211) is of type Enumerated and holds
the type of the message according to the MMS transactions e.g.
submission, delivery.

The following values are defined and are as specified in MMS
Encapsulation \[209\]:

> 1 m-send-req
>
> 2 m-send-conf
>
> 3 m-notification-ind
>
> 4 m-notifyresp-ind
>
> 5 m-retrieve-conf
>
> 6 m-acknowledge-ind
>
> 7 m-delivery-ind
>
> 8 m-read-rec-ind
>
> 9 m-read-orig-ind
>
> 10 m-forward-req
>
> 11 m-forward-conf
>
> 12 m-mbox-store-conf
>
> 13 m-mbox-view-conf
>
> 14 m-mbox-upload-conf
>
> 15 m-mbox-delete-conf

### 7.2.108 MM-Content-Type AVP

The *MM-Content-Type* AVP (AVP code 1203) is of type Grouped and
indicates the overall content type of the MM content and includes
information about all the contents of an MM.

It has the following ABNF grammar:

> MM-Content-Type :: = &lt; AVP Header: 1203 &gt;
>
> \[ Type-Number \]
>
> \[ Additional-Type-Information \]
>
> \[ Content-Size \]

\* \[ Additional-Content-Information \]

### 7.2.109 MMBox-Storage-Requested AVP

The *MMBox-Storage-Requested* AVP (AVP code 1248) is of type Enumerated
and indicates whether an MMBoxstorage has been requested by the
originator MMS User Agent or not. The values for whether an MMBox
Storage was requested are:

> 0 No
>
> 1 Yes

### 7.2.110 MMS-Information AVP

The MM*S-Information* AVP (AVP code 877) is of type Grouped. Its purpose
is to allow the transmission of additional MMS service specific
information elements.

It has the following ABNF grammar:

> MMS-Information :: = &lt; AVP Header: 877&gt;
>
> \[ Originator-Address \]
>
> \* \[ Recipient-Address \]
>
> \[ Submission-Time \]
>
> \[ MM-Content-Type \]
>
> \[ Priority \]
>
> \[ Message-ID \]
>
> \[ Message-Type \]
>
> \[ Message-Size \]
>
> \[ Message-Class \]
>
> \[ Delivery-Report-Requested \]
>
> \[ Read-Reply-Report-Requested \]
>
> \[ MMBox-Storage-Requested \]
>
> \[ Applic-ID \]
>
> \[ Reply-Applic-ID \]
>
> \[ Aux-Applic-Info \]
>
> \[ Content-Class \]
>
> \[ DRM-Content \]
>
> \[ Adaptations \]
>
> \[ VASP-Id \]
>
> \[ VAS-Id \]

### 7.2.111 MMTel-Information AVP

The MMTel*-Information* AVP (AVP code 2030) is of type Grouped. Its
purpose is to allow the transmission of additional MMtel service
specific information elements. It holds MMTel supplementary services
invoked during MMTel service.

It has the following ABNF grammar:

MMTel-Information :: = &lt; AVP Header: 2030&gt;

> \* \[ Supplementary-Service\]

### 7.2.111aA MMTel-SService-Type AVP

The *MMTel-SService-Type* AVP (AVP Code 2031) is of type Unsigned32 and
identifies the type of MMTel supplementary service.

The following values are defined:

"Originating Identification Presentation (OIP)" 0

"Originating Identification Restriction (OIR)" 1

"Terminating Identification Presentation (TIP)" 2

"Terminating Identification Restriction (TIR)" 3

"Communication HOLD (HOLD)" 4

"Communications Barring (CB )" 5

"Communication Diversion (CDIV)" 6

"Communication Diversion Notification (CDIVN)" 7 

"Communication Waiting (CW)" 8

"Message Waiting Indication (MWI)" 9

"Conference (CONF)" 10

"Flexible Alerting (FA)" 11

"Completion of Communication to Busy Subscriber (CCBS)" 12

"Completion of Communications on No Reply (CCNR)" 13

"Malicious Communication Identification (MCID) 14

"Customized Alerting Tone" (CAT) 15

"Closed User Group" (CUG) 16

"Personal Network management" (PNM) 17

"Customized Ringing Signal" (CRS) 18

"Advice of Charge (AoC)" 19

"Explicit Communication Transfer (ECT)" 20

Values ≥ 1024 are reserved for specific Network/Manufacturer
supplementary services variants

### 7.2.111A Neighbour-Node-Address AVP

The *Neighbour-Node-Address* AVP (AVP code 2705) is of type Address and
holds the control plane IP address of the

neighboring network contact point that handles the service request in
case of interconnection and roaming.

### 7.2.112 Next-Tariff AVP

The *Next-Tariff* AVP (AVP code 2057) is of type Grouped and holds
tariff information. The Tariff is a formula for cost calculation given
the *Used-Service-Unit* AVP. The calculated cost is given in the
*Currency-Code* AVP. The formula sums all the rating elements and
multiplies the sum by the *Scale-Factor* AVP.

It has the following ABNF grammar:

> Next-Tariff :: = &lt; AVP Header: 2057 &gt;
>
> \[ Currency-Code \]
>
> \[ Scale-Factor \]
>
> \* \[ Rate-Element \]

### 7.2.112A NNI-Information AVP

The *NNI-Information* AVP (AVP code 2703) is of type Grouped and holds
information about the NNI used for interconnection and roaming.

It has the following ABNF grammar:

> NNI-Information :: = &lt; AVP Header: 2703&gt;

\[ Session-Direction \]

\[ NNI-Type \]

\[ Relationship-Mode \]

\[ Neighbour-Node-Address \]

### 7.2.112B NNI-Type AVP

The *NNI-Type* AVP (AVP code 2704) is of type Enumerated and indicates
whether the type of used NNI is non-roaming, roaming without loopback
routing or roaming with loopback routing,

It has the following values:

> 0 non-roaming
>
> 1 roaming without loopback
>
> 2 roaming with loopback

### 7.2.113 Node-Functionality AVP

The *Node-Functionality* AVP (AVP code 862) is of type Enumerated and
includes the *functionality* identifier of the *node*.

The functionality identifier can be one of the following:

> S-CSCF 0\
> P-CSCF 1\
> I-CSCF 2\
> MRFC 3\
> MGCF 4\
> BGCF 5\
> AS 6\
> IBCF 7\
> S-GW 8\
> P-GW 9
>
> HSGW 10\
> E-CSCF 11
>
> MME 12
>
> TRF 13
>
> TF 14
>
> ATCF 15

### 7.2.114 Node-Id AVP

The *Node-Id* AVP (AVP code 2064) is of type UTF8String and includes an
optional, operator configurable identifier string for the node.

### 7.2.115 Number-Of-Diversions AVP

The *Number-of-Diversions* AVP (AVP Code 2034) is of type Unsigned32 and
holds the number of diversions related to a CDIV service. When counting
the number of diversions, all types of diversion are included.

### 7.2.116 Number-Of-Messages-Sent AVP

The *Number-Of-Messages-Sent* AVP (AVP code 2019) is of type Unsigned32
and indicates the number of SMSs sent by the IMS application if
applicable.

### 7.2.117 Number-Of-Participants AVP

The *Number-Of-Participants* AVP (AVP code 885) is of type Unsigned32
and holds the number of invited parties of the multi-party session when
included in the initial charging request message, e.g. in PoC,
CONFerence and SIMPLE IM. When included in interim / update charging
messages, it indicates the number of parties who are currently attached
in the session at the time the interim / update messages are sent.

NOTE: The information to populate this field may be obtained from the
TBCP-Talk-Burst-Grant message in PoC case. The information to populate
this field may be obtained from the Diameter Accounting Request message
in MMTel CONF Charging.

### 7.2.118 Number-Of-Received-Talk-Bursts AVP

The *Number-Of-Received-Talk-Bursts* AVP (AVP code 1282) is of type
Unsigned32 and holds the number of the received talk bursts.

### 7.2.119 Number-Of-Talk-Bursts AVP

The *Number-Of-Talk-Bursts* AVP (AVP code 1283) is of type Unsigned32
and holds the number of the sent talk bursts.

### 7.2.120 Number-Portability-Routing-Information AVP

The *Number-Portability-Routing-Information* AVP (AVP code 2024) is of
type UTF8String and holds information on routing number received by
S-CSCF during number portability look-up (ENUM/DNS). This information is
sent over SIP in the Requested URI header.

### 7.2.121 Offline-Charging AVP

The *Offline-Charging* AVP (AVP code 1278) is a grouped AVP, which is
used to set the parameters required to control offline charging.

It has the following ABNF grammar:

> Offline-Charging ::= &lt; AVP Header:1278 &gt;
>
> \[ Quota-Consumption-Time \]\
> \[ Time-Quota-Mechanism \]
>
> \[ Envelope-Reporting \]
>
> \* \[ Multiple-Services-Credit-Control \]
>
> \* \[ AVP \]

At most one of Quota-Consumption-Time AVP or Time-Quota-Mechanism AVP
shall be present, if individual instances are not included within the
Multiple-Services-Credit-Control AVP.

The Multiple-Services-Credit-Control AVPs, if present, shall contain the
Rating-Group AVP to identify the category, optionally one of
Quota-Consumption-Time AVP and Time-Quota-Mechanism AVP, and optionally
the Envelope-Reporting AVP.

Any values specified in the Offline-Charging AVP take precedence over
the configured defaults. The values of the parameters specified at
Multiple-Services-Credit-Control level take precedence over the values
specified directly at Offline-Charging level. If neither
Quota-Consumption-Time AVP nor Time-Quota-Mechanism AVP is included in
the Multiple-Services-Credit-Control AVP, then the general reporting
requirements dictated by the Quota-Consumption-Time AVP or
Time-Quota-Mechanism AVP and Envelope-Reporting AVP directly within the
Offline-Charging AVP shall apply.

### 7.2.122 Online-Charging-Flag AVP

The *Online-Charging-Flag* AVP (AVP code 2303) is of type Enumerated and
indicates the Online Charging Request was sent based on the provided ECF
address from the SIP P-header "P-Charging-Function-Addresses".

It has the following values:

0 ECF address not provided

1 ECF address provided

### 7.2.123 Originating-IOI AVP

The *Originating-IOI* AVP (AVP code 839) is of type UTF8String
(alphanumeric string) and holds the Inter Operator Identifier (IOI) for
the originating network as generated by the IMS network element which
takes responsibility for populating this parameter \[404\] in a SIP
request as described in TS 24.229 \[202\].

The Originating IOI contains the following values:

- Type 1 IOI:

- IOI of the visited network where the P-CSCF is located for SIP
requests directed to the S-CSCF when initiated by the served user.

- IOI of the home network where the S-CSCF is located for SIP requests
directed to the TRF in the visited network when "VPLMN routing" is
applied in a Roaming Architecture for Voice over IMS with Local
breakout.

- IOI of the home network where the S-CSCF is located for SIP requests
directed to the visited network P-CSCF when terminated at the served
user.

- Type 2 IOI:

- IOI of the home network of the originating end user where the S-CSCF
is located in case a session is initiated from the IMS. In case of
redirection by the S-CSCF, *Originating-IOI* AVP indicates the
terminating party's network operator from which the session is
redirected.

- IOI of the visited network when "VPLMN routing" is applied in a
Roaming Architecture for Voice over IMS with Local breakout.

- IOI of the originating network where the MGCF is located in case a
session is initiated from the PSTN toward the IMS.

- Type 3 IOI:

- IOI of the home network (originating side or terminating side) where
the S-CSCF is located when forwarding a SIP request as described in TS
24.229 \[202\] to an AS (proxy, terminating UA or redirect server or
B2BUA).

- IOI of the service provider network where the AS is located when an AS
(originating UA or B2BUA) initiates a SIP request as described in TS
24.229 \[202\].

For further details on the Type 1, Type 2 and Type 3 IOIs, please refer
to TS 32.240 \[1\].

### 7.2.124 Originator AVP

The *Originator* AVP (AVP code 864) is of type Enumerated and indicates
the originating party of the message body. The following values are
defined:

Calling Party 0

Called Party 1

### 7.2.125 Originator-Address AVP

The *Originator-Address* AVP (AVP code 886) is of type Grouped. Its
purpose is to identify the originator of a message.

It has the following ABNF grammar:

> Originator-Address :: = &lt; AVP Header: 886 &gt;
>
> \[ Address-Type \]
>
> \[ Address-Data \]
>
> \[ Address-Domain \]

### <span id="_Ref177740449" class="anchor"><span id="_Toc375141177" class="anchor"></span></span>7.2.126 Originator-Interface AVP

The *Originator-Interface* AVP (AVP code 2009) is the group AVP which
contains information related to the Interface on which the message
originated.

> Originator-Interface ::= &lt; AVP Header: 2009 &gt;
>
> \[ Interface-Id \]
>
> \[ Interface-Text \]
>
> \[ Interface-Port \]
>
> \[ Interface-Type \]

### <span id="_Ref166904218" class="anchor"><span id="_Toc375141178" class="anchor"></span></span>7.2.127 Originator-Received-Address AVP

The *Originator-Received-Address* AVP (AVP code 2027) is of type
Grouped. Its purpose is to identify the originator of a message with the
original, unmodified address information as received before any address
manipulations has taken place in the entity generating the charging
information. This field allows correlation of address information with
information generated by other nodes in the message flow.

It has the following ABNF grammar:

> Originator-Received-Address :: = &lt; AVP Header: 2027&gt;
>
> \[ Address-Type \]
>
> \[ Address-Data \]
>
> \[ Address-Domain \]

### 7.2.128 Originator-SCCP-Address

The *Originator-SCCP-Address* AVP (AVP code 2008) is of type Address. It
is the "SCCP calling address" used by the messaging node when receiving
a message. This is usually the address of the MSC or SGSN/Serving Node
that was serving the UE when it submitted the message. It contains
either a Point Code (ISPC) or a Global Title, where Global Title
represents an E.164 number. The Address Type discriminator in RFC 3588
\[401\] is set to value 8, E.164, and the address information is UTF8
encoded.

### 7.2.128A Outgoing-Session-Id AVP

The *Outgoing-Session-Id* AVP (AVP code 2320) is of type UTF8String and
holds the outgoing session identifier for an AS acting as B2BUA. For a
SIP session the Outgoing-Session-Id AVP contains the SIP Call ID of the
outgoing leg, as defined in RFC 3261 \[405\].

### 7.2.129 Outgoing-Trunk-Group-ID AVP

The *Outgoing-Trunk-Group-ID* AVP (AVP code 853) is of type UTF8String
and identifies the outgoing PSTN leg.

### 7.2.130 Participants-Involved AVP

The *Participants-Involved* AVP (AVP code 887) is of type UTF8String and
holds the list of address (Public User ID: SIP URI, TEL URI, MSISDN) of
the parties who are involved into the PoC session.

### 7.2.131 Participant-Group AVP

The *Participant-Group* AVP (AVP code 1260) is of type Grouped and holds
detailed information, e.g. the address (Public User ID: SIP URI, TEL
URI, MSISDN), the access priority parameters, etc, of the party who is
involved into the PoC session.

It has the following ABNF grammar:

&lt; Participant-Group &gt; :: = &lt; AVP Header: 1260&gt;

> \[ Called-Party-Address \]
>
> \[ Participant-Access-Priority \]
>
> \[ User-Participating-Type \]

### 7.2.132 Participant-Access-Priority AVP

Participant-Access-Priority AVP (AVP code 1259) is of type Enumerated.
It is a subfield of Participants-Group AVP to indicate the priority
level for users when initiating a new PoC session or participating in a
PoC session.

The AVP may take the values as follows:

1.  Pre-emptive priority: The highest level priority. A request with
    pre-emptive priority SHALL cause the current other requests to be
    revoked immediately, unless they are also with pre-emptive priority.

2.  High priority: Lower than Pre-emptive priority.

3.  Normal priority: Normal level. Lower than High priority.

4.  Low priority: Lowest level priority.

### 7.2.133 Participant-Action-Type AVP

The *Participant-Action-Type* AVP (AVP code 2049) is of type Enumerated
and holds the participant’s action type during the conference for
Billing Domain’s information.

The following values are defined according to TS 24.605 \[219\]:

CREATE\_CONF 0

JOIN\_CONF 1

INVITE\_INTO\_CONF 2

QUIT\_CONF 3

### 7.2.134 PDG-Address AVP

The *PDG-Address* AVP (AVP code 895) is of type Address and contains the
PDG IP address.

### 7.2.135 PDG-Charging-Id AVP

The *PDG-Charging-Id* AVP (AVP code 896) is of type Unsigned32 and
contains the charging identifier generated by the PDG for the tunnel.
Charging identifier is generated at tunnel establishment and transferred
to 3GPP AAA Server.

Different PDGs allocate the charging identifier independently of each
other and may allocate the same numbers. PDG-Charging-Id together with
PDG-Address constitutes a unique identifier for the tunnel.

Coding of this AVP is same as 3GPP-Charging-Id coding described in TS
29.061 \[207\].

### 7.2.136 PDN-Connection-Charging-ID AVP

The *PDN-Connection-Charging-ID* AVP (AVP code 2050) is of type
Unsigned32 and contains the charging identifier to identify different
records belonging to same PDN connection. This field includes Charging
Id of first IP-CAN bearer activated within the PDN connection. Together
with P-GW address this uniquely identifies the PDN connection for
charging.

Coding of this AVP is same as 3GPP-Charging-Id coding described in TS
29.061 \[207\].

### 7.2.137 PDP-Address AVP

The *PDP-Address* AVP (AVP code 1227) is of type Address and holds the
IP-address associated with the IP CAN bearer session ( PDP context / PDN
connection). The PDP-Address-Prefix-Length AVP needs not be available
for IPv6 typed IP-address prefix length of 64 bits.

### 7.2.137a PDP-Address-Prefix-Length AVP

The *PDP-Address*-*Prefix-Length* AVP (AVP code 2606) is of type
Unsigned32 and contains the prefix length of an IPv6 typed PDP-Address
AVP. The omission of this AVP for an IPv6 typed IP address implicitly
means prefix length of 64 bits, as in this case the 64 bit prefix length
default shall be assumed.

### 7.2.138 PDP-Context-Type AVP

The *PDP-Context-Type* AVP (AVP code 1247) is of type Enumerated and
indicates the type of a PDP context.

The values for requested are:

> 0 PRIMARY
>
> 1 SECONDARY

This AVP shall only be present in the CCR Initial.

### 7.2.139 PoC-Change-Condition AVP

The *PoC-Change-Condition* AVP (AVP code 1261) is of type Enumerated and
contains the reason for closing a container and the addition of a new
container. The AVP may take the following values:

serviceChange (0)

volumeLimit (1)

timeLimit (2)

numberofTalkBurstLimit (3)

numberofActiveParticipants (4)

tariffTime (5)

### 7.2.140 PoC-Change-Time AVP

The *PoC-Change-Time* AVP (AVP code 1262) is of type Time and is a time
stamp that defines the moment when a container is closed or the CDR is
closed.

### 7.2.141 PoC-Controlling-Address AVP

The *PoC-Controlling-Address* AVP (AVP code 858) is of type UTF8String
and identifies the PoC server performing the controlling function for
the associated PoC session.

### 7.2.142 PoC-Event-Type AVP

The *PoC-Event-Type* AVP (AVP code 2025) is of type Enumerated and
indicates PoC session unrelated charging event.

The AVP may take the values as follows:

> 0 Normal;
>
> 1 Instant Ppersonal Aalert event;
>
> 2 PoC Group Advertisement event;
>
> 3 Early Ssession Setting-up event;

4 PoC Talk Burst

### 7.2.143 PoC-Group-Name AVP

The *PoC-Group-Name* AVP (AVP code 859) is of type UTF8String and
identifies a group. Included if the session is a pre-arranged group
session or a chat group session. It can be used for PoC and OMA SIMPE IM
Charging, or other applications.

### 7.2.144 PoC-Information AVP

The PoC*-Information* AVP (AVP code 879) is of type Grouped. Its purpose
is to allow the transmission of additional PoC service specific
information elements.

It has the following ABNF grammar:

PoC-Information :: = &lt; AVP Header: 879&gt;

> \[ PoC-Server-Role \]\
> \[ PoC-Session-Type \]\
> \[ PoC-User-Role \]\
> \[ PoC-Session-Initiation-type \]\
> \[ PoC-Event-Type \]\
> \[ Number-Of-Participants \]

\* \[ Participants-Involved \]

\* \[ Participant-Group \]\
\* \[ Talk-Burst-Exchange \]\
\[ PoC-Controlling-Address \]\
\[ PoC-Group-Name \]\
\[ PoC-Session-Id \]\
\[ Charged-Party \]

NOTE: In the ABNF definition of PoC-Information AVP, the
Participants-Involved AVP is kept only for backward compatibility with
Releases before the 3GPP Release 7.

### 7.2.145 PoC-Server-Role AVP

The *PoC-Server-Role* AVP (AVP code 883) is of type Enumerated and
specifies the role of the PoC server.

The identifier can be one of the following:

1.  Participating PoC Server

2.  Controlling PoC Server

### 7.2.146 PoC-Session-Id AVP

The *PoC-Session-Id* AVP (AVP code 1229) is of type UTF8String. It
uniquely identifies an end-to-end PoC session and may be used for
correlation between charging information generated by participating and
controlling PoC functions. This information is obtained from the
"Contact" header of the SIP message received from the controlling PoC
function.

NOTE: The PoC-Session-Id may not be available in the initial charging
interactions for the PoC session.

### 7.2.147 PoC-Session-Initiation-Type AVP

The PoC-Session-Initiation-Type AVP (AVP code 1277) is of type
Enumerated and specifies the type of the PoC session initiation.

The identifier can be one of the following:

1.  Pre-established

2.  On-demand

### 7.2.148 PoC-Session-Type AVP

The *PoC-Session-Type* AVP (AVP code 884) is of type Enumerated and
specifies the type of the PoC session.

The identifier can be one of the following, refer Appendix C.5.1 in OMA
PoC Control Plane specification \[211\]:

1.  1 to 1 PoC session

2.  chat PoC group session

3.  pre-arranged PoC group session

4.  ad-hoc PoC group session

### 7.2.149 PoC-User-Role AVP

The *PoC-User-Role* AVP (AVP code 1252) is of type Grouped. It specifies
the role(s) related information of the PoC User that participating in
the PoC Session.

It has the following grammar:

PoC-User-Role :: = &lt;AVP header: 1252&gt;

\[ PoC-User-Role-Ids \]\
\[ PoC-User-Role-info-Units \]

### 7.2.150 PoC-User-Role-IDs AVP

The *PoC-User-Role-IDs* AVP (AVP code 1253) is of type UTF8String and
identifies the PoC user role.

### 7.2.151 PoC-User-Role-info-Units AVP

The *Poc-User-Role-info-Units* (AVP code 1254) is of type Enumerated and
specify the role type details of PoC users.

The identifier can be one of the following:

1.  Moderator

2.  Dispatcher

3.  Session-Owner

4.  Session-Participant

### 7.2.152 Positioning-Data AVP

The *Positioning-Data* AVP (AVP code 1245) is of type UTF8String and
indicates the usage of each positioning method that was attempted to
determine the location estimate either successfully or unsuccessfully.

### 7.2.153 Preferred-AoC-Currency AVP

The *Preferred-AoC-Currency* AVP (AVP code 2315) is of type Unsigned32
and indicates the preferred currency code that the AoC function would
like to get the AoC information. It is specified by using the numeric
values defined in the ISO 4217 standard, refer RFC 4006 \[402\].

### 7.2.154 Priority AVP

The *Priority* AVP (AVP code 1209) is of type Enumerated and the
priority (importance) of the message if specified. For SMS Charging the
value "low" is not applicable.

The values are:

> 0 Low
>
> 1 Normal
>
> 2 High

### 7.2.155 PS-Append-Free-Format-Data AVP 

The *PS-Append-Free-Format-Data* AVP (AVP code 867) is of type
enumerated and indicates if the information sent in the
PS-Free-Format-Data AVP must be appended to the PS-free-format-data
stored for the online-session.

The following values are defined:

0 ‘Append’: If this AVP is present and indicates ‘Append’, the P-GW
shall append the received PS free format data to the PS free format data
stored for the online charging session.

1 ‘Overwrite’: If this AVP is absent or in value ‘Overwrite’, the P-GW
shall overwrite all PS free format data already stored for the online
charging session.

The P-GW shall ignore this AVP if no PS free format data is stored for
the online charging session.

### 7.2.156 PS-Free-Format-Data AVP 

The *PS-Free-Format-Data* AVP (AVP code 866) is of type OctectString and
holds online charging session specific data.

### 7.2.157 PS-Furnish-Charging-Information AVP

The *PS-Furnish-Charging-Information* AVP (AVP code 865) is of type
Grouped. Its purpose is to add online charging session specific
information, received via the Ro reference point, onto the Rf reference
point in order to facilitate its inclusion in CDRs. This information
element may be received in a CCA message via the Ro reference point. In
situations where online and offline charging are active in parallel, the
information element is transparently copied into an ACR to be sent on
the Rf reference point.

It has the following ABNF grammar:

> PS-Furnish-Charging-Information :: = &lt; AVP Header: 865&gt;\
> \
> { 3GPP-Charging-Id }\
> { PS-Free-Format-Data }\
> \[ PS-Append-Free-Format-Data \]

### 7.2.158 PS-Information AVP

The *PS-Information* AVP (AVP code 874) is of type Grouped. Its purpose
is to allow the transmission of additional PS service specific
information elements.

It has the following ABNF grammar:

PS-Information :: = &lt; AVP Header: 874&gt;

> \[ 3GPP-Charging-Id \]
>
> \[ PDN-Connection-Charging-ID \]\
> \[ Node-Id \]\
> \[ 3GPP-PDP-Type \]\
> \* \[ PDP-Address \]\
> \[ PDP-Address-Prefix-Length \]\
> \[ Dynamic-Address-Flag \]\
> \[ Dynamic-Address-Flag-Extension \]\
> \[ QoS-Information \]\
> \* \[ SGSN-Address \]\
> \* \[ GGSN-Address \]\
> \* \[ SGW-Address \]\
> \[ CG-Address \]\
> \[ Serving-Node-Type \]\
> \[ SGW-Change \]\
> \[ 3GPP-IMSI-MCC-MNC \]\
> \[ IMSI-Unauthenticated-Flag \]\
> \[ 3GPP-GGSN-MCC-MNC \]\
> \[ 3GPP-NSAPI \]\
> \[ Called-Station-Id \]\
> \[ 3GPP-Session-Stop-Indicator \]\
> \[ 3GPP-Selection-Mode \]\
> \[ 3GPP-Charging-Characteristics \]\
> \[ Charging-Characteristics-Selection-Mode \]\
> \[ 3GPP-SGSN-MCC-MNC \]\
> \[ 3GPP-MS-TimeZone \]
>
> \[ Charging-Rule-Base-Name \]\
> \[ 3GPP-User-Location-Info \]
>
> \[ User-Location-Info-Time \]
>
> \[ User-CSG-Information \]
>
> \[ 3GPP2-BSID \]
>
> \[ TWAN-User-Location-Info \]\
> \[ 3GPP-RAT-Type \]\
> \[ PS-Furnish-Charging-Information \]\
> \[ PDP-Context-Type \]\
> \[ Offline-Charging \]
>
> \* \[ Traffic-Data-Volumes \]
>
> \* \[ Service-Data-Container \]
>
> \[ User-Equipment-Info \]
>
> \[ Terminal-Information \]
>
> \[ Start-Time \]
>
> \[ Stop-Time \]
>
> \[ Change-Condition \]
>
> \[ Diagnostics \]
>
> \[ Low-Priority-Indicator \]
>
> \[ MME-Number-for-MT-SMS \]
>
> \[ MME-Name \]
>
> \[ MME-Realm \]

### 7.2.159 Quota-Consumption-Time AVP

The *Quota-Consumption-Time* AVP (AVP code 881) is of type Unsigned32
and contains an idle traffic threshold time in seconds. This AVP may be
included within the Multiple-Services-Credit-Control AVP when this AVP
also contains a Granted-Service-Units AVP containing a CC-Time AVP (i.e.
when the granted quota is a time quota).

### 7.2.160 Quota-Holding-Time AVP

The *Quota-Holding-Time* AVP (AVP code 871) is of type Unsigned32 and
contains the quota holding time in seconds. The client shall start the
quota holding timer when quota consumption ceases. This is always when
traffic ceases, i.e. the timer is re-started at the end of each packet.
The Credit Control Client shall deem a quota to have expired when no
traffic associated with the quota is observed for the value indicated by
this AVP. The timer is stopped on sending a CCR and re-initialised on
receiving a CCA with the previous used value or a new value of
Quota-Holding-Time if received.

This optional AVP may only occur in a CCA command. It is contained in
the Multiple-Services-Credit-Control AVP. It applies equally to the
granted time quota and to the granted volume quota.

A Quota-Holding-Time value of zero indicates that this mechanism shall
not be used. If the Quota-Holding-Time AVP is not present, then a
locally configurable default value in the client shall be used.

### 7.2.161 Rate-Element AVP

The *Rate-Element* AVP (AVP code 2058) is of type Grouped and holds
simple rate element of one dimension.

Possible dimentions are the CC-Unit-Type.

Example: *CC-Unit-Type* AVP TIME, *Unit-Value* AVP 6 and *Unit-Cost* AVP
10 with *Exponent* AVP 2 should read:

10 cents per 6 seconds time. The currency is context dependent.

IF *CC-Unit-Type* AVP is MONEY, this is a fixed fee and Unit-Value is
ignored.

It has the following ABNF grammar:

> Rate-Element :: = &lt; AVP Header: 2058 &gt;
>
> { CC-Unit-Type }
>
> \[Charge- Reason-Code \]
>
> \[ Unit-Value \]
>
> \[ Unit-Cost \]
>
> \[ Unit-Quota-Threshold \]

### 7.2.162 Read-Reply-Report-Requested AVP

The *Read-Reply-Report-Requested* AVP (AVP code 1222) is of type
Enumerated and indicates whether a read reply report has been requested
by the originator MMS User Agent or not.

The values for whether a report was requested are:

> 0 No
>
> 1 Yes

### 7.2.163 Void

### 7.2.164 Real-Time-Tariff-Information AVP

The *Real-Time-Tariff-Information* AVP (AVP code 2305) is of type
Grouped and holds the tariff information received in real time according
to TS 29.658 \[222\] in the SIP signalling.

It has the following ABNF grammar:

&lt; Real-Time-Tariff-Information &gt; :: = &lt; AVP Header: 2305 &gt;

> \[ Tariff-Information \]
>
> \[ Tariff-XML \]

### 7.2.165 Received-Talk-Burst-Time AVP

The *Received-Talk-Burst-Time* AVP (AVP code 1284) is of type Unsigned32
and holds the duration in seconds of the received talk bursts.

### 7.2.166 Received-Talk-Burst-Volume AVP

The *Received-Talk-Burst-Volume* AVP (AVP code 1285) is of type
Unsigned32 and holds the volume in bytes of the received talk bursts.

### 7.2.167 Recipient-Address AVP

The *Recipient-Address* AVP (AVP code 1201) is of type Grouped. Its
purpose is to identify the recipient of a message.

It has the following ABNF grammar:

> Recipient-Address :: = &lt; AVP Header: 1201 &gt;
>
> \[ Address-Type \]
>
> \[ Address-Data \]
>
> \[ Address-Domain \]
>
> \[ Addressee-Type \]

### <span id="_Ref166904258" class="anchor"><span id="_Toc375141221" class="anchor"></span></span>7.2.168 Recipient-Info AVP

The *Recipient-Info* AVP (AVP code 2026) is of type Grouped. Its purpose
is to group information associated with a recipient. and contains the
list of Recipient addresses of the message.

It has the following ABNF grammar:

> Recipient-Info :: = &lt; AVP Header: 2026 &gt;
>
> \[ Destination-Interface \]
>
> \* \[ Recipient-Address \]
>
> \* \[ Recipient-Received-Address \]
>
> \[ Recipient-SCCP-Address \]
>
> \[ SM-Protocol-ID \]

NOTE 1: This Recipient-Info AVP allows charging for messages with
multiple recipients by repeating this AVP for every recipient. The
Recipient-Info AVP unambigiously associates the grouped information to
one specific recipient.

NOTE 2: The SM-Protocol-ID AVP only relates to the recipient when
charging MT SMS messages as specified in TS 23.040 \[216\].

### 7.2.169 Recipient-Received-Address AVP

The *Recipient-Received-Address* AVP (AVP code 2028) is of type Grouped.
Its purpose is to identify the recipient of a message with the original,
unmodified address information as received before any address
manipulations has taken place in the entity generating the charging
information. This field allows correlation of address information with
information generated by other nodes in the message flow.

It has the following ABNF grammar:

> Recipient-Received-Address :: = &lt; AVP Header: 2028&gt;
>
> \[ Address-Type \]
>
> \[ Address-Data \]
>
> \[ Address-Domain \]

### 7.2.170 Recipient-SCCP-Address

The *Recipient-SCCP-Address* AVP (AVP code 2010) is of type Address. It
is the "SCCP called address" used by the messaging node when delivering
the message. This is usually the address of the MSC or SGSN/Serving Node
that is serving the UE when it delivers the message. It contains a
Global Title, where Global Title represents an E.164 number, and
possibly a Point Code (ISPC). The AddressType discriminator in RFC 3588
\[401\] is set to value 8, E.164, and the address information is UTF8
encoded.

### 7.2.171 Refund-Information AVP

The *Refund-Information* AVP (AVP code 2022) is of type OctetString and
it conveys relevant information for the OCS application relative to
refund mechanism. When refund mechanism is implemented in the OCS this
AVP may be included in the CCA of the previous IEC. This AVP must be
used by the CTF in case of a refund scenario and thus must be included
in the CCR for refund if previously received in CCA for IEC.

### 7.2.171A Relationship-Mode AVP

The *Relationship-Mode* AVP (AVP code 2706) is of type Enumerated and
indicates whether the other functional entity (e.g. contact point of the
neighbouring network) is regarded as part of the same trust domain.

It has the following values:

> 0 trusted
>
> 1 non-trusted

### 7.2.171B Related-IMS-Charging-Identifier AVP

The *Related-IMS-Charging-Identifier* AVP (AVP code 2711) is of type
UTF8String and holds the Related IMS Charging Identifier (ICID) as
generated by the Enhanced MSC Server or the P-CSCF for the target access
leg of an SRVCC access transfer.

### 7.2.171C Related-IMS-Charging-Identifier-Node AVP

The *Related-IMS-Charging-Identifier-Node* AVP (AVP code 2712) is of
type Address and holds the identifier of the Enhanced MSC Server or the
P-CSCF that generated the Related IMS Charging Identifier (ICID).

### 7.2.172 Remaining-Balance AVP

The *Remaining-Balance* AVP (AVP code 2021) is of type Grouped and
provides information about the remaining account balance of the
subscriber.

It has the following ABNF grammar:

> Remaining-Balance :: = &lt; AVP Header: 2021 &gt;
>
> { Unit-Value }
>
> { Currency-Code }

### 7.2.173 Reply-Applic-ID AVP

The *Reply-Applic-ID* AVP (AVP code 1223) is of type UTF8String and
holds the identifier of a "reply path", i.e. the identifier of the
application to which delivery reports, read-reply reports and reply-MMs
are addressed.

### 7.2.174 Reply-Path-Requested AVP

The *Reply-Path-Requested* AVP (AVP code 2011) is of type Enumerated.
The possible values are:

0 No Reply Path Set

1 Reply path Set

### 7.2.175 Reporting-Reason AVP

The *Reporting-Reason* AVP (AVP code 872) is of type Enumerated and
specifies the reason for usage reporting for one or more types of quota
for a particular category. It can occur directly in the
Multiple-Services-Credit-Control AVP, or in the Used-Service-Units AVP
within a Credit Control Request command reporting credit usage. It shall
not be used at command level. It shall always and shall only be sent
when usage is being reported.

The following values are defined for the Reporting-Reason AVP:

THRESHOLD (0)

-   This value is used to indicate that the reason for usage reporting
    of the particular quota type indicated in the Used-Service-Units AVP
    where it appears is that the threshold has been reached.

QHT (1)

-   This value is used to indicate that the reason for usage reporting
    of all quota types of the Multiple-Service-Credit-Control AVP where
    its appears is that the quota holding time specified in a previous
    CCA command has been hit (i.e. the quota has been unused for that
    period of time).

FINAL (2)

-   This value is used to indicate that the reason for usage reporting
    of all quota types of the Multiple-Service-Credit-Control AVP where
    its appears is that a service termination has happened, e.g. PDP
    context, IP CAN bearer termination or service data flow termination.

QUOTA\_EXHAUSTED (3)

-   This value is used to indicate that the reason for usage reporting
    of the particular quota type indicated in the Used-Service-Units AVP
    where it appears is that the quota has been exhausted.

VALIDITY\_TIME (4)

-   This value is used to indicate that the reason for usage reporting
    of all quota types of the Multiple-Service-Credit-Control AVP where
    its appears is that the credit authorization lifetime provided in
    the Validity-Time AVP has expired.

OTHER\_QUOTA\_TYPE (5)

-   This value is used to indicate that the reason for usage reporting
    of the particular quota type indicated in the Used-Service-Units AVP
    where it appears is that, for a multi-dimensional quota, one reached
    a trigger condition and the other quota is being reported.

RATING\_CONDITION\_CHANGE (6)

-   This value is used to indicate that the reason for usage reporting
    of all quota types of the Multiple-Service-Credit-Control AVP where
    its appears is that a change has happened in some of the rating
    conditions that were previously armed (through the Trigger AVP, e.g.
    QoS, Radio Access Technology,…). The specific conditions that have
    changed are indicated in an associated Trigger AVP.

FORCED\_REAUTHORISATION (7)

-   This value is used to indicate that the reason for usage reporting
    of all quota types of the Multiple-Service-Credit-Control AVP where
    its appears is that it is there has been a Server initiated
    re-authorisation procedure, i.e. receipt of RAR command

> POOL\_EXHAUSTED (8)

-   This value is used to indicate that the reason for usage reporting
    of the particular quota type indicated in the Used-Service-Units AVP
    where it appears is that granted units are still available in the
    pool but are not sufficient for a rating group using the pool.

The values QHT, FINAL, VALIDITY\_TIME, FORCED\_REAUTHORISATION,
RATING\_CONDITION\_CHANGE apply for all quota types and are used
directly in the Multiple-Services-Credit-Control AVP, whereas the values
THRESHOLD, QUOTA\_EXHAUSTED and OTHER\_QUOTA\_TYPE apply to one
particular quota type and shall occur only in the Used-Service-Units
AVP. The value POOL\_EXHAUSTED apply to all quota types using the credit
pool and occurs in the Used-Service-Units AVP. It may optionally occur
in the Multiple-Services-Credit-Control AVP if all quota types use the
same pool.

When the value RATING\_CONDITION\_CHANGE is used, the Trigger AVP shall
also be included to indicate the specific events which caused the
re-authorisation request.

### 7.2.176 Requested-Party-Address AVP

The *Requested-Party-Address* AVP (AVP code 1251) is of type UTF8
String. In IMS it holds the address (SIP URI or TEL URI) of the party
(Public User ID or Public Service ID) to whom the SIP transaction was
originally posted.\
The Requested Party Address shall be populated with the SIP URI or TEL
URI contained in the Request-URI of the incoming request. This field is
only present if different from the Called Party Address parameter.

### 7.2.177 Role-Of-Node AVP

The *Role-Of-Node* AVP (AVP code 829) is of type Enumerated and
specifies whether the IMS node (except the MRFC) is serving the calling
or the called party.

The identifier can be one of the following:

ORIGINATING\_ROLE 0

The IMS node is applying an originating role, serving the calling party.

TERMINATING\_ROLE 1

The IMS node is applying a terminating role, serving the called party.

### 7.2.177A Route-Header-Received AVP

The *Route-Header-Received* AVP (AVP code 3403) is of type UTF8String
and includes the information in the topmost route header in a received
initial SIP INVITE or non-session related SIP MESSAGE request.

### 7.2.177B Route-Header-Transmitted AVP

The *Route-Header-Transmitted* AVP (AVP code 3404) is of type UTF8String
and includes the information in the route header representing the
destination in a transmitted initial SIP INVITE or non-session related
SIP MESSAGE request.

### 7.2.178 Scale-Factor AVP

The *Scale-Factor* AVP (AVP code 2059) is of type Grouped and holds
simple multiplication factor in the same format as Unit-Value.

It has the following ABNF grammar:

> Scale-Factor :: = &lt; AVP Header: 2059 &gt;
>
> { Value-Digits }
>
> \[ Exponent \]

### 7.2.179 SDP-Answer-Timestamp AVP

The *SDP-Answer-Timestamp* AVP (AVP code 1275) is of type Time and holds
the time in UTC format of the response to the SDP offer.

### 7.2.180 SDP-Media-Component AVP

The *SDP-Media-Component* AVP (AVP code 843) is of type Grouped and
contains information about media used for a IMS session.

It has the following ABNF grammar:

SDP-Media-Component ::= &lt; AVP Header: 843 &gt;

> \[ SDP-Media-Name \]\
> \* \[ SDP-Media-Description \]\
> \[ Local-GW-Inserted-Indication \]
>
> \[ IP-Realm-Default-Indication \]\
> \[ Transcoder-Inserted-Indication \]\
> \[ Media-Initiator-Flag \]\
> \[ Media-Initiator-Party \]\
> \[ 3GPP-Charging-Id \]
>
> \[ Access-Network-Charging-Identifier-Value \]
>
> \[ SDP-Type \]

NOTE: When populating the SDP-Media-Component, either the
3GPP-Charging-ID or the Access-Network-Charging-Identifier-Value should
be present but not both. The 3GPP-Charging-ID is expected to be used for
3GPP defined IP-CANS (e.g. GPRS) while the
Access-Network-Charging-Identifier-Value is used for non-3GPP defined
IP-CANs.

### 7.2.181 SDP-Media-Description AVP

The *SDP-Media-Description* AVP (AVP code 845) is of type UTF8String and
holds the content of an "attribute-line" (i=, c=, b=, k=, a=, etc.)
related to a media component, as described in RFC 4566 \[406\]. The
attributes are specifying the media described in the SDP-Media-Name AVP.

### 7.2.182 SDP-Media-Name AVP

The *SDP-Media-Name* AVP (AVP code 844) is of type UTF8String and holds
the content of a "m=" line in the SDP data.

### 7.2.183 SDP-Offer-Timestamp AVP

The *SDP-Offer-Timestamp* AVP (AVP code 1274) is of type Time and holds
the time in UTC format of the SDP offer.

### 7.2.184 SDP-Session-Description AVP

The *SDP-Session-Description* AVP (AVP code 842) is of type UTF8String
and holds the content of an "attribute-line" (i=, c=, b=, k=, a=, etc.)
related to a session, as described in RFC 4566 \[406\].

### 7.2.185 SDP-TimeStamps AVP

The *SDP-TimeStamps* AVP (AVP code 1273) is of type Grouped and holds
the time of the SDP offer and the SDP answer.

It has the following ABNF grammar:

SDP-TimeStamps :: = &lt; AVP Header: 1273 &gt;

> \[ SDP-Offer-Timestamp \]
>
> \[ SDP-Answer-Timestamp \]

### 7.2.186 SDP-Type AVP

The *SDP-Type* AVP (AVP code 2036) is of type Enumerated and holds
information if the SDP media component was of type SDP offer or SDP
answer.

The values are:

> 0 SDP Offer
>
> 1 SDP Answer

### 7.2.186A Session-Direction AVP

The *Session-Direction* AVP (AVP code 2707) is of type Enumerated and
indicates whether the NNI is used for an inbound or outbound service
request on the control plane in case of interconnection and roaming.

It has the following values:

> 0 inbound
>
> 1 outbound

### 7.2.187 Served-Party-IP-Address AVP

The *Served-Party-IP-Address* AVP (AVP code 848) is of type Address and
holds the IP address of either the calling or called party, depending on
whether the P-CSCF is in touch with the calling or the called party.
This AVP is only provided by the P-CSCF.

### 7.2.188 Void

### 7.2.189 Service-Data-Container AVP

The *Service-Data-Container* AVP (AVP code 2040) is of type Grouped. Its
purpose is to allow the transmission of the container to be reported for
Flow based Charging. On encountering change on charging condition, this
container identifies the volume count (separated for uplink and
downlink), elapsed time or number of events, per service data flow
identified per rating group or combination of the rating group and
service id within an IP-CAN bearer.

It has the following ABNF grammar:

Service-Data-Container :: = &lt; AVP Header: 2040&gt;

\[ A F-Correlation-Information \]

\[ Charging-Rule-Base-Name \]

> \[ Accounting-Input-Octets \]
>
> \[ Accounting-Output-Octets \]
>
> \[ Local-Sequence-Number \]
>
> \[ QoS-Information \]
>
> \[ Rating-Group \]
>
> \[ Change-Time \]
>
> \[ Service-Identifier \]
>
> \[ Service-Specific-Info \]
>
> \[ SGSN-Address \]
>
> \[ Time-First-Usage \]
>
> \[ Time-Last-Usage \]
>
> \[ Time-Usage \]
>
> \*\[ Change-Condition \]
>
> <span id="OLE_LINK2" class="anchor"></span>\[ 3GPP-User-Location-Info
> \]
>
> \[ 3GPP2-BSID \]
>
> \[ Sponsor-Identity \]
>
> \[ Application-Service-Provider-Identity \]

### 7.2.190 Service-ID AVP

The *Service-ID* AVP (AVP code 855) is of type UTF8String and identifies
the service the MRFC is hosting or AoC service. For conferences the
conference ID is used as the value of this parameter.

### 7.2.191 Service-Generic-Information AVP

The *Service-Generic-Information* AVP (AVP code 1256) is of type
Grouped. Its purpose is to allow the transmission of service information
elements used for all services.

The AVP is defined in OMA-DDS-Charging\_Data \[223\].

### 7.2.192 Service-Information AVP

The *Service-Information* AVP (AVP code 873) is of type Grouped. Its
purpose is to allow the transmission of additional 3GPP service specific
information elements which are not described in this document.

It has the following ABNF grammar:

Service-Information :: = &lt; AVP Header: 873&gt;

> \* \[ Subscription-Id \]
>
> \[ AoC-Information \]
>
> \[ PS-Information \]
>
> \[ WLAN-Information \]
>
> \[ IMS-Information \]
>
> \[ MMS-Information \]
>
> \[ LCS-Information \]
>
> \[ PoC-Information \]
>
> \[ MBMS-Information \]
>
> \[ SMS-Information \]
>
> \[ MMTel-Information \]
>
> \[ Service-Generic-Information \]
>
> \[ IM-Information \]
>
> \[ DCD-Information \]

The format and the contents of the fields inside the Service-Information
AVP are specified in the middle-tier documents which are applicable for
the specific service. Note that the formats of the fields are
service-specific, i.e. the format will be different for the various
services.

The Subscription-Id AVP in Service-Information AVP is only used on the
Rf interface.

Further fields may be included in the Service-Information AVP when new
services are introduced.

### 7.2.193 Service-Mode AVP

The *Service-Mode* AVP (AVP Code 2032) is of type Unsigned32 and
provides the mode for CDIV, CB and ECT MMTel supplementary services.

The following values are defined:

"Communication Forwarding Unconditional (CFU)" 0

"Communication Forwarding Busy (CFB)" 1

"Communication Forwarding No Reply (CRNR)" 2

"Communication Forwarding on Not Logged-In (CFNL)" 3

"Communication Deflection (CD)" 4

"Communication Forwarding on Subscriber Not Reachable (CFNRc)" 5

"Incoming Call Barring (ICB)" 6

"Outgoing Call Barring (OCB)" 7

"Anonymous Communication Rejection (ACR)" 8

"Blind Transfer" 9

"Consultative Transfer" 10

"Three-Party (3PTY)" 11

"Advice of Charge -S (AoC-S)" 12

"Advice of Charge -D (AoC-D)" 13

"Advice of Charge -E (AoC-E)" 14

Values ≥ 1024 are reserved for specific Network/Manufacturer variants

### 7.2.194 Service-Specific-Data AVP

The *Service-Specific-Data* AVP (AVP Code 863) is of type UTF8String and
holds the value of the Service-Specific-Data.

### 7.2.195 Service-Specific-Info AVP

The *Service-Specific-Info* AVP (AVP Code 1249) is of type Grouped and
holds service specific data if and as provided by an Application Server
or a PCEF only for pre-defined PCC rules.

It has the following ABNF grammar:

Service-Specific-Info ::= &lt; AVP Header: 1249 &gt;

\[ Service-Specific-Data \]\
\[ Service-Specific-Type \]

### 7.2.196 Service-Specific-Type AVP

The *Service-Specific-Type* AVP (AVP Code 1257) is of type Unsigned32
and holds the type of the Service-Specific-Data.

### 7.2.197 Void

### 7.2.198 Serving-Node-Type AVP

The *Serving-Node-Type* AVP (AVP Code 2047) is of type Enumerated and
identifies the type of Serving Node.

It may take the following values:

0 SGSN

1 PMIPSGW

2 GTPSGW

3 ePDG

> 4 hSGW

5 MME

6 TWAN

### 7.2.199 SGSN-Address AVP

The *SGSN-Address* AVP (AVP code 1228) is of type Address and holds the
IP-address of the SGSN/Serving Node (e.g. S-GW, AGW, ePDG, TWAG from the
P-GW and S4-SGSN, MME from the S-GW) that was used during a report.

### 7.2.199A SGW-Address AVP

The *SGW-Address* AVP (AVP code 2067) is of type Address and holds the
IP-address of the SGW Node.

### 7.2.200 SGW-Change AVP

The *SGW-Change* AVP (AVP Code 2065) is of type Enumerated, and
indicates this is the first Accounting Request (ACR)\[Start\] due to
S-GW change. If this AVP is not present, this means this ACR \[Start\]
is not due to SGW change.

The following values are defined:

> 0 ACR\_Start\_NOT\_due\_to\_SGW\_Change
>
> 1 ACR\_Start\_due\_to\_SGW\_Change

### 7.2.201 SIP-Method AVP

The *SIP-Method* AVP (AVP code 824) is of type UTF8String and holds the
name of the SIP Method (INVITE, UPDATE etc.) causing a accounting
request to be sent to the CDF or credit control request to be sent to
the OCF.

### 7.2.202 SIP-Request-Timestamp AVP

The *SIP-Request-Timestamp* AVP (AVP code 834) is of type Time and holds
the time in UTC format of the SIP request (e.g. Invite, Update).

### 7.2.203 SIP-Request-Timestamp-Fraction AVP

The *SIP-Request-Timestamp-Fraction* AVP (AVP code 2301) is of type
Unsigned32 and holds the miliseconds fraction in relation to
SIP-Request-Timestamp.

### 7.2.204 SIP-Response-Timestamp AVP

The *SIP-Response-Timestamp* AVP (AVP code 835) is of type Time and
holds the time in UTC format of the response to the SIP request (e.g.
200 OK).

### <span id="_Ref166904271" class="anchor"><span id="_Ref177740494" class="anchor"><span id="_Ref177740377" class="anchor"><span id="_Toc375141265" class="anchor"></span></span></span></span>7.2.205 SIP-Response-Timestamp-Fraction AVP

The *SIP-Response-Timestamp-Fraction* AVP (AVP code 2302) is of type
Unsigned32 and holds the miliseconds fraction in relation to
SIP-Response-Timestamp.

### 7.2.206 SM-Discharge-Time AVP

The *SM-Discharge-Time* AVP (AVP code 2012) is of type Time. It
indicates the time associated with the event being reported in the
SM-Status AVP. It is only used in scenarios in which the delivery of the
Delivery-Report (more properly the Status-Report) is being charged.

For example, if SM-Status has the value 0x00, then the SM-Discharge-Time
indicates the time of the delivery of the original Short Message.

NOTE: The SMS Node must ensure the correct encoding of this, as the
other AVPs using the type Time, since the SMS messages use different
formats.

### 7.2.207 SM-Message-Type AVP

The *SM*-*Message-Type* AVP (AVP code 2007) is of type Enumerated and
indicates the type of the message which caused the charging interaction.
The values are given below:

0\. SUBMISSION

1\. DELIVERY\_REPORT

2\. SM Service Request

### 7.2.208 SM-Protocol-Id AVP

The *SM-Protocol-ID* AVP (AVP code 2013) is of type OctetString and
holds an indication of the protocol used for the SM.

### 7.2.209 SM-Status AVP

The *SM-Status* AVP (AVP code 2014) is of type OctetString. The
OctetString is of length 1 octet and contains status information about
the delivery of an SM.

### <span id="_Ref177740514" class="anchor"><span id="_Toc375141270" class="anchor"></span></span>7.2.210 SM-User-Data-Header AVP

The *SM-User-Data-Header* AVP (AVP code 2015) is of type OctetString and
contains any user data header extracted from the user data part of the
SM. Encoding is as described in TS 23.040 \[216\]. Any padding bits are
not considered part of the header and are omitted.

### 7.2.211 SMS-Information AVP

The *SMS-Information* AVP (AVP code 2000) is of type Grouped. Its
purpose is to allow the transmission of additional SMS service specific
information elements.

It has the following ABNF grammar:

> SMS-Information :: = &lt; AVP Header: 2000&gt;
>
> \[ SMS-Node \]
>
> \[ Client-Address \]
>
> \[ Originator-SCCP-Address \]
>
> \[ SMSC-Address \]
>
> \[ Data-Coding-Scheme \]
>
> \[ SM-Discharge-Time \]
>
> \[ SM-Message-Type \]
>
> \[ Originator-Interface \]
>
> \[ SM-Protocol-ID \]
>
> \[ Reply-Path-Requested \]
>
> \[ SM-Status \]
>
> \[ SM-User-Data-Header \]
>
> \[ Number-Of-Messages-Sent \]
>
> \* \[ Recipient-Info \]
>
> \[ Originator-Received-Address \]
>
> \[ SM-Service-Type \]

### <span id="_SMSC-Address" class="anchor"><span id="_Ref177736042" class="anchor"><span id="_Toc375141272" class="anchor"></span></span></span>7.2.212 SMS-Node AVP

The *SMS-Node* AVP (AVP code 2016) is of type Enumerated and identifies
the role which the SMS node performs in relation to the charging event.
It takes the following values:

0 SMS Router

1 IP-SM-GW

2 SMS Router and IP-SM-GW

3 SMS-SC

### 7.2.213 SM-Service-Type AVP

The *SM-Service-Type* AVP (AVP code 2029) is of type Enumerated and
indicates the type of SM service that caused the charging interaction.
The values are given below:

0 VAS4SMS Short Message content processing (as defined in TS 22.142
\[217\]

1 VAS4SMS Short Message forwarding (as defined in TS 22.142 \[217\]

2 VAS4SMS Short Message Forwarding multiple subscriptions (as defined in
TS 22.142 \[217\]

3 VAS4SMS Short Message filtering (as defined in TS 22.142 \[217\]

4 VAS4SMS Short Message receipt (as defined in TS 22.142 \[217\]

5 VAS4SMS Short Message Network Storage (as defined in TS 22.142 \[217\]

6 VAS4SMS Short Message to multiple destinations (as defined in TS
22.142 \[217\]

7 VAS4SMS Short Message Virtual Private Network (VPN) (as defined in TS
22.142 \[217\]

8 VAS4SMS Short Message Auto Reply (as defined in TS 22.142 \[217\]

9 VAS4SMS Short Message Personal Signature (as defined in TS 22.142
\[217\]

10 VAS4SMS Short Message Deferred Delivery (as defined in TS 22.142
\[217\]

11 .. 99 Reserved for 3GPP defined SM services

100 - 199 Vendor specific SM services

The SM-Service-Type AVP must be present if the SM-Message-Type AVP has
value 2, SM Service Request.

### 7.2.214 SMSC-Address AVP

The *SMSC-Address* AVP (AVP code 2017) is of type Address and carries
the address of the SMSC, as contained in the SM.

### 7.2.215 Start-Time AVP

The S*tart-Time* AVP (AVP Code 2041) is of type Time and holds the time
in UTC format which represents the start of a user session at the
S-GW/P-GW.

### 7.2.215A Status-Code AVP

The S*tatus-Code* AVP (AVP Code 2702) is of type Enumerated and only
present to specify abnormal response code, e.g, 4xx, 5xx or Timeout, etc
for specific AS when it responds abnormally to S-CSCF. If AS responds
SIP\_200ok, this AVP isn’t present in Application-Server-Information.

The AVP may take the values as follows:

> 0 4xx;
>
> 1 5xx;

2 Timeout

### 7.2.216 Stop-Time AVP

The S*top-Time* AVP (AVP Code 2042) is of type Time and holds the time
in UTC format which represents the termination of a user session at the
S-GW/P-GW.

### 7.2.217 Submission-Time AVP

The *Submission-Time* AVP (AVP code 1202) is of type Time and indicates
the time at which the message was submitted.

### 7.2.218 Subscriber-Role AVP

The *Subscriber-Role* AVP (AVP code 2033) is of type Enumerated and
indicates the role of the subscriber (originating party or terminating
party) in MMTel supplementary services.

The role can be one of the following:

0\. ORIGINATING

1\. TERMINATING

### 7.2.219 Supplementary-Service AVP

The *Supplementary-Service* AVP (AVP code 2048) is of type Grouped and
holds the specific supplementary service details for one MMTel
supplementary service.

It has the following ABNF grammar:

Supplementary-Service :: = &lt; AVP Header: 2048&gt;

> \[MMTel-SService-Type \]
>
> \[ Service-Mode \]\
> \[ Number-Of-Diversions \]
>
> \[ Associated-Party-Address \]
>
> \[ Service-ID \]
>
> \[ Change-Time \]
>
> \[ Number-Of-Participants \]
>
> \[ Participant-Action-Type \]
>
> \[ CUG-Information \]
>
> \[ AoC-Information \]

### 7.2.220 Talk-Burst-Exchange AVP

The *Talk-Burst-Exchange* AVP (AVP code 1255) is of type Grouped and
holds the talk burst related charging data.

It has the following ABNF grammar:

Talk-Burst-Exchange :: = &lt; AVP Header: 1255 &gt;

> { PoC-Change-Time }\
> \[ Number-Of-Talk-Bursts \]\
> \[ Talk-Burst-Volume \]\
> \[ Talk-Burst-Time \]\
> \[ Number-Of-Received-Talk-Bursts \]\
> \[ Received-Talk-Burst-Volume \]\
> \[ Received-Talk-Burst-Time \]\
> \[ Number-Of-Participants \]\
> \[ PoC-Change-Condition \]

### 7.2.221 Talk-Burst-Time AVP

The *Talk-Burst-Time* AVP (AVP code 1286) is of type Unsigned32 and
holds the duration in seconds of the sent talk bursts.

### 7.2.222 Talk-Burst-Volume AVP

The *Talk-Burst-Volume* AVP (AVP code 1287) is of type Unsigned32 and
holds the volume in bytes of the sent talk bursts.

### 7.2.223 Tariff-Information AVP

The *Tariff-Information* AVP (AVP code 2060) is of type Grouped and
holds a tariff definition either from the local provider or from 3^rd^
party provider. It contains information about the operator and the ID of
the service being provided, the current tariff and possible next tariff
after tariff switch time. It may also chain to tariffs provided by
intermediate operators in the chain.

It has the following ABNF grammar:

> Tariff-Information :: = &lt; AVP Header: 2060 &gt;
>
> { Current-Tariff }
>
> \[ Tariff-Time-Change \]
>
> \[ Next-Tariff \]

### 7.2.224 Tariff-XML AVP

The *Tariff-XML* AVP (AVP code 2306) is of type UTF8String and holds the
XML body describing the tariff/add-on charge information exchanged
during the SIP transaction, as described in the TS 29.658 \[222\].

### 7.2.225 Terminating-IOI AVP

The *Terminating-IOI* AVP (AVP code 840) is of type UTF8String
(alphanumeric string) and holds the Inter Operator Identifier (IOI) for
the terminating network as generated by the IMS network element which
takes responsibility for populating this parameter \[404\] in a SIP
response as described in TS 24.229 \[202\].

The Terminating IOI contains the following values:

- Type 1 IOI:

- IOI of the home network where the S-CSCF is located for SIP responses
directed to the P-CSCF in the visited network when request was initiated
by the served user.

- IOI of the visited network where the TRF is located for SIP responses
directed to the S-CSCF in the home network when request was initiated by
the served user and "VPLMN routing" is applied in a Roaming Architecture
for Voice over IMS with Local breakout.

- IOI of the visited network where the P-CSCF is located for SIP
responses directed to the S-CSCF in the home network when request was
terminated at the served user.

- Type 2 IOI:

- IOI of the home network of the terminating end user where the S-CSCF
is located in case a session is initiated toward the IMS. In case of
redirection by the S-CSCF, *Terminating-IOI* AVP indicates the
terminating party's network operator to which the session is redirected.

- IOI of the terminating network where the MGCF is located in case a
session is initiated from the IMS toward the PSTN.

- Type 3 IOI:

- IOI of the service provider network (originating side or terminating
side) where the AS (proxy, terminating UA or redirect server or B2BUA)
is located when receiving a SIP request as described in TS 24.229
\[202\].

- IOI of the home network operator contacted by an AS when an AS
(originating UA or B2BUA) initiates a SIP request as described in TS
24.229 \[202\].

For further details on the Type 1, Type 2 and Type 3 IOIs, please refer
to TS 32.240 \[1\].

### 7.2.226 Time-First-Usage AVP

The *Time-First-Usage* AVP (AVP code 2043) is of type Time and holds the
time in UTC format for the first IP packet to be transmitted and mapped
to the current service data container.

### 7.2.227 Time-Last-Usage AVP

The *Time-Last-Usage* AVP (AVP code 2044) is of type Time and holds the
time in UTC format for the last IP packet to be transmitted and mapped
to the current service data container.

### 7.2.228 Time-Quota-Mechanism

The *Time-Quota-Mechanism* AVP (AVP code 1270) is of type Grouped.

It has the following syntax:

Time-Quota-Mechanism ::= &lt; AVP Header: 1270&gt;

> { Time-Quota-Type }
>
> { Base-Time-Interval }

The OCS may include this AVP in an Multiple-Services-Credit-Control AVP,
when granting time quota.

### 7.2.229 Time-Quota-Threshold AVP

The *Time-Quota-Threshold* AVP (AVP code 868) is of type Unsigned32 and
contains a threshold value in seconds. This AVP may be included within
the Multiple-Services-Credit-Control AVP when this AVP also contains a
Granted-Service-Units AVP containing a CC-Time AVP (i.e. when the
granted quota is a time quota).

If received, the Credit Control client shall seek re-authorisation from
the server for the quota when the quota contents fall below the supplied
threshold. The client shall allow service to continue whilst the
re-authorisation is progress, until the time at which the original quota
would have been consumed.

### 7.2.230 Time-Quota-Type AVP

The *Time-Quota-Type* AVP (AVP code 1271) is of type Enumerated. It is
used to indicate which time quota consumption mechanism shall be used
for the associated Rating Group.

It has the following values:

DISCRETE\_TIME\_PERIOD (0)

CONTINUOUS\_TIME\_PERIOD (1)

### 7.2.231 Time-Stamps AVP

The *Time-Stamps* AVP (AVP code 833) is of type Grouped and holds the
time stamp of the SIP Request and the time stamp of the response to the
SIP Request.

It has the following ABNF grammar:

Time-Stamps ::= &lt; AVP Header: 833 &gt;

> \[ SIP-Request-Timestamp \]\
> \[ SIP-Response-Timestamp \]\
> \[ SIP-Request-Timestamp-Fraction \]\
> \[ SIP-Response-Timestamp-Fraction \]

### 7.2.232 Time-Usage AVP

The *Time-Usage* AVP (AVP code 2045) is of type Unsigned32 and holds the
effective used time within the service data container reporting
interval.

### 7.2.233 Traffic-Data-Volumes AVP

The *Traffic-Data-Volumes* AVP (AVP code 2046) is of type Grouped. Its
purpose is to allow the transmission of the IP-CAN bearer container, on
encountering change on charging condition for this IP-CAN bearer.This
container reports the volume count (separated for uplink and downlink).

It has the following ABNF grammar:

> Traffic-Data-Volumes :: = &lt; AVP Header: 2046&gt;
>
> \[ QoS-Information \]
>
> \[ Accounting-Input-Octets \]
>
> \[ Accounting-Output-Octets \]
>
> \[ Change-condition \]
>
> \[ Change-Time \]
>
> \[ 3GPP-User-Location-Info \]

### 7.2.233A Transcoder-Inserted-Indication AVP

The *Transcoder-Inserted*-*Indication* AVP (AVP code 2605) is of type
Enumerated and indicates if a transcoder is inserted or not for the SDP
media component.

The following values are defined:

> 0 Transcoder Not Inserted
>
> 1 Transcoder Inserted

### 7.2.233B Transit-IOI-List AVP

The *Transit-IOI-List* AVP (AVP code 2701) is of type UTF8String and
holds the Inter Operator Identifiers (IOI) for the transit networks as
generated by the IMS network elements which take responsibility for
populating this parameter in a SIP request as described in TS 24.229
\[202\].

### 7.2.234 Token-Text AVP

The *Token-Text* AVP (AVP code 1215) is of type UTF8String and contains
extension information for the Message-Class AVP.

### 7.2.235 Trigger AVP

The *Trigger* AVP (AVP code 1264) is of type Grouped and holds the
trigger types. The presence of the Trigger AVP without any Trigger-Type
AVP in a CCA allows OCS to disable all the triggers. The presence of the
Trigger AVP in the CCR identifies the event(s) triggering the CCR.

It has the following ABNF grammar:

Trigger :: = &lt; AVP Header: 1264 &gt;

> \* \[ Trigger-Type \]

### 7.2.236 Trigger-Type AVP

The *Trigger-Type* AVP (AVP code 870) is of type Enumerated and
indicates a single re-authorisation event type.

When included in the Credit Control Answer command, the Trigger-Type AVP
indicates the events that shall cause the credit control client to
re-authorise the associated quota. The client shall not re-authorise the
quota when events which are not included in the Trigger AVP occur.

When included in the Credit Control Request command indicates the
specific event which caused the re-authorisation request of the
Reporting-Reason with value RATING\_CONDITION\_CHANGE associated.

It has the following values:

CHANGE\_IN\_SGSN\_IP\_ADDRESS (1)

-   This value is used to indicate that a change in the SGSN IP address
    shall cause the credit control client to ask for a re-authorisation
    of the associated quota.

CHANGE\_IN\_QOS (2)

-   This value is used to indicate that a change in the end user
    negotiated QoS shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

NOTE 1: This should not be used in conjunction with enumerated values 10
to 23.

CHANGE\_IN\_LOCATION (3)

-   This value is used to indicate that a change in the end user
    location shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

NOTE 2: This should not be used in conjunction with enumerated values 30
to 34.

CHANGE\_IN\_RAT (4)

-   This value is used to indicate that a change in the radio access
    technology shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

> CHANGE\_IN\_UE\_TIMEZONE (5)

-   This value is used to indicate that a change in the TimeZone where
    the end user is located shall cause the credit control client to ask
    for a re-authorisation of the associated quota.

CHANGEINQOS\_TRAFFIC\_CLASS (10)

-   This value is used to indicate that a change in the end user
    negotiated traffic class shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_RELIABILITY\_CLASS (11)

-   This value is used to indicate that a change in the end user
    negotiated reliability class shall cause the credit control client
    to ask for a re-authorisation of the associated quota.

CHANGEINQOS\_DELAY\_CLASS (12)

-   This value is used to indicate that a change in the end user
    negotiated delay class shall cause the credit control client to ask
    for a re-authorisation of the associated quota.

CHANGEINQOS\_PEAK\_THROUGHPUT (13)

-   This value is used to indicate that a change in the end user
    negotiated peak throughput shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_PRECEDENCE\_CLASS (14)

-   This value is used to indicate that a change in the end user
    negotiated precedence class shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_MEAN\_THROUGHPUT (15)

-   This value is used to indicate that a change in the end user
    negotiated mean throughput shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_MAXIMUM\_BIT\_RATE\_FOR\_UPLINK (16)

-   This value is used to indicate that a change in the end user
    negotiated uplink maximum bit rate shall cause the credit control
    client to ask for a re-authorisation of the associated quota.

CHANGEINQOS\_MAXIMUM\_BIT\_RATE\_FOR\_DOWNLINK (17)

-   This value is used to indicate that a change in the end user
    negotiated downlink maximum bit rate shall cause the credit control
    client to ask for a re-authorisation of the associated quota.

CHANGEINQOS\_RESIDUAL\_BER (18)

-   This value is used to indicate that a change in the end user
    negotiated residual BER shall cause the credit control client to ask
    for a re-authorisation of the associated quota.

CHANGEINQOS\_SDU\_ERROR\_RATIO (19)

-   This value is used to indicate that a change in the end user
    negotiated SDU error ratio shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_TRANSFER\_DELAY (20)

-   This value is used to indicate that a change in the end user
    negotiated transfer delay shall cause the credit control client to
    ask for a re-authorisation of the associated quota.

CHANGEINQOS\_TRAFFIC\_HANDLING\_PRIORITY (21)

-   This value is used to indicate that a change in the end user
    negotiated traffic handling priority shall cause the credit control
    client to ask for a re-authorisation of the associated quota.

CHANGEINQOS\_GUARANTEED\_BIT\_RATE\_FOR\_UPLINK (22)

-   This value is used to indicate that a change in the end user
    negotiated uplink guaranteed bit rate shall cause the credit control
    client to ask for a re-authorisation of the associated quota.

CHANGEINQOS\_GUARANTEED\_BIT\_RATE\_FOR\_DOWNLINK (23)

-   This value is used to indicate that a change in the end user
    negotiated downlink guaranteed bit rate shall cause the credit
    control client to ask for a re-authorisation of the
    associated quota.

CHANGEINLOCATION\_MCC (30)

-   This value is used to indicate that a change in the MCC of the
    serving network shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

CHANGEINLOCATION\_MNC (31)

-   This value is used to indicate that a change in the MNC of the
    serving network shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

CHANGEINLOCATION\_RAC (32)

-   This value is used to indicate that a change in the RAC where the
    end user is located shall cause the credit control client to ask for
    a re-authorisation of the associated quota.

CHANGEINLOCATION\_LAC (33)

-   This value is used to indicate that a change in the LAC where the
    end user is located shall cause the credit control client to ask for
    a re-authorisation of the associated quota.

CHANGEINLOCATION\_CellId (34)

-   This value is used to indicate that a change in the Cell Identity
    where the end user is located shall cause the credit control client
    to ask for a re-authorisation of the associated quota.

CHANGEINLOCATION\_TAC (35)

-   This value is used to indicate that a change in the TAC where the
    end user is located shall cause the credit control client to ask for
    a re-authorisation of the associated quota.

CHANGEINLOCATION\_ECGI (36)

-   This value is used to indicate that a change in the ECGI where the
    end user is located shall cause the credit control client to ask for
    a re-authorisation of the associated quota.

CHANGE\_IN\_MEDIA\_COMPOSITION (40)

-   This value is used to indicate that a change in the media
    composition (as identified within SDP) for an existing SIP session
    shall cause the credit control client to ask for a re-authorisation
    of the associated quota.

CHANGE\_IN\_PARTICIPANTS\_NMB (50)

-   This value is used specifically for multi participating session to
    indicate that a change in the number of active participants within a
    session shall cause the credit control client to ask for a
    re-authorisation of the associated quota.

CHANGE\_IN\_ THRSHLD\_OF\_PARTICIPANTS\_NMB (51)

-   This value is used specifically to indicate that a change in the
    threshold of participants number within a session shall cause the
    credit control client to ask for a re-authorisation of the
    associated quota.

NOTE 3: The threshold and the granularity of threshold are operator
configurable. This should not be used in conjunction with value 50.

CHANGE\_IN\_USER\_PARTICIPATING\_TYPE (52)

-   This value is used specifically to indicate that a change in the
    user participating type within a session shall cause the credit
    control client to ask for a re-authorisation of the
    associated quota.

> CHANGE\_IN\_SERVICE\_CONDITION (60)

-   This value is used to indicate that a change in rating conditions
    associated with a service occurs.\
    The description of the conditions causing a change are service
    specific and may be documented in middle-tier specifications or may
    be configurable.

> CHANGE\_IN\_SERVING\_NODE(61)

-   This value is used to indicate that a change in serving node shall
    cause the credit control client to ask for a re-authorisation of the
    associated quota.

> CHANGE\_IN\_USER\_CSG\_INFORMATION (70)

-   This value is used to indicate a request of reporting the event that
    the user enters/leaves a CSG cell. When used in a CCR, at entry to a
    CSG cell, the User-CSG-Information AVP shall be provided with the
    event report.

> CHANGE\_IN\_HYBRID\_SUBSCRIBED\_USER\_CSG\_INFORMATION (71)

-   This value is used to indicate a request of reporting the event that
    the user enters/leaves a hybrid cell that the user subscribes to.
    When used in a CCR, at entry to a hybrid cell where the user is a
    member, the User-CSG-Information AVP shall be provided with the
    event report.

> CHANGE\_IN\_HYBRID\_UNSUBSCRIBED\_USER\_CSG\_INFORMATION (72)

-   This value is used to indicate a request of reporting the event that
    the user enters/leaves a hybrid cell that the user does not
    subscribe to. When used in a CCR, at entry to a hybrid cell where
    the user is not a member, the User-CSG-Information AVP shall be
    provided with the event report.

### 7.2.237 Trunk-Group-ID AVP

The *Trunk-Group-ID* AVP (AVP code 851) is of type Grouped and
identifies the incoming and outgoing PSTN legs.

It has the following ABNF grammar:

Trunk-Group-ID :: = &lt;AVP Header: 851&gt;

> \[ Incoming-Trunk-Group-ID \]\
> \[ Outgoing-Trunk-Group-ID \]

### 7.2.237A TWAN-BSSID AVP

The *TWAN-BSSID* AVP (AVP code 2716) is of type UTF8String and contains
the BSSID of the access point where UE is located in a Trusted WLAN
Access Network (TWAN). The format used for BSSID is described in IEEE
Std 802.11-2012 \[409\].

### 7.2.237B TWAN-SSID AVP

The *TWAN-SSID* AVP (AVP code 2715) is of type UTF8String and contains
the SSID of the access point where UE is located under a Trusted WLAN
Access Network (TWAN). The format used for SSID is described in IEEE Std
802.11-2012 \[409\]

### 7.2.237C TWAN-User-Location-Info AVP

The *TWAN-User-Location-Info* AVP (AVP code 2714) is of type Grouped and
contains the UE location in a Trusted WLAN Access Network (TWAN): BSSID
and SSID of the access point.

It has the following ABNF grammar:

TWAN-User-Location-Info :: = &lt; AVP Header: 2714&gt;

> { TWAN-SSID }
>
> \[ TWAN-BSSID \]

### 7.2.238 Type-Number AVP

The *Type-Number* AVP (AVP code1204) is of type Enumerated and
identifies the well-known media types. The values are taken from OMNA
WSP Content Type Numbers \[210\]

### 7.2.239 Unit-Cost AVP

The *Unit-Cost* AVP (AVP code 2061) is of type Grouped and holds
monetary value.

It has the same format of *Unit-Value*

It has the following ABNF grammar:

> Unit-Cost :: = &lt; AVP Header: 2061 &gt;
>
> { Value-Digits }
>
> \[ Exponent \]

### 7.2.240 Unit-Quota-Threshold AVP

The *Unit-Quota-Threshold* AVP (AVP code 1226) is of type Unsigned32 and
contains a threshold value in service specific units. This AVP may be
included within the Multiple-Services-Credit-Control AVP when this AVP
also contains a Granted-Service-Units AVP containing
CC-Service-Specific-Units AVP (i.e. when the granted quota is service
specific) or within Rate-Element AVP..

If received in the context of Multiple-Service-Credit-Control AVP, the
Credit Control client shall seek re-authorisation from the server for
the quota when the quota contents fall below the supplied threshold. The
client shall allow service to continue whilst the re-authorisation is in
progress, up to the volume indicated in the original quota.

In the context of the Rating-Element AVP it denotes the durability of a
Rating Element within a Tariff. I.e. if the service consumed
Unit-Quota-Threshold number of Unit-Types, the next Rating element
becomes in effect.

### 7.2.240A User-CSG-Information AVP

The *User-CSG-Information* AVP (AVP code 2319) is of type Grouped and
holds the user "Closed Subscriber Group" Information associated to CSG
cell access: it comprises CSG ID within the PLMN, Access mode and
indication on CSG membership for the user when hybrid access applies, as
defined in TS 29.060 \[225\] for GPRS case, and in TS 29.274 \[226\] for
EPC case.

It has the following ABNF grammar:

User-CSG-Information :: = &lt; AVP Header: 2319&gt;

> { CSG-Id }
>
> { CSG-Access-Mode }

\[ CSG-Membership-Indication \]

### 7.2.241 User-Participating-Type AVP

The *User-Participating-Type* AVP(AVP code 1279) is of type Enumerated.
It is a subfield of Participants-Group AVP to indicate the user
participating type when participating in the PoC session.

The AVP may take the values as follows:

> 0 Normal;
>
> 1 NW PoC Box;
>
> 2 UE PoC Box.

### 7.2.242 User-Session-Id AVP

The *User-Session-Id* AVP (AVP code 830) is of type UTF8String and holds
the session identifier. For a SIP session the *User-Session-Id* contains
the SIP Call ID, as defined in RFC 3261 \[405\]. When the AS acts as
B2BUA, the incoming Session-ID leg is covered.

### 7.2.243 Volume-Quota-Threshold AVP

The *Volume-Quota-Threshold* AVP (AVP code 869) is of type Unsigned32
and contains a threshold value in octets. This AVP may be included
within the Multiple-Services-Credit-Control AVP when this AVP also
contains a Granted-Service-Units AVP containing a CC-Total-Octets,
CC-Input-Octets or CC-Output-Octets AVP (i.e. when the granted quota is
a volume quota).

If received, the Credit Control client shall seek re-authorisation from
the server for the quota when the quota contents fall below the supplied
threshold. The client shall allow service to continue whilst the
re-authorisation is progress, up to the volume indicated in the original
quota.

### 7.2.244 WAG-Address AVP

The WAG-Address AVP (AVP code 890) is of type Address and contains the
WAG IP address.

### 7.2.245 WAG-PLMN-Id AVP

The WAG-PLMN-Id AVP (AVP code 891) is of type OctetString and contains
the WAG PLMN id (MCC and MNC).

Coding of this AVP is same as 3GPP-SGSN-MCC-MNC coding described in TS
29.061 \[207\].

### 7.2.246 WLAN-Information AVP

The WLAN*-Information* AVP (AVP code 875) is of type Grouped. Its
purpose is to allow the transmission of additional WLAN service specific
information elements. The format and the contents of the fields inside
the WLAN-Information AVP is specified in TS 32.252 \[22\].

It has the following ABNF grammar:

WLAN-Information :: = &lt; AVP Header: 875&gt;

> \[ WLAN-Session-Id \]\
> \[ PDG-Address \]\
> \[ PDG-Charging-Id \]\
> \[ WAG-Address \]\
> \[ WAG-PLMN-Id \]\
> \[ WLAN-Radio-Container \]\
> \[ WLAN-UE-Local-IPAddress \]

### 7.2.247 WLAN-Radio-Container AVP

The WLAN-Radio-Container AVP (AVP code 892) is of type Grouped. The
WLAN-Radio-Container AVP has the following format:

> WLAN-Radio-Container :: = &lt; AVP Header: 892&gt;\
> \
> \[ Operator-Name \]\
> \[ Location-Type \]\
> \[ Location-Information \]\
> \[ WLAN-Technology \]

### 7.2.248 WLAN-Session-Id AVP

The *WLAN-Session-Id* AVP (AVP code 1246) is of type Unsigned32 and
contains the charging id generated by the AAA Server for the session.

Coding of this AVP is same as 3GPP-Charging-Id coding described in TS
29.061 \[207\].

### 7.2.249 WLAN-Technology AVP

The *WLAN-Technology* AVP (AVP code 893) is of type Unsigned32.

Editor’s note: Actual content of this AVP is tbd.

### 7.2.250 WLAN-UE-Local-IPAddress AVP

The *WLAN-UE-Local-IPAddress* AVP (AVP code 894) is of type Address and
contains the UE’s local IP address.

\
7.3 3GPP2 Accesses specific AVPs
--------------------------------

For the purpose of offline and online charging, the use of the Attribute
Value Pairs (AVPs) defined for 3GPP2 Accesses

is provided in the following table, and the specification including the
detailed definition and description, is refered to.

These AVPs shall be used together with value 5535 (3GPP2) as Vendor-Id.

Table 7.3: 3GPP2 Accesses specific AVPs

  ------------ ------ --------- ------- ---------------- ----- --------------- ------ ----- -------- ------ -------
  AVP Name     AVP    Used in   Value   AVP Flag rules
                                        
               Code             Type    

                      ACR       ACA     CCR

  3GPP2-BSID   9010   X         -       X
  ------------ ------ --------- ------- ---------------- ----- --------------- ------ ----- -------- ------ -------

######## \
Annex A (informative):\
Bibliography

**a The 3GPP charging specifications**

- 3GPP TS 32.250: "Telecommunication management; Charging management;
Circuit Switched (CS) domain charging".

- 3GPP TS 32.251: "Telecommunication management; Charging management;
Packet Switched (PS) domain charging".

- 3GPP TS 32.252: "Telecommunication management; Charging management;
Wireless Local Area Network (WLAN) charging".

- 3GPP TS 32.260: "Telecommunication management; Charging management; IP
Multimedia Subsystem (IMS) charging".

- 3GPP TS 32.270: "Telecommunication management; Charging management;
Multimedia Messaging Service (MMS) charging".

- 3GPP TS 32.271: "Telecommunication management; Charging management;
Location Services (LCS) charging".

- 3GPP TS 32.272: "Telecommunication management; Charging management;
Push-to-talk over Cellular (PoC) charging".

- 3GPP TS 32.273: "Telecommunication management; Charging management;
Multimedia Broadcast and Multicast Service (MBMS) charging".

- 3GPP TS 32.274: "Telecommunication management; Charging management;
Short Message Service (SMS) charging".

- 3GPP TS 32.275: "Telecommunication management; Charging management;
MultiMedia Telephony (MMTel) charging".

- 3GPP TS 32.280: "Telecommunication management; Charging management;
Advice of Charge (AoC) service".

- 3GPP TS 32.298: "Telecommunication management; Charging management;
Charging Data Record (CDR) encoding rules description".

- 3GPP TS 32.297: "Telecommunication management; Charging management;
Charging Data Record (CDR) file format and transfer".

- 3GPP TS 32.296: "Telecommunication management; Charging management;
Online Charging System (OCS) applications and interfaces".

- 3GPP TS 32.295: "Telecommunication management; Charging management;
Charging Data Record (CDR) transfer".

**b Common 3GPP specifications **

- 3GPP TS 33.201: "Access domain security".

**c other Domain and Service specific 3GPP / ETSI specifications**

-

**d Relevant ITU Recommendations**

-

**e Relevant IETF RFCs**

- IETF RFC 959 (1985): "File Transfer Protocol".

- IETF RFC 1350 "TFTP Protocol".

######## \
Annex B (informative):\
Change history

  -------------------- ------------ -------------- -------- --------- -------------------------------------------------------------------------------------------------------------- --------- --------- ---------
  **Change history**
  **Date**
  Dec 2007
  Dec 2007
  Dec 2007
  Dec 2007
  Mar 2008
  Mar 2008
  Mar 2008
  Mar 2008
  Mar 2008
  Jun 2008
  Jun 2008
  Jun 2008
  Sep 2008
  Sep 2008
  Sep 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Dec 2008
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Mar 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Jun 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Sep 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Dec 2009
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Jun 2010
  Oct 2010
  Oct 2010
  Oct 2010
  Oct 2010
  Dec 2010
  Dec 2010
  Dec 2010
  Dec 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  Mar 2010
  May 2011
  May 2011
  May 2011
  May 2011
  May 2011
  May 2011
  May 2011
  May 2011
  Sep 2011
  Sep 2011
  Sep 2011
  Sep 2011
  Sep 2011
  Dec 2011
  Dec 2011
  Dec 2011
  Dec 2011
  Mar 2012
  Mar 2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  June-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Sep-2012
  Dec-2012
  Dec-2012
  Dec-2012
  Dec-2012
  Dec-2012
  Dec-2012
  Dec-2012
  Mar-2013
  Jun-2013
  Sep-2013
  Oct-2013
  Dec 2013
  Mar-2014
  -------------------- ------------ -------------- -------- --------- -------------------------------------------------------------------------------------------------------------- --------- --------- ---------


